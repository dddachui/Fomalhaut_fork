<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>dddachuiğŸš­</title>
  
  
  <link href="https://www.dddachui.top/atom.xml" rel="self"/>
  
  <link href="https://www.dddachui.top/"/>
  <updated>2023-03-13T12:24:18.896Z</updated>
  <id>https://www.dddachui.top/</id>
  
  <author>
    <name>dddachui.top</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å¥½ç”¨çš„è½¯ä»¶</title>
    <link href="https://www.dddachui.top/posts/3df4b4e4.html"/>
    <id>https://www.dddachui.top/posts/3df4b4e4.html</id>
    <published>2023-03-13T12:22:13.000Z</published>
    <updated>2023-03-13T12:24:18.896Z</updated>
    
    <content type="html"><![CDATA[<h1>å¼€æºè½¯ä»¶(æŒç»­æ›´æ–°)</h1><h2 id="RSSè½¯ä»¶">RSSè½¯ä»¶</h2><p><a href="https://github.com/yang991178/fluent-reader">https://github.com/yang991178/fluent-reader</a></p><h2 id="sshå·¥å…·windterm">sshå·¥å…·windterm</h2><p>è¿ç»´äººçš„å·¥å…·ä¸å«Œå¤š<br><a href="https://github.com/kingToolbox/WindTerm">https://github.com/kingToolbox/WindTerm</a></p><h2 id="ä»£ç ç‰‡æ®µç®¡ç†å·¥å…·massCode">ä»£ç ç‰‡æ®µç®¡ç†å·¥å…·massCode</h2><p><a href="https://github.com/massCodeIO/massCode">https://github.com/massCodeIO/massCode</a></p><h2 id="è¿œç¨‹æ¡Œé¢rustdesk">è¿œç¨‹æ¡Œé¢rustdesk</h2><p><a href="https://github.com/rustdesk/rustdesk">https://github.com/rustdesk/rustdesk</a></p><h2 id="å±€åŸŸç½‘ç½‘ç›˜alist">å±€åŸŸç½‘ç½‘ç›˜alist</h2><p>åœ¨linuxå‘è¡Œç‰ˆæ­å»ºæœåŠ¡å™¨,æŒ‚è½½å„å¤§ç½‘ç›˜æˆ–è€…æœ¬åœ°æ–‡ä»¶,æœ‰å¥½çœ‹çš„ui<br><a href="https://github.com/alist-org/alist">https://github.com/alist-org/alist</a></p><h2 id="æ´›é›ª">æ´›é›ª</h2><p>æ‡‚å¾—éƒ½æ‡‚<br><a href="https://github.com/lyswhut/lx-music-desktop">https://github.com/lyswhut/lx-music-desktop</a></p><h2 id="linuxæŸ¥çœ‹markdownå‘½ä»¤">linuxæŸ¥çœ‹markdownå‘½ä»¤</h2><p><a href="https://github.com/charmbracelet/glow">https://github.com/charmbracelet/glow</a></p><h1>å…¶ä»–è½¯ä»¶</h1><h2 id="å¡é¥­è¾“å…¥æ³•">å¡é¥­è¾“å…¥æ³•</h2><p><a href="https://input.kfsafe.cn/">https://input.kfsafe.cn/</a></p><h2 id="Obsidian-markdownç¬”è®°">Obsidian(markdownç¬”è®°)</h2><p>è¿™ä¸ªè½¯ä»¶ä¸€ç›´åœ¨æ›´æ–°å°±ä¸æ”¾é“¾æ¥äº†<br><a href="https://obsidian.md/">https://obsidian.md/</a></p><h1>è·å–è½¯ä»¶ä¸‹è½½åœ°å€(è“å¥äº‘)</h1><ul><li>windterm<br><a href="https://dddachui.lanzouy.com/iDzcV0a4znoh">https://dddachui.lanzouy.com/iDzcV0a4znoh</a></li><li>massCode<br><a href="https://dddachui.lanzouy.com/iwAFI0a50h0d">https://dddachui.lanzouy.com/iwAFI0a50h0d</a></li><li>rustdesk<br><a href="https://dddachui.lanzouy.com/ii2TA0a50htc">https://dddachui.lanzouy.com/ii2TA0a50htc</a></li><li>alist<br><a href="https://dddachui.lanzouy.com/iF7pT0a506kh">https://dddachui.lanzouy.com/iF7pT0a506kh</a></li><li>glow<br><a href="https://dddachui.lanzouy.com/iIe1b0eh537c">https://dddachui.lanzouy.com/iIe1b0eh537c</a></li></ul>]]></content>
    
    
    <summary type="html">è®°å½•å„ä¸ªå¹³å°å¥½ç”¨çš„è½¯ä»¶</summary>
    
    
    
    <category term="è½¯ä»¶" scheme="https://www.dddachui.top/categories/%E8%BD%AF%E4%BB%B6/"/>
    
    
    <category term="è½¯ä»¶" scheme="https://www.dddachui.top/tags/%E8%BD%AF%E4%BB%B6/"/>
    
  </entry>
  
  <entry>
    <title>åšå®¢å›¾ç‰‡ä½¿ç”¨è®°å½•</title>
    <link href="https://www.dddachui.top/posts/6b240272.html"/>
    <id>https://www.dddachui.top/posts/6b240272.html</id>
    <published>2023-03-13T12:16:41.000Z</published>
    <updated>2023-03-13T12:48:19.386Z</updated>
    
    <content type="html"><![CDATA[<h1>ä½¿ç”¨è®°å½•</h1><h2 id="èƒŒæ™¯å›¾">èƒŒæ™¯å›¾</h2><ul><li>9</li><li>19</li><li>29</li><li>39</li></ul><h2 id="æ–‡ç« å›¾">æ–‡ç« å›¾</h2><ul><li>å­¦ä¹ ç›®æ ‡ 1</li><li>å¥½ç”¨çš„è½¯ä»¶ 2</li><li>crontab 3</li><li>åšå®¢å›¾ç‰‡ä½¿ç”¨è®°å½• 4</li><li>å±€åŸŸç½‘ipå†²çªè§£å†³æ–¹æ³• 5</li><li>linuxçš„é©±åŠ¨é—®é¢˜ 6</li><li>ç³»ç»Ÿèµ„æºå¼‚å¸¸å¤„ç†æ€è·¯ 7</li><li>ç”¨æˆ·è¢«é”å®š 8</li><li>åœ¨Centosä¸­æ£€æŸ¥RPMåŒ…çš„ä¾èµ–æ€§ 10</li><li>gitæ‹‰å–æ€»æ˜¯éœ€è¦å¯†ç  11</li><li>inodeèŠ‚ç‚¹çˆ†æ»¡å¤„ç† 12</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹at 13</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹bizp2 14</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹dd 15</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹df 16</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹dnf 17</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹dos2unix 18</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹ethtool 20</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹free 21</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹gdb 22</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹git 23</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹gzip 24</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹iostat 25</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹lscpu 26</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹lsof 27</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹lspci 28</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹md5sum 30</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹netstat 31</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹nmcli 32</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹pidstat 33</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹ps 34</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹rpm 35</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹rsync 36</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹screen 37</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹strace 38</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹systemctl 40</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹tar 41</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹top 42</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹ulimit 43</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹xz 44</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹yum 45</li><li>Linuxå¥½ç”¨å‘½ä»¤ä¹‹zip 46</li></ul>]]></content>
    
    
    <summary type="html">è®°å½•å›¾ç‰‡çš„ä½¿ç”¨è®°å½•ï¼Œé˜²æ­¢é‡å¤</summary>
    
    
    
    <category term="æ‚è®°" scheme="https://www.dddachui.top/categories/%E6%9D%82%E8%AE%B0/"/>
    
    
    <category term="æ‚è®°" scheme="https://www.dddachui.top/tags/%E6%9D%82%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>2023ç›®æ ‡</title>
    <link href="https://www.dddachui.top/posts/7169e9ad.html"/>
    <id>https://www.dddachui.top/posts/7169e9ad.html</id>
    <published>2023-03-12T14:15:32.000Z</published>
    <updated>2023-03-13T12:23:22.056Z</updated>
    
    <content type="html"><![CDATA[<h1>å­¦ä¹ Flag</h1><ol><li>è€ƒå®Œé©¾ç…§ï¼</li><li>å­¦ä¹ rpmæ‰“åŒ…æ–¹æ³•</li><li>å­¦ä¹ ksæ–‡ä»¶ä½¿ç”¨ï¼ŒåŒ…æ‹¬æ–‡ä»¶ç¼–å†™ã€pxeè‡ªåŠ¨å®‰è£…ã€å°è£…é•œåƒ</li><li>rubåŸç†å­¦ä¹ (ä¿®å¤legacyã€uefiå¼•å¯¼ã€åŸºæœ¬æ“ä½œ)</li><li>linuxåŒç½‘å¡ä½¿ç”¨NetworkManageræœåŠ¡è®¿é—®èµ„æºé—®é¢˜è§£å†³</li><li>é«˜å¹¶å‘æ–‡æ¡£ç²¾ç®€</li></ol><h1>äººç”Ÿç›®æ ‡</h1><ol><li>æ‰¾ä¸ªå¯¹è±¡</li></ol>]]></content>
    
    
    <summary type="html">åŠ æ²¹</summary>
    
    
    
    
    <category term="Markdown" scheme="https://www.dddachui.top/tags/Markdown/"/>
    
  </entry>
  
  <entry>
    <title>Linuxå¥½ç”¨å‘½ä»¤ä¹‹ethtool</title>
    <link href="https://www.dddachui.top/posts/c0d4357c.html"/>
    <id>https://www.dddachui.top/posts/c0d4357c.html</id>
    <published>2022-10-19T15:30:51.000Z</published>
    <updated>2023-03-13T12:49:02.544Z</updated>
    
    <content type="html"><![CDATA[<h1>å‘½ä»¤ç®€ä»‹</h1><p>æŸ¥çœ‹ç½‘å£ç”¨çš„</p><h1>æŸ¥çœ‹ç½‘å¡ä¿¡æ¯</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ethtool eth0</span><br></pre></td></tr></table></figure><ul><li>ç½‘å¡ä¿¡æ¯å¦‚ä¸‹<br>å¯ä»¥çœ‹å‡ºç½‘å¡çš„å¾ˆå¤šä¿¡æ¯,åŒ…æ‹¬ç½‘å¡é€Ÿç‡æ˜¯ç™¾å…†è¿˜æ˜¯åƒå…†</li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">Settings for enp2s0:</span><br><span class="line">        Supported ports: [ TP    MII ]</span><br><span class="line">        Supported link modes:   10baseT/Half 10baseT/Full</span><br><span class="line">                                100baseT/Half 100baseT/Full</span><br><span class="line">                                1000baseT/Half 1000baseT/Full</span><br><span class="line">        Supported pause frame use: Symmetric Receive-only</span><br><span class="line">        Supports auto-negotiation: Yes</span><br><span class="line">        Supported FEC modes: Not reported</span><br><span class="line">        Advertised link modes:  10baseT/Half 10baseT/Full</span><br><span class="line">                                100baseT/Half 100baseT/Full</span><br><span class="line">                                1000baseT/Half 1000baseT/Full</span><br><span class="line">        Advertised pause frame use: Symmetric Receive-only</span><br><span class="line">        Advertised auto-negotiation: Yes</span><br><span class="line">        Advertised FEC modes: Not reported</span><br><span class="line">        Link partner advertised link modes:  10baseT/Half 10baseT/Full</span><br><span class="line">                                             100baseT/Half 100baseT/Full</span><br><span class="line">                                             1000baseT/Full</span><br><span class="line">        Link partner advertised pause frame use: Symmetric</span><br><span class="line">        Link partner advertised auto-negotiation: Yes</span><br><span class="line">        Link partner advertised FEC modes: Not reported</span><br><span class="line">        Speed: 1000Mb/s</span><br><span class="line">        Duplex: Full</span><br><span class="line">        Auto-negotiation: on</span><br><span class="line">        master-slave cfg: preferred slave</span><br><span class="line">        master-slave status: slave</span><br><span class="line">        Port: Twisted Pair</span><br><span class="line">        PHYAD: 0</span><br><span class="line">        Transceiver: external</span><br><span class="line">        MDI-X: Unknown</span><br><span class="line">        Supports Wake-on: pumbg</span><br><span class="line">        Wake-on: d</span><br><span class="line">        Link detected: yes</span><br></pre></td></tr></table></figure><h1>æŠŠç½‘å¡æŒ‡ç¤ºç¯æ‰“å¼€</h1><p>åœ¨ç½‘å¡æ”¯æŒè¿™ç§åŠŸèƒ½çš„å‰æä¸‹,ä½¿ç”¨æ­¤å‘½ä»¤ä¼šä½¿ç½‘å¡çš„æŒ‡ç¤ºç¯é—ªçƒ,ä½†éœ€è¦æ³¨æ„,æœ‰äº›ç³»ç»Ÿä¼šæŒç»­é—ªçƒ,ä½†æœ‰äº›ç‰ˆæœ¬ä¼šé—ªçƒå‡ ç§’</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ethtool -p eth0</span><br></pre></td></tr></table></figure><h1>æŸ¥çœ‹é”™è¯¯ä¿¡æ¯</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ethtool -S eth0 | grep error</span><br></pre></td></tr></table></figure><p>åŒæ—¶ï¼Œä½¿ç”¨<code>ifconfig</code> ä¹Ÿå¯ä»¥çœ‹é”™è¯¯ä¿¡æ¯</p><h1>é”™è¯¯ä¿¡æ¯</h1><ul><li>RX errors<br>è¡¨ç¤ºæ€»çš„æ”¶åŒ…çš„é”™è¯¯æ•°é‡ï¼Œè¿™åŒ…æ‹¬ too-long-frames é”™è¯¯ï¼ŒRing Buffer æº¢å‡ºé”™è¯¯ï¼Œcrc æ ¡éªŒé”™è¯¯ï¼Œå¸§åŒæ­¥é”™è¯¯ï¼Œfifo overruns ä»¥åŠ missed pkg ç­‰ç­‰</li><li>RX dropped<br>è¡¨ç¤ºæ•°æ®åŒ…å·²ç»è¿›å…¥äº† Ring Bufferï¼Œä½†æ˜¯ç”±äºå†…å­˜ä¸å¤Ÿç­‰ç³»ç»ŸåŸå› ï¼Œå¯¼è‡´åœ¨æ‹·è´åˆ°å†…å­˜çš„è¿‡ç¨‹ä¸­è¢«ä¸¢å¼ƒ</li><li>RX overruns<br>è¡¨ç¤ºäº† fifo çš„ overrunsï¼Œè¿™æ˜¯ç”±äº Ring Buffer(aka Driver Queue) ä¼ è¾“çš„ IO å¤§äº kernel èƒ½å¤Ÿå¤„ç†çš„ IO å¯¼è‡´çš„ï¼Œè€Œ Ring Buffer åˆ™æ˜¯æŒ‡åœ¨å‘èµ· IRQ è¯·æ±‚ä¹‹å‰çš„é‚£å— bufferã€‚å¾ˆæ˜æ˜¾ï¼Œoverruns çš„å¢å¤§æ„å‘³ç€æ•°æ®åŒ…æ²¡åˆ° Ring Buffer å°±è¢«ç½‘å¡ç‰©ç†å±‚ç»™ä¸¢å¼ƒäº†(å°±æ˜¯ring bufferæ»¡ä¹‹åå…ˆæœ‰dropæ”¶åˆ°çš„ï¼Œå†overrunæ²¡æ”¶çš„)ï¼Œè€Œ CPU æ— æ³•å³ä½¿çš„å¤„ç†ä¸­æ–­æ˜¯é€ æˆ Ring Buffer æ»¡çš„åŸå› ä¹‹ä¸€</li><li>RX frame<br>è¡¨ç¤º misaligned çš„ frames</li></ul><h1>rx_crc_errors</h1><p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¢åŠ rx_crc_errorsçš„å€¼æ„å‘³ç€è¯¥é—®é¢˜å‡ºåœ¨ç½‘ç»œæ¨¡å‹çš„ç¬¬1å±‚ï¼Œå½“åœ¨æ¥å£ä¸Šæ¥æ”¶åˆ°æ•°æ®åŒ…æ—¶ï¼Œå®ƒå°†ç»å†æ•°æ®å®Œæ•´æ€§æ£€æŸ¥ï¼Œè¿™ç§°ä¸ºå¾ªç¯å†—ä½™æ£€æŸ¥ã€‚ å¦‚æœæ•°æ®åŒ…åœ¨è¯¥æ£€æŸ¥ä¸­å¤±è´¥ï¼Œåˆ™å°†å…¶æ ‡è®°ä¸ºrx_crc_errors<br>1.æ›´æ¢ç”µç¼†ã€‚<br>2.æ£€æŸ¥äº¤æ¢æœºé…ç½®ã€‚<br>3.æ›´æ¢ç½‘ç»œæ¥å£å¡ã€‚</p>]]></content>
    
    
    <summary type="html">æŸ¥çœ‹ç½‘å£ç”¨çš„</summary>
    
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/categories/linux%E5%91%BD%E4%BB%A4/"/>
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/tags/linux%E5%91%BD%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title>Linuxå¥½ç”¨å‘½ä»¤ä¹‹dd</title>
    <link href="https://www.dddachui.top/posts/3f7fa63c.html"/>
    <id>https://www.dddachui.top/posts/3f7fa63c.html</id>
    <published>2022-10-01T02:53:08.000Z</published>
    <updated>2023-03-13T12:48:43.904Z</updated>
    
    <content type="html"><![CDATA[<h1>å‘½ä»¤ç®€ä»‹</h1><blockquote><p><a href="https://www.cnblogs.com/sylar5/p/6649009.html">Linux ä¸­ç”¨ dd å‘½ä»¤æ¥æµ‹è¯•ç¡¬ç›˜è¯»å†™é€Ÿåº¦ - Cyril_Wu - åšå®¢å›­ (cnblogs.com)</a></p></blockquote><h1>åŸºæœ¬ç”¨æ³•</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">time dd if=/dev/zero  of=/dev/null bs=block_size count=number_of_blocks</span><br></pre></td></tr></table></figure><h1>å‚æ•°é€‰é¡¹</h1><ul><li>é€‰é¡¹<ul><li>if=file  ï¼šä» file ä¸­è¯»è€Œä¸æ˜¯æ ‡å‡†è¾“å…¥</li><li>of=file ï¼šå†™åˆ° file é‡Œå»è€Œä¸æ˜¯æ ‡å‡†è¾“å‡º</li><li>bs=bytes ï¼šä¸€æ¬¡è¯»å’Œå†™  bytes å­—èŠ‚</li><li>ibs=bytes ï¼šä¸€æ¬¡è¯» bytes å­—èŠ‚ã€‚é»˜è®¤æ˜¯512</li><li>obs=bytes ï¼šä¸€æ¬¡å†™ bytes å­—èŠ‚ã€‚é»˜è®¤æ˜¯512</li><li>count=blocks ï¼š ä»…æ‹·è´ blocks ä¸ªå—ï¼Œå—å¤§å°ç­‰äº ibs æŒ‡å®šçš„å­—èŠ‚æ•°</li><li>iflag=FLAGS   ï¼šæŒ‡å®šè¯»çš„æ–¹å¼FLAGS</li><li>oflag=FLAGS  ï¼šæŒ‡å®šå†™çš„æ–¹å¼FLAGS</li></ul></li><li>FLAGSå¦‚ä¸‹<ul><li>directã€€ã€€ã€€è¯»å†™æ•°æ®é‡‡ç”¨ç›´æ¥IOæ–¹å¼ï¼›</li><li>directoryã€€è¯»å†™å¤±è´¥é™¤éæ˜¯directoryï¼›</li><li>dsyncã€€ã€€ã€€è¯»å†™æ•°æ®é‡‡ç”¨åŒæ­¥IOï¼›</li><li>syncã€€ã€€ã€€ã€€åŒä¸Šï¼Œä½†æ˜¯é’ˆå¯¹æ˜¯å…ƒæ•°æ®</li><li>fullblockã€€ã€€å †ç§¯æ»¡block(iflag only)ï¼›</li><li>nonblockã€€è¯»å†™æ•°æ®é‡‡ç”¨éé˜»å¡IOæ–¹å¼</li><li>noatimeã€€ã€€ è¯»å†™æ•°æ®ä¸æ›´æ–°è®¿é—®æ—¶é—´</li></ul></li></ul><h1>ç£ç›˜å†™èƒ½åŠ›æµ‹è¯•</h1><p>/dev/zeroæ˜¯ä¸€ä¸ªä¼ªè®¾å¤‡ï¼Œåªäº§ç”Ÿç©ºå­—ç¬¦æµï¼Œä¸ä¼šäº§ç”ŸIOï¼ŒIOéƒ½ä¼šé›†ä¸­åœ¨ofæ–‡ä»¶ä¸­ï¼Œæ‰€ä»¥è¿™ä¸ªå‘½ä»¤æ˜¯æµ‹è¯•ç£ç›˜çš„å†™èƒ½åŠ›ã€‚</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dd if=/dev/zero of=test bs=8k count=10000 oflag=direct</span><br></pre></td></tr></table></figure><h1>è¯»å–èƒ½åŠ›æµ‹è¯•</h1><p>/dev/sdbæ˜¯ä¸€ä¸ªç‰©ç†åˆ†åŒºï¼Œå¯¹å®ƒçš„è¯»å–ä¼šäº§ç”ŸIOï¼Œ/dev/nullæ˜¯ä¼ªè®¾å¤‡ï¼Œæ˜¯é»‘æ´ï¼Œofåˆ°è¯¥è®¾å¤‡ä¸ä¼šäº§ç”ŸIOï¼Œæ‰€ä»¥ï¼Œè¿™ä¸ªå‘½ä»¤çš„IOåªå‘ç”Ÿåœ¨/dev/sdbä¸Šï¼Œä¹Ÿç›¸å½“äºæµ‹è¯•ç£ç›˜çš„è¯»èƒ½åŠ›</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dd if=test of=/dev/null bs=8k count=10000 iflag=direct</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">å¼Ÿå¼Ÿå‘½ä»¤</summary>
    
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/categories/linux%E5%91%BD%E4%BB%A4/"/>
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/tags/linux%E5%91%BD%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title>Linuxå¥½ç”¨å‘½ä»¤ä¹‹rsync</title>
    <link href="https://www.dddachui.top/posts/bc5c9a0b.html"/>
    <id>https://www.dddachui.top/posts/bc5c9a0b.html</id>
    <published>2022-09-25T12:08:32.000Z</published>
    <updated>2023-03-13T12:50:42.720Z</updated>
    
    <content type="html"><![CDATA[<h1>å‘½ä»¤ç®€ä»‹</h1><p>åŒæ­¥çš„æ‰‹æ®µ</p><h1>ç®€å•ç”¨æ³•</h1><p>é™æ€æ–‡ä»¶éƒ¨ç½²ï¼Œä¸€èˆ¬ä¼šç”¨åˆ°æ­¤å‘½ä»¤ï¼Œå®Œæ•´å‘½ä»¤å¦‚ä¸‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsync -avz --progress -e &#x27;ssh -p 2022&#x27; --exclude=&#x27;testfile&#x27; --delete $&#123;WORKSPACE&#125;/  root@192.168.42.100:/data/</span><br></pre></td></tr></table></figure><h1>å‚æ•°å¯ç”¨</h1><ul><li>-aï¼šâ€“archive å½’æ¡£æ¨¡å¼ï¼Œè¡¨ç¤ºä»¥é€’å½’æ–¹å¼ä¼ è¾“æ–‡ä»¶ï¼Œå¹¶ä¿æŒæ‰€æœ‰æ–‡ä»¶å±æ€§ï¼Œç­‰äº-rlptgoD</li><li>-vï¼šè¾“å‡ºè¯¦ç»†è¿‡ç¨‹</li><li>-zï¼šå¯¹æ­£åœ¨å¤‡ä»½çš„æ–‡ä»¶è¿›è¡Œå‹ç¼©å¤„ç†</li><li>-rï¼šå¯¹å­ç›®å½•ä»¥é€’å½’æ¨¡å¼å¤„ç†</li><li>-lï¼šä¿ç•™è½¯è¿æ¥</li><li>-pï¼šä¿æŒæ–‡ä»¶æƒé™</li><li>-tï¼šä¿æŒæ–‡ä»¶æ—¶é—´ä¿¡æ¯</li><li>-gï¼šä¿æŒæ–‡ä»¶å±ç»„ä¿¡æ¯</li><li>-oï¼šä¿æŒæ–‡ä»¶å±ä¸»ä¿¡æ¯</li><li>-Dï¼šä¿æŒè®¾å¤‡æ–‡ä»¶ä¿¡æ¯</li><li>-eï¼š â€“rsh=command æŒ‡å®šä½¿ç”¨rshã€sshæ–¹å¼è¿›è¡Œæ•°æ®åŒæ­¥ï¼Œä¸€èˆ¬ä½¿ç”¨ssh</li><li>exclude: æ’é™¤æŸæ–‡ä»¶çš„åŒæ­¥ï¼Œå¯ä»¥å¤šä¸ªã€‚</li><li>â€“deleteï¼šåˆ é™¤é‚£äº›DSTä¸­SRCæ²¡æœ‰çš„æ–‡ä»¶ã€‚</li><li>â€“progressï¼šæ˜¾ç¤ºæ¯ä¸ªæ–‡ä»¶ä¼ è¾“çš„è¿›åº¦ã€‚çŸ¥é“æ˜¯å¦æœ‰å¤§å‹æ–‡ä»¶æ­£åœ¨å¤‡ä»½å¯èƒ½æ˜¯æœ‰ç”¨çš„</li></ul><h1>å‡ ä¸ªå‘</h1><ul><li><p>å°†dirAçš„æ‰€æœ‰æ–‡ä»¶åŒæ­¥åˆ°dirBå†…ï¼Œå¹¶åˆ é™¤dirBå†…å¤šä½™çš„æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsync -avz --delete dirA/ dirB/ </span><br></pre></td></tr></table></figure></li></ul><blockquote><p>æºç›®å½•å’Œç›®æ ‡ç›®å½•ç»“æ„ä¸€å®šè¦ä¸€è‡´ï¼ï¼</p><p>ä¸èƒ½æ˜¯dirA/* dirB/ æˆ–è€…dirA/ dirB/* æˆ–è€… dirA/* dirB/*ï¼Œå¦‚æœä¸éµå®ˆï¼Œé‚£ä¹ˆå°±ä¸ä¼šåˆ é™¤ã€‚</p></blockquote><ul><li><p>å°†dirAçš„æ‰€æœ‰æ–‡ä»¶åŒæ­¥åˆ°dirBï¼Œä½†æ˜¯åœ¨dirBå†…é™¤äº†fileB3.txtè¿™ä¸ªæ–‡ä»¶ä¸åˆ ä¹‹å¤–ï¼Œå…¶ä»–çš„éƒ½åˆ é™¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsync -avz --delete --exclude &quot;fileB3.txt&quot; dirA/ dirB/</span><br></pre></td></tr></table></figure></li><li><p>å°†dirAç›®å½•å†…çš„fileA1.txtå’ŒfileA2.txtä¸åŒæ­¥åˆ°dirBç›®å½•å†…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsync -avz --exclude=&quot;fileA1.txt&quot; --exclude=&quot;fileA2.txt&quot; dirA/ dirB/</span><br></pre></td></tr></table></figure></li><li><p>å°†dirAç›®å½•å†…çš„fileA1.txtå’ŒfileA2.txtä¸åŒæ­¥åˆ°dirBç›®å½•å†…ï¼Œå¹¶ä¸”åœ¨dirBç›®å½•å†…åˆ é™¤å¤šä½™çš„æ–‡ä»¶</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsync -avz --exclude=&quot;fileA1.txt&quot; --exclude=&quot;fileA2.txt&quot; --delete dirA/ dirB/</span><br></pre></td></tr></table></figure></li><li><p>å°†dirAç›®å½•å†…çš„fileA1.txtå’ŒfileA2.txtä¸åŒæ­¥åˆ°dirBç›®å½•å†…ï¼Œå¹¶ä¸”åœ¨dirBç›®å½•å†…åˆ é™¤å¤šä½™çš„æ–‡ä»¶ï¼ŒåŒæ—¶ï¼Œå¦‚æœdirBå†…æœ‰fileA2.txtå’ŒfileA1.txtè¿™ä¸¤ä¸ªè¢«æ’é™¤åŒæ­¥çš„æ–‡ä»¶ï¼Œä»ç„¶å°†å…¶åˆ é™¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsync -avz --exclude=&quot;fileA1.txt&quot; --exclude=&quot;fileA2.txt&quot; --delete-excluded dirA/ dirB/</span><br></pre></td></tr></table></figure></li></ul>]]></content>
    
    
    <summary type="html">åŒæ­¥</summary>
    
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/categories/linux%E5%91%BD%E4%BB%A4/"/>
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/tags/linux%E5%91%BD%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨Centosä¸­æ£€æŸ¥RPMåŒ…çš„ä¾èµ–æ€§</title>
    <link href="https://www.dddachui.top/posts/179557ff.html"/>
    <id>https://www.dddachui.top/posts/179557ff.html</id>
    <published>2022-09-25T03:00:30.000Z</published>
    <updated>2023-03-13T12:30:55.103Z</updated>
    
    <content type="html"><![CDATA[<h1>äº§ç”ŸåŸå› </h1><ol><li>å®šåˆ¶æœ¬åœ°yumæºçš„æ—¶å€™æ¼äº†å‡ ä¸ªä¾èµ–åŒ…,å¯¼è‡´è½¯ä»¶æ— æ³•å®‰è£…</li><li>é…ç½®çš„ä»“åº“åŒ…ä¸å®Œæ•´,ä¸‹è½½çš„è½¯ä»¶çš„æ—¶å€™ç¼ºå°‘å‡ ä¸ªåŒ…</li><li>ç”±äºç½‘ç»œç¯å¢ƒ,æ— æ³•é…ç½®å¤–ç½‘æº,åªèƒ½å¯¼å…¥rpmåŒ…,ä½†æ˜¯ç¼ºå°‘äº†å‡ ä¸ªä¾èµ–</li></ol><blockquote><p>å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œæ˜¯ä¸å…è®¸é…ç½®yumæºçš„</p></blockquote><h1>ä¸€ä¸ªç®€å•çš„æ —å­</h1><ul><li>å®‰è£…zabbixçš„æ—¶å€™ç¼ºå°‘ä¾èµ–</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -ivh zabbix-server-mysql-3.4.4-1.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><p>æŠ¥é”™å¦‚ä¸‹</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">error: Failed dependencies:</span><br><span class="line">libOpenIPMI.so<span class="number">.0</span>()(64bit) is needed by zabbix-server-mysql-<span class="number">3.4</span><span class="number">.4</span>-<span class="number">1.</span>el7.x86_64</span><br><span class="line">libOpenIPMIposix.so<span class="number">.0</span>()(64bit) is needed by zabbix-server-mysql-<span class="number">3.4</span><span class="number">.4</span>-<span class="number">1.</span>el7.x86_64</span><br><span class="line">libevent-<span class="number">2.0</span>.so<span class="number">.5</span>()(64bit) is needed by zabbix-server-mysql-<span class="number">3.4</span><span class="number">.4</span>-<span class="number">1.</span>el7.x86_64</span><br><span class="line">libiksemel.so<span class="number">.3</span>()(64bit) is needed by zabbix-server-mysql-<span class="number">3.4</span><span class="number">.4</span>-<span class="number">1.</span>el7.x86_64</span><br><span class="line">libnetsnmp.so<span class="number">.31</span>()(64bit) is needed by zabbix-server-mysql-<span class="number">3.4</span><span class="number">.4</span>-<span class="number">1.</span>el7.x86_64</span><br><span class="line">libodbc.so<span class="number">.2</span>()(64bit) is needed by zabbix-server-mysql-<span class="number">3.4</span><span class="number">.4</span>-<span class="number">1.</span>el7.x86_64</span><br></pre></td></tr></table></figure><p>æ˜¾ç„¶æ˜¯æœºå™¨å¯¼å…¥çš„rpmç¼ºå°‘ä¾èµ–åŒ…å¯¼è‡´çš„,ä½†æˆ‘ä»¬åªèƒ½çœ‹åˆ°æ–‡ä»¶,æ— æ³•çœ‹åˆ°è¿™ä¸ªæ–‡ä»¶åœ¨ä»€ä¹ˆåŒ…</p><ul><li>æŸ¥è¯¢åœ¨å“ªä¸ªrpmåŒ…</li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">yum</span> whatprovides libOpenIPMI.so.<span class="number">0</span></span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹,å¯ä»¥çœ‹åˆ°è¿™æ–‡ä»¶æ˜¯OpenIPMI-libsæä¾›çš„,æˆ‘ä»¬å¯ä»¥ç›´æ¥yumå®‰è£…,æˆ–è€…ç”±äºç½‘ç»œé—®é¢˜,å¯ä»¥ä¸‹è½½äº†å¯¼å…¥æœºå™¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Loaded plugins: langpacks, product-id, search-disabled-repos, versionlock</span><br><span class="line">OpenIPMI-libs-2.0.27-1.el7.i686 : The OpenIPMI runtime libraries</span><br><span class="line">Repo        : base</span><br><span class="line">Matched from:</span><br><span class="line">Provides    : libOpenIPMI.so.0</span><br></pre></td></tr></table></figure><ul><li><p>å®‰è£…</p><ul><li><p>ç›´æ¥å®‰è£…</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y OpenIPMI-libs-2.0.27-1.el7.i686</span><br></pre></td></tr></table></figure></li><li><p>ä¸‹è½½å¯¼å…¥</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">yumdownloader</span> --destdir=.   OpenIPMI-libs-<span class="number">2</span>.<span class="number">0</span>.<span class="number">27</span>-<span class="number">1</span>.el7.i686</span><br></pre></td></tr></table></figure></li></ul></li></ul><h1>ä¼˜åŒ–è§£å†³ä¾èµ–æ‰‹æ³•1</h1><p>é™¤äº†<code>yum whatprovides libOpenIPMI.so.0</code>è¿™ç§ç²—æš´æ–¹å¼,å…¶å®æˆ‘ä»¬æœ‰æ›´å¥½çš„æ–¹æ³•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum deplist  zabbix50-5.0.21-1.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><p>è¾“å‡ºå¦‚ä¸‹.å¯ä»¥çœ‹åˆ°ä»€ä¹ˆåŒ…éœ€è¦ä»€ä¹ˆ,ç”±è°æä¾›</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">Loaded plugins: langpacks, product-id, search-disabled-repos, versionlock</span><br><span class="line">package: zabbix50.x86_64 5.0.21-1.el7</span><br><span class="line">  dependency: config(zabbix50) = 5.0.21-1.el7</span><br><span class="line">   provider: zabbix50.x86_64 5.0.21-1.el7</span><br><span class="line">  dependency: libc.so.6()(64bit)</span><br><span class="line">   provider: glibc.x86_64 2.17-326.el7_9</span><br><span class="line">  dependency: libc.so.6(GLIBC_2.11)(64bit)</span><br><span class="line">   provider: glibc.x86_64 2.17-326.el7_9</span><br><span class="line">  dependency: libc.so.6(GLIBC_2.14)(64bit)</span><br><span class="line">   provider: glibc.x86_64 2.17-326.el7_9</span><br><span class="line">  dependency: libc.so.6(GLIBC_2.15)(64bit)</span><br><span class="line">   provider: glibc.x86_64 2.17-326.el7_9</span><br><span class="line">  dependency: libc.so.6(GLIBC_2.17)(64bit)</span><br><span class="line">   provider: glibc.x86_64 2.17-326.el7_9</span><br><span class="line">  dependency: libc.so.6(GLIBC_2.2.5)(64bit)</span><br><span class="line">   provider: glibc.x86_64 2.17-326.el7_9</span><br><span class="line">  dependency: libc.so.6(GLIBC_2.3)(64bit)</span><br><span class="line">   provider: glibc.x86_64 2.17-326.el7_9</span><br><span class="line">  dependency: libc.so.6(GLIBC_2.3.4)(64bit)</span><br><span class="line">   provider: glibc.x86_64 2.17-326.el7_9</span><br><span class="line">  dependency: libc.so.6(GLIBC_2.4)(64bit)</span><br><span class="line">   provider: glibc.x86_64 2.17-326.el7_9</span><br><span class="line">  dependency: libc.so.6(GLIBC_2.7)(64bit)</span><br><span class="line">   provider: glibc.x86_64 2.17-326.el7_9</span><br><span class="line">  dependency: libcrypto.so.10()(64bit)</span><br><span class="line">   provider: openssl-libs.x86_64 1:1.0.2k-25.el7_9</span><br><span class="line">  dependency: libcrypto.so.10(OPENSSL_1.0.1_EC)(64bit)</span><br><span class="line">   provider: openssl-libs.x86_64 1:1.0.2k-25.el7_9</span><br><span class="line">  dependency: libcrypto.so.10(OPENSSL_1.0.2)(64bit)</span><br><span class="line">   provider: openssl-libs.x86_64 1:1.0.2k-25.el7_9</span><br><span class="line">  dependency: libcrypto.so.10(libcrypto.so.10)(64bit)</span><br><span class="line">   provider: openssl-libs.x86_64 1:1.0.2k-25.el7_9</span><br><span class="line">  dependency: libcurl.so.4()(64bit)</span><br><span class="line">   provider: libcurl.x86_64 7.29.0-59.el7_9.1</span><br><span class="line">  dependency: libdl.so.2()(64bit)</span><br><span class="line">   provider: glibc.x86_64 2.17-326.el7_9</span><br><span class="line">  dependency: libm.so.6()(64bit)</span><br><span class="line">   provider: glibc.x86_64 2.17-326.el7_9</span><br><span class="line">  dependency: libm.so.6(GLIBC_2.2.5)(64bit)</span><br><span class="line">   provider: glibc.x86_64 2.17-326.el7_9</span><br><span class="line">  dependency: libpcre.so.1()(64bit)</span><br><span class="line">   provider: pcre.x86_64 8.32-17.el7</span><br><span class="line">  dependency: libpthread.so.0()(64bit)</span><br><span class="line">   provider: glibc.x86_64 2.17-326.el7_9</span><br><span class="line">  dependency: libpthread.so.0(GLIBC_2.2.5)(64bit)</span><br><span class="line">   provider: glibc.x86_64 2.17-326.el7_9</span><br><span class="line">  dependency: libresolv.so.2()(64bit)</span><br><span class="line">   provider: glibc.x86_64 2.17-326.el7_9</span><br><span class="line">  dependency: libssl.so.10()(64bit)</span><br><span class="line">   provider: openssl-libs.x86_64 1:1.0.2k-25.el7_9</span><br><span class="line">  dependency: libssl.so.10(libssl.so.10)(64bit)</span><br><span class="line">   provider: openssl-libs.x86_64 1:1.0.2k-25.el7_9</span><br><span class="line">  dependency: libz.so.1()(64bit)</span><br><span class="line">   provider: zlib.x86_64 1.2.7-20.el7_9</span><br><span class="line">  dependency: libz.so.1(ZLIB_1.2.0)(64bit)</span><br><span class="line">   provider: zlib.x86_64 1.2.7-20.el7_9</span><br><span class="line">  dependency: logrotate</span><br><span class="line">   provider: logrotate.x86_64 3.8.6-19.el7</span><br><span class="line">  dependency: rtld(GNU_HASH)</span><br><span class="line">   provider: glibc.x86_64 2.17-326.el7_9</span><br><span class="line">   provider: glibc.i686 2.17-326.el7_9</span><br></pre></td></tr></table></figure><h1>ä¼˜åŒ–è§£å†³ä¾èµ–æ‰‹æ³•2</h1><p>é…ç½®ä¸€å°å’Œç”Ÿäº§æµ‹è¯•ä¸€æ ·çš„è™šæ‹Ÿæœº</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install zabbix50-5.0.21-1.el7.x86_64.rpm</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨yum installä¼šè‡ªå·±æŸ¥è¯¢ä¾èµ–ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¾—åˆ°éœ€è¦çš„ä¾èµ–å…³ç³»</p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">æ­£åœ¨å®‰è£…</span><br><span class="line">ansible</span><br><span class="line">ä¸ºä¾èµ–è€Œå®‰è£…</span><br><span class="line"><span class="keyword">python</span>-babel</span><br><span class="line"><span class="keyword">python</span>-httplib2</span><br><span class="line"><span class="keyword">python</span>-jinja2</span><br><span class="line"><span class="keyword">python</span>-paramiko</span><br><span class="line">python2-jmespath</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å†æ¬¡ç”¨<code>yumdownloader</code>å‘½ä»¤è¿›è¡Œä¸‹è½½åŒ…</p><h1>ä¼˜åŒ–è§£å†³ä¾èµ–æ‰‹æ³•3</h1><p>æˆ‘å¸¸ç”¨çš„æ–¹æ³•,ä½†<code>éœ€è¦æ³¨æ„</code>çš„æ˜¯,ä½¿ç”¨<code>yumdownloader</code>çš„æ—¶å€™,ä»–ä¼šæ£€æµ‹æœ¬æœºçš„rpmåŒ…,ç„¶åä¸‹è½½è½¯ä»¶ç¼ºå¤±çš„ä¾èµ–åŒ…,é‚£ä¹ˆå°±æ˜¯è¯´,å¦‚æœæˆ‘æœ¬æœºå’Œç›®çš„rpmåˆ—è¡¨æœ‰å‡ºå…¥,å¯èƒ½æˆ‘æœ¬æœºçš„åŒ…æ›´å¤š,é‚£ä¹ˆæˆ‘ä¸‹è½½çš„ä¾èµ–å¯èƒ½æ›´å°‘,é‚£ä¹ˆå¯¼å…¥ç›®æ ‡æœºå™¨ç»“æœä¾èµ–å¯èƒ½è¿˜æ˜¯æ²¡è§£å†³,æ‰€ä»¥æˆ‘ä»¬è¿™ä¸ªæ‰‹æ³•è¿˜æ˜¯éœ€è¦ä¿æŒä¿©å°æœºå™¨çš„ç¯å¢ƒä¸€è‡´</p><figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yumdownloader --destdir=<span class="regexp">/root/</span>Desktop/rpms --resolve ansible</span><br></pre></td></tr></table></figure><h1>å°å·¥å…·-rpmreaper</h1><p>æœ¬æ¥æ˜¯ç”¨ä½œæ¸…ç†ç³»ç»Ÿä¸­æ— ç”¨ä»¥åŠå®ƒä»¬æ‰€ä¾èµ–çš„åŒ…ï¼Œå®ƒæœ‰å¾ˆç›´è§‚çš„ncursesç•Œé¢æ¥å±•ç¤ºå·²å®‰è£…çš„åŒ…å’Œå®ƒä»¬ä¾èµ–å…³ç³»çš„æ ‘å½¢å›¾</p><ul><li>å®‰è£…</li></ul><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum <span class="keyword">install</span> rpmreaper</span><br></pre></td></tr></table></figure><ul><li>è¿è¡Œ</li></ul><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">rpmreaper</span></span><br></pre></td></tr></table></figure><p>rpmrepaterä¼šå‘ç”¨æˆ·æ˜¾ç¤ºå·²å®‰è£…åŒ…çš„åˆ—è¡¨</p><ol><li><p>ä½ å¯ä»¥ä½¿ç”¨ä¸Š/ä¸‹ç®­å¤´æ¥æ»šåŠ¨å±å¹•</p></li><li><p>ä½ å¯ä»¥åœ¨æŒ‡å®šåŒ…ä¸Šä½¿ç”¨&quot;r&quot;é”®æ¥æ˜¾ç¤ºå…¶ä¾èµ–å…³ç³»ï¼Œå¾ªç¯åœ¨æŒ‡å®šåŒ…ä¸ŠæŒ‰ä¸‹&quot;r&quot;é”®å¯ä»¥å±•ç¤ºå‡ºä½™ä¸‹çš„ä¿¡æ¯</p></li><li><p>&quot;L&quot;æ ‡å¿—çš„æ„æ€æ˜¯è¯´è¿™ä¸ªåŒ…æ˜¯ä¸€ç‰‡â€œå­¤å¶â€ï¼Œæ„æ€è¯´è¯´æ²¡æœ‰ä»»ä½•åŒ…ä¾èµ–å®ƒ</p></li><li><p>&quot;o&quot;æ ‡å¿—æ˜¯è¯´è¿™ä¸ªåŒ…æ˜¯æ•´ä¸ªä¾èµ–é“¾çš„ä¸­é—´éƒ¨åˆ†</p></li><li><p>æŒ‰ä¸‹&quot;b&quot;é”®ä¼šæ˜¾ç¤ºå…¶ä»–ä¾èµ–äºè¯¥åŒ…çš„å…¶ä»–åŒ…</p></li></ol><h1>å°å·¥å…·-yumex</h1><p>yum Extender (ç®€ç§° yumex ) , æ˜¯ yum çš„å›¾å½¢åŒ–æ“ä½œç•Œé¢ã€‚å¯ä»¥é€šè¿‡ yumex æ–¹ä¾¿çš„æŸ¥çœ‹è½¯ä»¶åŒ…ï¼Œå®‰è£…ã€å¸è½½è½¯ä»¶åŒ…ã€‚å¯¹äºå¯¹å‘½ä»¤è¡Œä¸ç†Ÿçš„äººç®€ç›´å°±æ˜¯ç¥å¥‡ï¼Œç®¡ç†è½¯ä»¶åŒ…å¾ˆæ–¹ä¾¿</p><ul><li>å®‰è£…</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install yumex</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yumex --root</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">è§£å†³ä¾èµ–é—®é¢˜</summary>
    
    
    
    <category term="æ•…éšœå¤„ç†" scheme="https://www.dddachui.top/categories/%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86/"/>
    
    
    <category term="æ•…éšœå¤„ç†" scheme="https://www.dddachui.top/tags/%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>å±€åŸŸç½‘ipå†²çªè§£å†³æ–¹æ³•</title>
    <link href="https://www.dddachui.top/posts/771f3e87.html"/>
    <id>https://www.dddachui.top/posts/771f3e87.html</id>
    <published>2022-09-25T02:36:51.000Z</published>
    <updated>2023-03-13T12:27:58.001Z</updated>
    
    <content type="html"><![CDATA[<h1>é—®é¢˜æè¿°</h1><p>ç”±äºåœ¨ä¸€ä¸ªç½‘æ®µä¸‹é¢ipåœ°å€æ˜¯å”¯ä¸€çš„,å½“äº§ç”Ÿ2ä¸ªä¸€æ ·çš„ipçš„æ—¶å€™å°±ä¼šå‡ºç°ç½‘ç»œæ•…éšœ,å¯ä»¥hiä½¿ç”¨ä¸€ä¸ªå·¥å…·<code>arp-scan</code>æ¥æ‰«æå®ƒä»¬ï¼Œè¿™ä¸ªå·¥å…·ä¼šåœ¨æœ¬åœ°ç½‘ç»œå‘é€ARPï¼ˆAddress Resolution Protocolï¼‰(åœ°å€è§£æåè®®)åŒ…æ¥æ”¶é›†åœ°å€ã€‚å¦‚æœæœ‰å¤šä¸ªMACåœ°å€å£°ç§°æ‹¥æœ‰ç›¸åŒçš„IPåœ°å€ï¼Œé‚£ä¹ˆå°±å­˜åœ¨å†²çª</p><h1>å®‰è£…è½¯ä»¶</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y arp-scan</span><br></pre></td></tr></table></figure><h1>å†²çªæ£€æµ‹</h1><p>æŒ‡å®šeth1ç½‘å¡è¿›è¡Œæ£€æµ‹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arp-scan  --interface=eth1 -l</span><br></pre></td></tr></table></figure><h1>è¾“å‡ºç»“æœ</h1><p>è™šæ‹Ÿæœºä¸æ˜¯å¾ˆå‡†,å®é™…ä¸Šæ˜¯å¯ä»¥çœ‹åˆ°<code>DUP</code>çš„æŠ¥é”™</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">192</span>.<span class="number">168</span>.<span class="number">42</span>.<span class="number">1</span><span class="number">00</span>:<span class="number">50</span>:<span class="number">56</span>:c0:<span class="number">00</span>:<span class="number">08</span>VMware, Inc.</span><br><span class="line"><span class="attribute">192</span>.<span class="number">168</span>.<span class="number">42</span>.<span class="number">2</span><span class="number">00</span>:<span class="number">50</span>:<span class="number">56</span>:e1:<span class="number">0</span>b:edVMware, Inc.</span><br><span class="line"><span class="attribute">192</span>.<span class="number">168</span>.<span class="number">42</span>.<span class="number">254</span><span class="number">00</span>:<span class="number">50</span>:<span class="number">56</span>:e4:eb:<span class="number">75</span>VMware, Inc.</span><br><span class="line"><span class="attribute">192</span>.<span class="number">168</span>.<span class="number">42</span>.<span class="number">2</span><span class="number">00</span>:<span class="number">50</span>:<span class="number">56</span>:e1:<span class="number">0</span>b:edVMware, Inc. (DUP: <span class="number">2</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">ipå†²çª</summary>
    
    
    
    <category term="æ•…éšœå¤„ç†" scheme="https://www.dddachui.top/categories/%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86/"/>
    
    
    <category term="æ•…éšœå¤„ç†" scheme="https://www.dddachui.top/tags/%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>Linuxå¥½ç”¨å‘½ä»¤ä¹‹tar</title>
    <link href="https://www.dddachui.top/posts/2208ab89.html"/>
    <id>https://www.dddachui.top/posts/2208ab89.html</id>
    <published>2022-09-23T14:48:34.000Z</published>
    <updated>2023-03-13T12:51:01.596Z</updated>
    
    <content type="html"><![CDATA[<h1>å‘½ä»¤ç®€ä»‹</h1><p>Unixå’Œ<a href="https://baike.baidu.com/item/%E7%B1%BBUnix%E7%B3%BB%E7%BB%9F/4336219?fromModule=lemma_inlink">ç±»Unixç³»ç»Ÿ</a>ä¸Šçš„å‹ç¼©æ‰“åŒ…å·¥å…·ï¼Œå¯ä»¥å°†å¤šä¸ªæ–‡ä»¶åˆå¹¶ä¸ºä¸€ä¸ªæ–‡ä»¶ï¼Œæ‰“åŒ…åçš„æ–‡ä»¶åç¼€äº¦ä¸º<strong>tar</strong></p><h1>å‚æ•°</h1><h2 id="åŠŸèƒ½">åŠŸèƒ½</h2><ul><li>-c åˆ›å»ºå‹ç¼©æ–‡ä»¶</li><li>-x  è§£å‹ç¼©,æå–</li><li>-t  æŸ¥çœ‹å‹ç¼©åŒ…å†…å®¹</li><li>-r  é™„åŠ æ–°çš„æ–‡ä»¶åˆ°taræ–‡ä»¶ä¸­</li><li>-u ç”¨å·²æ‰“åŒ…çš„æ–‡ä»¶çš„è¾ƒæ–°ç‰ˆæœ¬æ›´æ–°taræ–‡ä»¶</li><li>-A å°†taræ–‡ä»¶ä½œä¸ºä¸€ä¸ªæ•´ä½“è¿½åŠ åˆ°å¦ä¸€ä¸ªtaræ–‡ä»¶ä¸­</li><li>-d,â€“compare å°†æ–‡ä»¶ç³»ç»Ÿé‡Œçš„æ–‡ä»¶å’Œtaræ–‡ä»¶é‡Œçš„æ–‡ä»¶è¿›è¡Œæ¯”è¾ƒ</li><li>â€“delete  åˆ é™¤taræ–‡ä»¶é‡Œçš„æ–‡ä»¶</li></ul><h2 id="å¸¸ç”¨é€‰é¡¹">å¸¸ç”¨é€‰é¡¹</h2><ul><li>-v å•°å—¦æ¨¡å¼,å±•ç¤ºè¿‡ç¨‹</li><li>-z é€šè¿‡gzipæŒ‡ä»¤å‹ç¼©/è§£å‹ç¼©æ–‡ä»¶,æ–‡ä»¶åç¼€åè‡ªå·±åŠ <code>*.tar.gz</code></li><li>-p ä¿ç•™åŸæ¥çš„æ–‡ä»¶æƒé™ä¸å±æ€§</li><li>â€“exclude= æ’é™¤</li><li>-C ä»…å‹ç¼©æŒ‡å®šç›®å½•é‡Œçš„å†…å®¹æˆ–è§£å‹ç¼©åˆ°æŒ‡å®šç›®å½•</li></ul><h1>æ‰“åŒ…å‹ç¼©</h1><ul><li>ç»å…¸æ‰“åŒ…</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -czvf test.tar.gz  shell/  a.txt   b.sh</span><br></pre></td></tr></table></figure><ul><li>å‹ç¼©å¸¦å±æ€§</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -czvpf log31.tar.gz log2014.log log2015.log log2016.log</span><br></pre></td></tr></table></figure><ul><li>å‹ç¼©æ’é™¤æŸäº›æ–‡ä»¶å¤¹</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar --exclude=/opt/test/a -czvf test.tar.gz /opt/test</span><br></pre></td></tr></table></figure><h1>åˆ—ä¸¾æŸ¥çœ‹å‹ç¼©åŒ…</h1><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -tvf test<span class="selector-class">.tar</span><span class="selector-class">.gz</span> </span><br></pre></td></tr></table></figure><h1>è§£å‹ç¼©</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xvf test.tar.gz</span><br></pre></td></tr></table></figure><ul><li>è§£å‹éƒ¨åˆ†æ–‡ä»¶</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xzvf  log.tar.gz  test/a.log</span><br></pre></td></tr></table></figure><blockquote><p>è¿™ä¸ªè¦å…ˆç”¨-tvfåˆ—ä¸¾å‡ºå…·ä½“è·¯å¾„,ä¸ç„¶æ‰¾ä¸åˆ°æˆ‘ç¤ºä¾‹çš„test/a.log</p></blockquote><ul><li>è§£å‹åˆ°æŒ‡å®šä½ç½®</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xvf a.tar.gz -C /opt</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">å‹ç¼©</summary>
    
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/categories/linux%E5%91%BD%E4%BB%A4/"/>
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/tags/linux%E5%91%BD%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title>linuxçš„é©±åŠ¨é—®é¢˜</title>
    <link href="https://www.dddachui.top/posts/8715157e.html"/>
    <id>https://www.dddachui.top/posts/8715157e.html</id>
    <published>2022-09-23T04:49:22.000Z</published>
    <updated>2023-03-13T12:28:43.999Z</updated>
    
    <content type="html"><![CDATA[<h1>å‰è¨€</h1><p>å®‰è£…windowsç³»ç»Ÿä¸€èˆ¬éƒ½ä¼šä¸‹è½½<code>é©±åŠ¨æ€»è£</code>æˆ–è€…<code>é²å¤§å¸ˆ</code>,åˆæˆ–è€…é€šè¿‡å¾®è½¯çš„è‡ªåŠ¨æ›´æ–°æ¥æ›´æ–°ç³»ç»Ÿçš„é©±åŠ¨,ä½†åœ¨Linuxé‡Œé¢,é©±åŠ¨ä¸€èˆ¬æ˜¯é›†æˆåœ¨linuxå†…æ ¸é‡Œé¢çš„,å¦‚æœæˆ‘ä»¬æœ‰ä¸€ä¸ªpciè®¾å¤‡æ²¡æœ‰é©±åŠ¨ä¸”å†…æ ¸ä¸æ”¯æŒè¯¥æ€ä¹ˆå¤„ç†?</p><h1>æŸ¥çœ‹è®¾å¤‡é©±åŠ¨</h1><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">lspci -k</span> </span><br></pre></td></tr></table></figure><p>å¯ä»¥å…ˆæµè§ˆä¸€éæ‰€æœ‰çš„pciè®¾å¤‡,åªéœ€è¦å…³æ³¨æ¯ä¸ªè®¾å¤‡æ˜¯å¦æœ‰<code>Kernel driver in use</code>ç­‰å­—æ ·,å¦‚æœæœ‰çš„è¯å°±ä»£è¡¨è¯¥è®¾å¤‡å¯ä»¥é©±åŠ¨</p><ul><li>ä¸¾ä¸ªä¾‹å­</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">02</span>:<span class="number">01.0</span> Ethernet controller: Intel Corporation 82545EM Gigabit Ethernet <span class="title function_">Controller</span> <span class="params">(Copper)</span> (rev <span class="number">01</span>)</span><br><span class="line">DeviceName: Ethernet0</span><br><span class="line">Subsystem: VMware PRO/<span class="number">1000</span> MT Single Port Adapter</span><br><span class="line">Kernel driver in use: e1000</span><br><span class="line">Kernel modules: e1000</span><br></pre></td></tr></table></figure><p>ä¾‹å¦‚æˆ‘æœ‰ä¸€ä¸ªç½‘å¡,ä»–æˆåŠŸåŠ è½½äº†e1000çš„é©±åŠ¨,è¿™æ ·å°±ä»£è¡¨æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¯¥ç½‘å¡</p><h1>æ²¡æœ‰é©±åŠ¨çš„å¤„ç†</h1><p>å¦‚æœæ²¡æœ‰<code>Kernel driver in use</code>å­—æ ·,å¤„ç†æ‰‹æ®µä¸€èˆ¬æ˜¯<code>ç¡®è®¤ç¡¬ä»¶å‹å·</code>-&gt;<code>æœå¯»æºä»£ç </code>-&gt;<code>ç¼–è¯‘å®‰è£…</code>æ¥è§£å†³çš„</p><h2 id="ç¡®å®šå‹å·">ç¡®å®šå‹å·</h2><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lspci -<span class="keyword">nn</span> | <span class="keyword">grep</span> -i eth</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬é€šè¿‡<code>-nn</code>å‚æ•°æ¥å°†<code>å‚å•†å·:è®¾å¤‡å·</code>è¾“å‡ºå¦‚ä¸‹</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">02</span>:<span class="number">01</span>.<span class="number">0</span> Ethernet : Intel Corporation <span class="number">82545</span>EM Gigabit <span class="meta"> [8086:100f] (rev 01)</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­,æˆ‘ä»¬åªéœ€è¦å…³æ³¨<code>[8086:100f]</code>è¿™ç»„æ•°æ®å°±å¯ä»¥äº†</p><h2 id="å«ä¹‰">å«ä¹‰</h2><p><code>8086</code>æ˜¯å‚å•†å·,ä»£è¡¨æŸå®¶å‚å•†,<code>100f</code>æ˜¯è®¾å¤‡å·,ä»£è¡¨è¯¥å‚å•†çš„äº§å“</p><p>ä¸€èˆ¬æ¥è¯´,å¦‚æœå†…æ ¸å®Œå…¨ä¸è®¤ç½‘å¡çš„è¯æˆ‘ä»¬åªèƒ½çœ‹å‡ºäº§å“åå­—å†™çš„æ˜¯<code>Ethernet</code>,ä¹Ÿæœ‰ä¸€éƒ¨åˆ†ç³»ç»Ÿ<code>å¯ä»¥è®¤å‡ºå…¨å</code>,å¦‚æœèƒ½è®¤å‡ºå…¨åæˆ‘ä»¬ç›´æ¥æœç´¢å…¨åå°±å¯ä»¥äº†,ä½†å¦‚æœæ²¡æœ‰å…¨åæˆ‘ä»¬åªèƒ½ä¾èµ–<code>å‚å•†å·:è®¾å¤‡å·</code>æ¥å®šä½è®¾å¤‡</p><h2 id="ç½‘é¡µæœç´¢">ç½‘é¡µæœç´¢</h2><p>ç™»é™†<a href="https://devicehunt.com/">devicehuntç½‘ç«™</a>,æˆ‘ä»¬åªéœ€è¦å°†æˆ‘ä»¬çš„<code>device id</code>,å³æˆ‘ä¾‹å­ä¸­çš„<code>100f</code>å¡«å…¥æœç´¢æ¡†,ä»–å°±ä¼šå°†è¯¥è®¾å¤‡çš„åå­—æŸ¥è¯¢å‡ºæ¥,ç±»ä¼¼è¿™ç§ç½‘ç«™çš„è¿˜æœ‰å¾ˆå¤š,æ¯”å¦‚ <a href="http://pci-ids.ucw.cz/read/PC/8088/0107">pci-ids.ucw.cz</a></p><h2 id="æŸ¥æ‰¾é©±åŠ¨">æŸ¥æ‰¾é©±åŠ¨</h2><p>æ—¢ç„¶å·²ç»çŸ¥é“å‹å·äº†,é‚£ä¹ˆå°±å¯ä»¥æœç´¢å¯¹åº”çš„é©±åŠ¨æºä»£ç ,ä¸€èˆ¬æ‰¾çš„ç½‘ç«™æœ‰å¦‚ä¸‹</p><ol><li>å„ä¸ªäº§å“çš„å®˜ç½‘</li><li>githubæˆ–è€…gitee</li><li>æˆ‘ä¸çŸ¥é“äº†</li></ol><p>å‡è®¾æˆ‘ä»¬æˆåŠŸçš„æ‰¾åˆ°çš„æŸä¸ªäº§å“çš„é©±åŠ¨æºä»£ç ,æˆ‘ä»¬åªéœ€è¦å¯¼å…¥æˆ‘ä»¬çš„<code>linuxå‘è¡Œç‰ˆ</code>è¿›è¡Œç¼–è¯‘å®‰è£…</p><h1>ç¼–è¯‘å®‰è£…</h1><p>ä¾‹å¦‚æˆ‘æˆåŠŸåœ¨<code>INTEL</code>å®˜ç½‘ä¸‹è½½äº†<code>e1000e-3.8.7.tar.gz</code>æºç åŒ…</p><ul><li>è§£å‹æºç åŒ…</li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">tar</span> -xvf e1000e-<span class="number">3</span>.<span class="number">8</span>.<span class="number">7</span>.tar.gz</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹README</li></ul><p>æ¯ä¸ªäº§å“éƒ½ä¼šæœ‰ç±»ä¼¼çš„<code>README</code>æ–‡æ¡£æ¥æŒ‡å¯¼ä½ å¦‚ä½•ä½¿ç”¨,ä¾‹å¦‚æœ‰å¦‚ä¸‹2ç§æ–¹å¼,ç¬¬ä¸€ç§å°±æ˜¯è®©æˆ‘ä»¬ç”¨<code>rpmbuild</code>æ¥è‡ªå·±ç”Ÿæˆä¸€ä¸ª<code>rpm</code>åŒ…,ç¬¬äºŒç§ä¼šè®©æˆ‘ç”Ÿæˆä¸€ä¸ª<code>ko</code>æ–‡ä»¶,ç„¶åå®‰è£…åˆ°å†…æ ¸é‡Œé¢å»,ç„¶åæˆ‘ä»¬å†å»ä½¿ç”¨<code>lspci</code>æŸ¥çœ‹é©±åŠ¨çš„åŠæ³•æ¥éªŒè¯æ˜¯å¦è®°è½½é©±åŠ¨å°±å¯ä»¥äº†</p><ol><li><code>rpmbuild -tb e1000e-&lt;x.x.x&gt;.tar.gz</code></li><li>æ‰‹åŠ¨ç¼–è¯‘<ol><li>æŸ¥çœ‹å…·ä½“æ­¥éª¤,æ˜¯å¦è¦å…ˆ./configure</li><li>makeç¼–è¯‘</li><li>insmod xx.ko æ‰‹åŠ¨åŠ è½½é©±åŠ¨</li><li>ä½¿ç”¨lspci -nvs 01:00.0è¿™ç§æ¥çœ‹è®¾å¤‡çš„é©±åŠ¨æ˜¯å¦åŠ è½½</li><li>å¦‚æœåŠ è½½æˆåŠŸå°±make install</li></ol></li></ol><blockquote><ol><li>makera,centosè¿™äº›ç³»ç»Ÿæœ‰çš„å‘½ä»¤</li><li>make,gcc,g++è¿™ç§å‘½ä»¤å±äºå¼€å‘å·¥å…·,å¦‚æœç³»ç»Ÿæ²¡æœ‰çš„è¯éœ€è¦è‡ªå·±å®‰è£…</li></ol></blockquote>]]></content>
    
    
    <summary type="html">å¦‚ä½•åˆ¤æ–­æœ‰æ²¡æœ‰é©±åŠ¨?</summary>
    
    
    
    <category term="æ•…éšœå¤„ç†" scheme="https://www.dddachui.top/categories/%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86/"/>
    
    
    <category term="æ•…éšœå¤„ç†" scheme="https://www.dddachui.top/tags/%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>Linuxå¥½ç”¨å‘½ä»¤ä¹‹strace</title>
    <link href="https://www.dddachui.top/posts/dd9530c1.html"/>
    <id>https://www.dddachui.top/posts/dd9530c1.html</id>
    <published>2022-09-22T14:35:23.000Z</published>
    <updated>2023-03-13T12:50:51.898Z</updated>
    
    <content type="html"><![CDATA[<h1>å‘½ä»¤ç®€ä»‹</h1><p>straceæ˜¯ç”¨æ¥è¯Šæ–­,è°ƒè¯•çš„linuxç”¨æˆ·ç©ºé—´è·Ÿè¸ªå™¨,æ¥ç›‘è§†ç”¨æˆ·ç©ºé—´è¿›ç¨‹å’Œå†…æ ¸äº¤äº’,æ¯”å¦‚ç³»ç»Ÿè°ƒç”¨,ä¿¡å·ä¼ é€’,è¿›ç¨‹çŠ¶æ€å˜æ›´</p><h1>ç¤ºä¾‹</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strace -tt -T -v -f -e [close|openat|execve] -o log  ./ceshi.sh -p &lt;pid&gt;</span><br></pre></td></tr></table></figure><h1>å¸¸ç”¨é€‰é¡¹</h1><ul><li>-tt : æ˜¾ç¤ºæ¯«ç§’çº§åˆ«</li><li>-T : æ˜¾ç¤ºæ¯æ¬¡ç³»ç»Ÿè°ƒç”¨æ‰€æ¶ˆè€—çš„æ—¶é—´</li><li>-v : å¯¹äºæŸäº›ç›¸å…³çš„è°ƒç”¨,å±•ç¤ºå®Œæ•´çš„ç¯å¢ƒå˜é‡,æ–‡ä»¶statç»“æ„</li><li>-f : è·Ÿè¸ªç›®æ ‡è¿›ç¨‹ä»¥åŠç›®æ ‡è¿›ç¨‹åˆ›å»ºçš„å­è¿›ç¨‹</li><li>-e : æ§åˆ¶è¦è·Ÿè¸ªçš„æ—¶é—´å’Œè·Ÿè¸ªè¡Œä¸º,æ¯”å¦‚æŒ‡å®šè¦è·Ÿè¸ªçš„ç³»ç»Ÿè°ƒç”¨åç§°</li><li>-o : æŠŠstraceè¾“å‡ºå•ç‹¬å†™åˆ°æ–‡ä»¶</li><li>-s : ç³»ç»Ÿè°ƒç”¨æŸä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²çš„å››è¡Œ,æœ€å¤šè¾“å‡ºæŒ‡å®šé•¿åº¦çš„å†…å®¹,é»˜è®¤32å­—èŠ‚</li><li>-p : æŒ‡å®šè¦è·Ÿè¸ªçš„è¿›ç¨‹pid å¤šä¸ªpidå†™å¤šä¸ª-p</li></ul>]]></content>
    
    
    <summary type="html">è¯Šæ–­,è°ƒè¯•linuxç”¨æˆ·ç©ºé—´è·Ÿè¸ªå™¨</summary>
    
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/categories/linux%E5%91%BD%E4%BB%A4/"/>
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/tags/linux%E5%91%BD%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title>ç³»ç»Ÿèµ„æºå¼‚å¸¸å¤„ç†æ€è·¯</title>
    <link href="https://www.dddachui.top/posts/e853bb7.html"/>
    <id>https://www.dddachui.top/posts/e853bb7.html</id>
    <published>2022-09-22T06:07:16.000Z</published>
    <updated>2023-03-13T12:29:25.558Z</updated>
    
    <content type="html"><![CDATA[<h1>å¸¸è§èµ„æºé—®é¢˜</h1><ol><li>ç³»ç»Ÿæ“ä½œå¡é¡¿</li><li>cpu,å†…å­˜èµ„æºå ç”¨è¿‡é«˜</li><li>è¿›ç¨‹å ç”¨èµ„æºé«˜</li><li>ç³»ç»Ÿå¼‚å¸¸é‡å¯æˆ–å®•æœº</li><li>å¼€æœºæ—¶é—´é•¿</li></ol><h1>èµ„æºå¼‚å¸¸å¤„ç†æ€è·¯</h1><h2 id="æ—¥å¿—åˆ†æ">æ—¥å¿—åˆ†æ</h2><ul><li>dmesg</li><li>/var/log/*</li><li>ä¸²å£è°ƒè¯•</li><li>~/.xsession-errors</li></ul><h2 id="å¡é¡¿åˆ†æ">å¡é¡¿åˆ†æ</h2><ul><li>æœ¬åœ°å¡é¡¿è¿˜æ˜¯è¿œç¨‹å¡é¡¿</li></ul><h2 id="å¼‚å¸¸è¿›ç¨‹">å¼‚å¸¸è¿›ç¨‹</h2><ul><li>straceè¿›ç¨‹è·Ÿè¸ª</li><li>pstackè¿›ç¨‹è·Ÿè¸ª</li><li>jstackè¿›ç¨‹è·Ÿè¸ª(é’ˆå¯¹java)</li></ul><h2 id="æ›´æ¢ç”¨æˆ·æµ‹è¯•">æ›´æ¢ç”¨æˆ·æµ‹è¯•</h2><ul><li>åˆ‡æ¢ç”¨æˆ·æ²¡æœ‰é—®é¢˜åˆ™è€ƒè™‘~/.conf  ~/.cache ç¯å¢ƒå˜é‡</li></ul><h2 id="æ˜¯å¦å’Œæ˜¾å¡æœ‰å…³ç³»">æ˜¯å¦å’Œæ˜¾å¡æœ‰å…³ç³»</h2><ul><li>æ˜¯å¦æœ‰ç¡¬ä»¶åŠ é€Ÿ</li><li>æ›´æ¢ç¡¬ä»¶</li><li>xdriinfoæˆ–Xorg.0.logæ—¥å¿—åˆ†æ</li></ul><h2 id="å†…æ ¸æˆ–é©±åŠ¨">å†…æ ¸æˆ–é©±åŠ¨</h2><ul><li>å‡çº§é©±åŠ¨(<a href="http://kernel.org">kernel.org</a>)</li><li>å‡çº§å†…æ ¸</li></ul><h2 id="coreæ–‡ä»¶">coreæ–‡ä»¶</h2><ul><li>tmpç›®å½•ä¸‹æ˜¯å¦æœ‰core,æˆ–è€…ç¬¬ä¸‰æ–¹ç¨‹åºä¸‹æ˜¯å¦æœ‰</li><li>gdbè°ƒè¯•</li></ul><h2 id="æ˜¯å¦ä¸æ¡Œé¢å›¾å½¢ç›¸å…³">æ˜¯å¦ä¸æ¡Œé¢å›¾å½¢ç›¸å…³</h2><ul><li>topçœ‹å›¾å½¢è¿›ç¨‹å ç”¨</li><li>å…³é—­å›¾å½¢æ˜¯å¦ä¸´æ—¶è§£å†³</li><li>lightdm/gdmæœåŠ¡çŠ¶æ€</li></ul><h1>linuxæ€§èƒ½åˆ†æå·¥å…·</h1><h2 id="cpu">cpu</h2><ul><li>top :  æ˜¾ç¤ºç³»ç»Ÿå’Œè¿›ç¨‹cpu,å†…å­˜å…³ç³»</li><li>uptime :  ç³»ç»Ÿå¹³å‡è´Ÿè½½</li><li>vmstat :  æŠ¥å‘Šå’Œé‡‡æ ·å†…å­˜,io,cpuä¿¡æ¯</li><li>procinfo :  cpuå’Œä¸­æ–­ä¿¡æ¯</li><li>mpstat :  åˆ†æcpu</li><li>sar :  åˆ†æcpu</li><li>oprofile :  åˆ†æç³»ç»Ÿ,è¿›ç¨‹çš„æ¶ˆè€—</li><li>perf :  åˆ†æcpuè°ƒç”¨è·¯å¾„å’Œæ¶ˆè€—</li><li>time :  è¿›ç¨‹cpuä½¿ç”¨ä¿¡æ¯</li><li>strace :  ç³»ç»Ÿè°ƒç”¨ä¿¡æ¯</li><li>lstrace :  åº“å‡½æ•°è°ƒç”¨ä¿¡æ¯å’Œè€—æ—¶</li><li>ps :  å¯¹ç‰¹å®šè¿›ç¨‹åˆ†æ</li><li>pidstat :  åˆ†æè¿›ç¨‹å¯¹cpuçš„å ç”¨</li></ul><h2 id="å†…å­˜">å†…å­˜</h2><ul><li>vmstat :  åˆ†æå†…å­˜,io,cpu</li><li>free :  å±•ç¤ºç³»ç»Ÿå’Œè¿›ç¨‹cpu,å†…å­˜,ä½¿ç”¨æƒ…å†µ</li><li>slabtop :  å†…æ ¸ç¼“å­˜åˆ†é…å’Œä½¿ç”¨æƒ…å†µ</li><li>sar -r :  å†…å­˜ä¿¡æ¯</li><li>/proc/memoryinfo :  å†…å­˜ä¿¡æ¯</li><li>ps  :  è¿›ç¨‹å’Œå†…å­˜å…³ç³»</li><li>/proc/<pid>/mem :  è¿›ç¨‹å†…å­˜ä¿¡æ¯</li><li>memprof :  å›¾å½¢åŒ–å†…å­˜åˆ†æ</li><li>kcachegnnd :  å›¾å½¢åŒ–å†…å­˜åˆ†æ</li><li>/proc/iomem :  ç‰©ç†åœ°å€åˆ†é…ä¿¡æ¯</li><li>pmap :  è¿›ç¨‹å†…å­˜æ˜ å°„ä¿¡æ¯</li></ul><h2 id="ç£ç›˜">ç£ç›˜</h2><ul><li>iostat :  ç»Ÿè®¡è®¾å¤‡å’Œåˆ†åŒºç£ç›˜IOä¿¡æ¯</li><li>iotop :  åˆ—å‡ºè¿›ç¨‹ç£ç›˜IOä¿¡æ¯</li><li>sar -d :  æŠ¥å‘Šç£ç›˜IOç›¸å…³ä¿¡æ¯</li><li>blktrace :  è·Ÿè¸ªç£ç›˜IOæ—¶é—´</li><li>lsof :  åˆ—å‡ºè¿›ç¨‹æ‰“å¼€æ–‡ä»¶,ç›®å½•ä¿¡æ¯</li><li>pidstat -d  :  è¿›ç¨‹ç£ç›˜ioç»Ÿè®¡ä¿¡æ¯</li><li>dd :  æµ‹é€Ÿ</li><li>dstat :  å…¨èƒ½çš„ç³»ç»Ÿä¿¡æ¯ç»Ÿè®¡å·¥å…·</li><li>fio :  æµ‹é€Ÿ</li><li>mount :  æŒ‚è½½</li><li>badblocks :  æ£€æŸ¥ç£ç›˜æŸåçš„åŒºå—</li></ul><h2 id="ç½‘ç»œ">ç½‘ç»œ</h2><ul><li>nmcli :  ç½‘ç»œé…ç½®å·¥å…·</li><li>ifconfig :  ç½‘ç»œæ¥å£å’Œç»Ÿè®¡</li><li>iperf :  æµé‡æ£€æµ‹</li><li>tcpdump :  æŠ“åŒ…</li><li>wireshark :  å›¾å½¢åŒ–æŠ“åŒ…</li><li>ss :  å¥—æ¥å­—åˆ†æ</li><li>netstat :  ç»Ÿè®¡ç½‘ç»œåè®®å’Œæ¥å£ä¿¡æ¯</li><li>ethtool :  ç»Ÿè®¡ä»¥å¤ªç½‘è®¾å¤‡ä¿¡æ¯</li><li>ping :  ä¸‡èƒ½çš„pingæ£€æµ‹</li><li>tracerout :  è·Ÿè¸ªè·¯ç”±</li><li>route :  æ˜¾ç¤ºè·¯ç”±</li></ul><h1>è¿›ç¨‹åˆ†æ</h1><h2 id="è¿›ç¨‹çš„ç›¸å…³çŸ¥è¯†">è¿›ç¨‹çš„ç›¸å…³çŸ¥è¯†</h2><h2 id="è¿›ç¨‹å«ä¹‰">è¿›ç¨‹å«ä¹‰</h2><ul><li><p>è¿è¡Œä¸­çš„ç¨‹åºå‰¯æœ¬(æŒ‡ä»¤åŠ æ•°æ®)</p></li><li><p>ç†æƒ³çŠ¶æ€ä¸‹æ˜¯70%CPUæ—¶é—´ç”¨æˆ·æ¨¡å¼+30%CPUæ—¶é—´å†…æ ¸æ¨¡å¼.</p></li><li><p>è¿›ç¨‹éœ€è¦å†…å­˜æ¥å­˜æ”¾è‡ªå·±çš„æŒ‡ä»¤å’Œä»£ç ï¼Œéœ€è¦cpuæ¥è¿è¡ŒæŒ‡ä»¤å¹¶å®Œæˆå¯¹æ•°æ®çš„åŠ å·¥ï¼Œæ­¤ç„¶ä¹Ÿéœ€è¦å†…å­˜æŠŠè‡ªå·±æ‰€è¾“å‡ºçš„æ•°æ®åŠå¤„ç†çš„ç»“æœç»™ä¿å­˜ä¸‹æ¥ç­‰ç­‰ã€‚äº‹å®ä¸Šæˆ‘ä»¬è¿è¡Œä¸­çš„è¿›ç¨‹æ•°é‡æ˜¯è¿œè¿œå¤šä½™cpuæ ¸å¿ƒæ•°é‡çš„</p></li><li><p>å‡å¦‚åªæœ‰1ä¸ªcpu,ä»–è¦ä¹ˆåœ¨æ‰§è¡Œç”¨æˆ·ä»£ç ,è¦ä¹ˆæ‰§è¡Œå†…æ ¸ä»£ç ,ä¸èƒ½åŒæ—¶æ‰§è¡Œ2ä¸ª</p></li><li><p>å†…æ ¸ä¸ºäº†è¿½è¸ªæ¯ä¸ªè¿›ç¨‹,å¿…é¡»å®ç°æ¯ä¸€ä¸ªè¿›ç¨‹å¯éšæ—¶è°ƒå…¥å’Œè°ƒå‡º,å‡†å¤‡å¾ˆå¤šæ•°æ®ç»“æ„æ¥ä¿å­˜è¿™äº›æ•°æ®,è¿™ä¸ªè¿‡ç¨‹å³ä¸º<code>ä»»åŠ¡åˆ—è¡¨</code>,æ¯ä¸ªè¿›ç¨‹éƒ½æœ‰ä¸€ä¸ªtask,æ¯ä¸€ä¸ªtaskåœ¨å†…æ ¸ä¸­éƒ½æœ‰ä¸€ä¸ªä¸“é—¨çš„æ•°æ®æ ¼å¼æ¥å­˜æ”¾ç›¸å…³ä¿¡æ¯,åŒ…æ‹¬è¿›ç¨‹id,è¿›ç¨‹çš„çº¿ç¨‹,åœ¨è°ƒåº¦ä¸Šè¿›ç¨‹å’Œçº¿ç¨‹æ²¡æœ‰åŒºåˆ«</p></li><li><p>ioè¿‡ç¨‹,è¿›ç¨‹è¿è¡Œçš„è¿‡ç¨‹ä¸­,éœ€è¦è¯·æ±‚çš„æ•°æ®å¦‚æœä¸åœ¨å†…å­˜é‡Œé¢,å°±ä¼šè¯·æ±‚å†…æ ¸å§æ•°æ®ä»ç£ç›˜è½½å…¥å†…å­˜,ä»è€Œä¾›ç¨‹åºè®¿é—®,ioå°±è¢«åˆ†æˆäº†2æ®µ,ç¬¬ä¸€æ®µæ˜¯å†…æ ¸å°†ç£ç›˜æ•°æ®åŠ è½½åˆ°å†…æ ¸å†…å­˜,ç„¶åå†ä»å†…æ ¸å†…å­˜å¤åˆ¶åˆ°è¿›ç¨‹å†…å­˜</p></li></ul><h2 id="å¸¸ç”¨å‘½ä»¤">å¸¸ç”¨å‘½ä»¤</h2><ul><li>å¤§è‡´çœ‹è¿›ç¨‹ä½¿ç”¨å…¨éƒ¨å†…å­˜,åŒ…æ‹¬å…±äº«å†…å­˜</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -aux | awk &#x27;&#123;total +=$6&#125;END&#123;print total&#125;&#x27;</span><br></pre></td></tr></table></figure><ul><li>å¤§è‡´çœ‹è¿›ç¨‹æ˜“ç”¨å†…å­˜,æ¯”auxç²¾ç¡®</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep Pss /proc/[1-9]*/smaps | awk &#x27;&#123;total+=$2&#125;END&#123;print total&#125;&#x27;</span><br></pre></td></tr></table></figure><ul><li>cpuå ç”¨æœ€é«˜çš„10ä¸ªè¿›ç¨‹,ä»¥pidæ’åº</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -aux | sort -k3nr | head -n 10</span><br></pre></td></tr></table></figure><ul><li>å†…å­˜å ç”¨æœ€é«˜çš„10ä¸ªè¿›ç¨‹,ä»¥pidæ’åº</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -aux | sort -k4nr | head -n 10</span><br></pre></td></tr></table></figure><ul><li>æ ‘å½¢çœ‹è¿›ç¨‹,ä½†ä¸èƒ½çœ‹å†…æ ¸è¿›ç¨‹</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -axjf</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pstree</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹è¿›ç¨‹ä¸‹çš„æ‰€æœ‰çº¿ç¨‹</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -efL | grep &lt;pid&gt;</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹è¿›ç¨‹ä¸‹æœ‰å“ªäº›çº¿ç¨‹</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -T -p &lt;pid&gt;</span><br></pre></td></tr></table></figure><ul><li>top/htop<ul><li>top -Hp [pid]</li><li>top ç„¶åæŒ‰Pæˆ–M</li><li>top ç„¶åæŒ‰F</li></ul></li><li>vmstat n m</li><li>mpstat nm</li><li>sarå·¥å…·</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sar -u -h -f /var/log/saxxx</span><br></pre></td></tr></table></figure><ul><li>æŒ‡å®šå‘½ä»¤å›ºå®šåœ¨æŸä¸ªcpuä¸Š</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">taskset -c 3 top</span><br></pre></td></tr></table></figure><ul><li>æ˜¾ç¤ºè¿›ç¨‹æ˜¯å¦å›ºå®šåœ¨æŸä¸ªcpuä¸Š</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">taskset -c -p &lt;pid&gt;</span><br><span class="line">ps -o pid,psr,comm -p &lt;pid&gt;</span><br></pre></td></tr></table></figure><h1>javaè¿›ç¨‹å ç”¨é—®é¢˜æ€è·¯</h1><ul><li>æ‰¾å‡ºå ç”¨æœ€é«˜çš„è¿›ç¨‹</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top æŒ‰M</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -aux | sort -k3nr | awk &#x27;&#123;print $3 &quot;\t&quot; $11&#125;&#x27; | head -n 10</span><br></pre></td></tr></table></figure><ul><li>æ‰¾å‡ºè¿›ç¨‹å ç”¨æœ€é«˜çš„çº¿ç¨‹ID</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top  -Hp &lt;pid&gt;</span><br></pre></td></tr></table></figure><ul><li>æ‰¾å‡ºcpuå ç”¨æœ€é«˜çš„çº¿ç¨‹</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -mp 2688 -o &quot;THREAD,tid,time&quot;</span><br></pre></td></tr></table></figure><ul><li>åè¿›åˆ¶çº¿ç¨‹å·è½¬æ¢æˆåå…­è¿›åˆ¶çº¿ç¨‹å·</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">printf &quot;%x\n&quot; &lt;tid&gt;</span><br></pre></td></tr></table></figure><ul><li>jstackæ‰¾å‡ºé—®é¢˜ä»£ç </li></ul><p>tid(16è¿›åˆ¶è¥¿é‚£æ‰IDå°å†™è‹±æ–‡)</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">jstack -l &lt;pid&gt;</span><br><span class="line">jstack -f &lt;pid&gt;</span><br><span class="line">jstack -l &lt;pid&gt; | grep tid -A 30</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœæ˜¯javaä»£ç é—®é¢˜,åº”è¯¥æ‰¾ç ”å‘</p><p>å¦‚æœæ˜¯javaè™šæ‹Ÿæœºæˆ–è€…ç³»ç»Ÿé—®é¢˜,åº”è¯¥ç»§ç»­æŸ¥</p></blockquote><h1>å…¶ä»–è¿›ç¨‹å ç”¨cpué—®é¢˜æ€è·¯</h1><h2 id="topå¤§æ³•">topå¤§æ³•</h2><h3 id="ç”¨æˆ·æ€">ç”¨æˆ·æ€</h3><p>%us+%sy &gt; 70 ,ç”¨æˆ·æ€æ˜¯å¦æœ‰å¯ç–‘è¿›ç¨‹</p><h3 id="ä¸­æ–­">ä¸­æ–­</h3><ul><li>ç¡¬ä¸­æ–­ hi</li></ul><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">watch -d cat <span class="regexp">/proc/i</span>nterrupts</span><br></pre></td></tr></table></figure><ul><li>è½¯ä¸­æ–­ si</li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">watch</span> -n <span class="number">1</span> <span class="string">&quot;cat /proc/softirqs&quot;</span></span><br></pre></td></tr></table></figure><h3 id="çµå¼‚è¿›ç¨‹">çµå¼‚è¿›ç¨‹</h3><p>cpuå ç”¨å¾ˆé«˜ä½†æ‰¾ä¸åˆ°</p><ul><li>å…³æ³¨<code>running</code>è¿›ç¨‹,æ˜¯å¦æœ‰ä»€ä¹ˆåœ¨ä¸åœçš„é‡å¯</li><li>å…³æ³¨<code>D</code>çŠ¶æ€è¿›ç¨‹,ä¸å¯ä¸­æ–­çš„ç¡çœ çŠ¶æ€,è¯¥çŠ¶æ€çš„è¿›ç¨‹æ— æ³•kill,æ›´ä¸èƒ½è‡ªè¡Œé€€å‡º,åªèƒ½é‡å¯æˆ–æ¢å¤ä»–ä¾èµ–çš„èµ„æºæ¥è§£å†³</li></ul><h2 id="uptimeæˆ–w">uptimeæˆ–w</h2><p>load average è¶Šé«˜,è¯´æ˜ä»»åŠ¡é˜Ÿåˆ—è¶Šé•¿,å¤„äºç­‰å¾…çš„ä»»åŠ¡è¶Šå¤š</p><h2 id="vmstat">vmstat</h2><ul><li>cs  ä¸Šä¸‹æ–‡åˆ‡æ¢æ¬¡æ•°é™¡å¢æˆ–è€…å’Œæ­£å¸¸å·®åˆ«å¾ˆå¤§</li><li>in  ä¸­æ–­æ¬¡æ•°è¾ƒå¤š</li><li>r  å°±ç»ªé˜Ÿåˆ—é•¿åº¦ä¸€ç›´é«˜äºæœ€å¤§cpuä¸ªæ•°,è€ƒè™‘cpuç«äº‰</li><li>wa  opç­‰å¾…cpuæ—¶é—´,å€¼è¶Šå¤§,ç£ç›˜å¤§é‡åšéšæœºè®¿é—®é€ æˆçš„,ç£ç›˜æ€§èƒ½æœ‰ç“¶é¢ˆ</li></ul><h2 id="pidstat">pidstat</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pidstat -p &lt;pid&gt; -wt 1 10</span><br></pre></td></tr></table></figure><ul><li>Cswch/s æ¯ç§’ä¸»åŠ¨ä»»åŠ¡ä¸Šä¸‹æ–‡åˆ‡æ¢æ•°é‡</li><li>Nvcswch/s æ¯ç§’è¢«åŠ¨ä»»åŠ¡ä¸Šä¸‹æ–‡åˆ‡æ¢æ•°é‡,å€¼è¶Šå¤§æ´»å—è¿›ç¨‹è¢«å¼ºåˆ¶è°ƒåº¦,å°±æ˜¯äº‰æŠ¢cpu,cpuæ—¶é—´ç‰‡ä¸è¶³</li></ul><h2 id="sar">sar</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sar -q #æŸ¥çœ‹è¿‘æ®µæ—¶é—´cpuè´Ÿè½½</span><br></pre></td></tr></table></figure><h2 id="åˆ¤æ–­æ˜¯å¦æ˜¯ç³»ç»Ÿè¿›ç¨‹">åˆ¤æ–­æ˜¯å¦æ˜¯ç³»ç»Ÿè¿›ç¨‹</h2><ul><li>Uç³»</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dpkg -S</span><br></pre></td></tr></table></figure><ul><li>Rç³»</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -qf</span><br></pre></td></tr></table></figure><h2 id="æ˜¾å¡ç›¸å…³">æ˜¾å¡ç›¸å…³</h2><p>æ¶‰åŠåˆ°æ˜¾å¡ç¡¬ä»¶åŠ é€Ÿç›¸å…³,æœ‰äº›åº”ç”¨å¯èƒ½éœ€è¦ç”¨åˆ°,ä½†å¯èƒ½èµ°çš„æ˜¯cpuè½¯å®ç°,å¹¶æ²¡æœ‰ç”¨åˆ°ç¡¬ä»¶</p><h2 id="æ˜¯å¦ç¨‹åºä¸æ–­è‡ªå¯åŠ¨">æ˜¯å¦ç¨‹åºä¸æ–­è‡ªå¯åŠ¨</h2><p>æœ‰äº›ç¨‹åºåˆ©ç”¨å®šæ—¶ä»»åŠ¡ä¸æ–­æ‹‰èµ·æœåŠ¡</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -rni &quot;è¿›ç¨‹&quot; /etc</span><br></pre></td></tr></table></figure><h2 id="å¯¹æ¯”å…¶ä»–æœºå™¨">å¯¹æ¯”å…¶ä»–æœºå™¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strace -c top -d 1 -n 5</span><br></pre></td></tr></table></figure><h1>å†…å­˜åˆ†æ</h1><p>linuxå†…å­˜ç®¡ç†å­ç³»ç»Ÿæ¶æ„<code>ç”¨æˆ·ç©ºé—´</code>,<code>å†…æ ¸ç©ºé—´</code>,<code>æœºå™¨ç¡¬ä»¶</code></p><h2 id="æŸ¥çœ‹é…ç½®">æŸ¥çœ‹é…ç½®</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/meminfo</span><br></pre></td></tr></table></figure><p>å…³æ³¨å¦‚ä¸‹</p><ol><li>MemTotal ç‰©ç†å¤§å°</li><li>MemFree ç©ºé—²</li><li>MemAvailabe å¯ç”¨</li><li>Buffers ç»™æ–‡ä»¶åšç¼“å†²çš„</li><li>Cached é«˜é€Ÿç¼“å†²æ§åˆ¶å™¨</li><li>SwapCacaed</li><li>Active æ´»è·ƒä½¿ç”¨çš„bufferfæˆ–cache</li><li>Inactive ä¸ç»å¸¸ç”¨çš„å¤§å°</li><li>Slab</li><li>Sreclaimable  å¯å›æ”¶slab</li><li>Sunreclaim ä¸å¯å›æ”¶slab</li></ol><h2 id="æ£€æŸ¥ç°æœ‰çš„">æ£€æŸ¥ç°æœ‰çš„</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">free -m</span><br></pre></td></tr></table></figure><p>åº”ç”¨å¯ç”¨å†…å­˜~free+buffers+cached</p><p>Mem:avaiable~/proc/meminfoçš„MenAvailable</p><h1>smem</h1><ul><li>VSS</li></ul><p>è™šæ‹Ÿè€—ç”¨å†…å­˜,åŒ…å«å…±äº«åº“ä½¿ç”¨çš„å†…å­˜</p><ul><li>RSS</li></ul><p>å®é™…ä½¿ç”¨å†…å­˜,åŒ…å«å…±äº«åº“å ç”¨çš„,ç”¨topå¯ä»¥æŸ¥åˆ°,æœ€å¸¸ç”¨çš„å†…å­˜æŒ‡æ ‡,æ˜¯è¿›ç¨‹å ç”¨çš„ç‰©ç†å†…å­˜å¤§å°,RssåŒ…å«è¿›ç¨‹é—´å…±äº«çš„å†…å­˜,æ‰€ä»¥ç´¯åŠ èµ·æ¥ä¼šè¶…å‡ºç³»ç»Ÿçš„å†…å­˜æ¶ˆè€—</p><ul><li>PSS</li></ul><p>æ‰€æœ‰ä½¿ç”¨æŸå…±äº«åº“çš„ç¨‹åºå‡åˆ†è¯¥å…±äº«åº“å ç”¨çš„å†…å­˜æ—¶,æ¯ä¸ªè¿›ç¨‹å ç”¨çš„å†…å­˜,æ‰€æœ‰è¿›ç¨‹çš„PSSä¹‹å’Œå°±æ˜¯ç³»ç»Ÿçš„å†…å­˜ä½¿ç”¨é‡,æ›´ç²¾ç¡®,æ˜¯å°†å…±äº«å†…å­˜å¹³å‡åˆ†æ‘Šåˆ°å„ä¸ªè¿›ç¨‹ä¸­çš„</p><ul><li>USS</li></ul><p>è¿›ç¨‹ç‹¬è‡ªå ç”¨çš„ç‰©ç†å†…å­˜,æ˜¯PSSä¸­è‡ªå·±çš„éƒ¨åˆ†,åªè®¡ç®—è¿›ç¨‹ç‹¬è‡ªå ç”¨çš„</p><h2 id="å¸¸ç”¨å‘½ä»¤-2">å¸¸ç”¨å‘½ä»¤</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">free -m</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/meminfo</span><br></pre></td></tr></table></figure><ul><li>å®æ—¶æ˜¾ç¤ºå†…æ ¸slabç¼“å†²åŒºä¿¡æ¯</li></ul><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">slabtop</span></span><br></pre></td></tr></table></figure><ul><li>æ˜¯å¦æœ‰å†…å­˜é™åˆ¶æˆ–é¢„ç•™å†…å­˜</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/cmdline</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹è¿›ç¨‹æ€»å†…å­˜æ˜¯å¦æ­£å¸¸</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -aux | awk &#x27;&#123;total+=$6&#125;END&#123;print total/1024&#125;&#x27;</span><br></pre></td></tr></table></figure><ul><li>æ—¥å¿—åˆ†æè¶…å‡ºå†…å­˜æˆ–allocçš„é—®é¢˜</li></ul><ol><li>dmesg</li><li>kernel.log</li><li>syslog</li></ol><ul><li>è¿‘æ®µæ—¶é—´å†…å­˜åˆ†æ</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sar -r -h -f /var/log/sa/saxx</span><br></pre></td></tr></table></figure><ul><li>ä¸²å£è°ƒè¯•</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">é‡å¯,å¼•å¯¼åŠ å…¥console=ttyS0,115200n8</span></span><br></pre></td></tr></table></figure><h2 id="å¯¹æ¯”æµ‹è¯•">å¯¹æ¯”æµ‹è¯•</h2><ol><li>å’Œcentoså¯¹æ¯”</li><li>é‡æ–°éƒ¨ç½²ç¨‹åºæˆ–å’Œæ­£å¸¸æœºå™¨å¯¹æ¯”</li><li>æ¢ä¸ªç”¨æˆ·æ’é™¤ç¯å¢ƒå˜é‡é—®é¢˜</li><li>å¼‚å¸¸å’Œæ­£å¸¸çš„æœºå™¨ç¡¬ä»¶,ç³»ç»Ÿ,bios,ä¸»æ¿,ç¡¬ç›˜,cpu,å†…å­˜,åŒ…,æ˜¯å¦ä¸€è‡´</li><li>å†…å­˜æ³„éœ²é—®é¢˜,meminfoå–å¤šä»½å¯¹æ¯”,çœ‹çœ‹æ˜¯åœ¨å†…æ ¸è¿˜æ˜¯ç”¨æˆ·è¿›ç¨‹</li></ol><h2 id="æ ¸å†…å†…å­˜é—®é¢˜">æ ¸å†…å†…å­˜é—®é¢˜</h2><ol><li>MemFreeå’ŒMemAvailable,å®šä½å†…å­˜æ¶ˆè€—çš„æ–¹å‘æ˜¯å†…æ ¸è¿˜æ˜¯ç”¨æˆ·</li><li>slabtopå®æ—¶è§‚å¯Ÿå“ªä¸ªslabä¸€ç›´å¢é«˜</li><li>å¯¹æ¯”çœ‹slabå¢é•¿æƒ…å†µ</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/meminfo  | grep -Ei &quot;slab|reclaim&quot;</span><br></pre></td></tr></table></figure><ol start="4"><li>å®šä½å…·ä½“çš„slabé—®é¢˜</li></ol><p>å–å¤šä»½slabinfoå¯¹æ¯”,å¸¦ç€/sys/kernel/slabåˆ†æ</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat <span class="regexp">/proc/</span>slabinfo</span><br></pre></td></tr></table></figure><p>å¦‚æœdentryé«˜,åˆ¤æ–­ä¸‹æ˜¯å¦è¿›ç¨‹å¯¹æ–‡ä»¶é¢‘ç¹è¯»å†™,å¯ä»¥ç”¨straceåˆ†æ</p><figure class="highlight perl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strace -fp &lt;pid&gt; -e trace=<span class="keyword">open</span>,<span class="keyword">stat</span>,<span class="keyword">close</span>,<span class="keyword">unlink</span></span><br></pre></td></tr></table></figure><ol start="5"><li>å†…æ ¸é—®é¢˜ä¸€èˆ¬æ˜¯é©±åŠ¨é—®é¢˜<ol><li>lsmodå¯¹æ¯”</li><li>å¸è½½é©±åŠ¨</li><li>é©±åŠ¨åˆ†æ</li></ol></li><li>æ‰¾åˆ°é©±åŠ¨åœ°å€</li></ol><p>å¯ä»¥çœ‹åˆ°å‡½æ•°å¯¹åº”çš„åœ°å€,é€šè¿‡åœ°å€æ‰¾åˆ°é©±åŠ¨,ä¹Ÿå¯ä»¥é€šè¿‡é©±åŠ¨æ‰¾åˆ°åœ°å€</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat <span class="regexp">/proc/i</span>omem</span><br></pre></td></tr></table></figure><h2 id="æ ¸å¤–å†…å­˜é—®é¢˜">æ ¸å¤–å†…å­˜é—®é¢˜</h2><ol><li><p>topæŒ‰MæŸ¥çœ‹å ç”¨æœ€å¤§çš„</p></li><li><p>pså¤§æ³•</p></li></ol><figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ps</span> -aux | awk <span class="string">&#x27;&#123;total+=<span class="variable">$6</span>&#125;END&#123;print total/1024&#125;&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -aux --<span class="built_in">sort</span> -rss | <span class="built_in">head</span></span><br></pre></td></tr></table></figure><ol start="3"><li>ps_mem</li><li>dstat</li></ol><p>åŠ¨æ€å±•ç¤ºè¿›ç¨‹å†…å­˜å ç”¨</p><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dstat <span class="comment">--top-mem</span></span><br></pre></td></tr></table></figure><ol start="5"><li>è¿›ç¨‹å†…å­˜åˆ†æ</li></ol><ul><li>æŸ¥çœ‹smaps</li></ul><p>smapså±•ç¤ºäº†ä¸€ä¸ªè¿›ç¨‹çš„å†…å­˜æ¶ˆè€—</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/&lt;pid&gt;/smaps</span><br></pre></td></tr></table></figure><ul><li>å†…å­˜æ³„éœ²</li></ul><p>VIRT/VSZæˆ–è€…writeable/private,å¦‚æœåœ¨é‡å¤æ“ä½œä¸­ä¸€ç›´é—®é¢˜,é‚£ä¹ˆåº”è¯¥æ˜¯å†…å­˜æ³„éœ²</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pmap -d &lt;pid&gt;</span><br></pre></td></tr></table></figure><ul><li>straceè°ƒè¯•</li></ul><h2 id="pidæ˜¯å¦è¶…è¿‡é™åº¦">pidæ˜¯å¦è¶…è¿‡é™åº¦</h2><p><code>fork:cannot allocate memory</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -eLf | wc -l</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat  /proc/sys/kernel/pid_max</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysc &amp;&amp; echo3 &gt; /proc/sys/vm/drop_caches</span><br></pre></td></tr></table></figure><h2 id="å…¶ä»–">å…¶ä»–</h2><p>linuxä¸‹é¢‘ç¹å­˜å–æ–‡ä»¶ä¹‹å,ç‰©ç†å†…å­˜ä¼šè¢«æ¶ˆè€—å®Œ,ç¨‹åºç»“æŸä¹‹åä¸ä¼šç«‹å³è¢«æ­£å¸¸é‡Šæ”¾çš„</p><h1>ç£ç›˜é—®é¢˜</h1><ul><li>ç£ç›˜æ•´ä½“ä½¿ç”¨æƒ…å†µ</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df -h</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df -i</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fdisk -l</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsblk</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/fstab</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">blkid</span><br></pre></td></tr></table></figure><ul><li>æ˜¯å¦å¼€å¯è¯»å†™ç¼“å­˜</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dmesg | grep -i cache</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹é˜Ÿåˆ—æ¨¡å¼</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /sys/block/&lt;ç£ç›˜å&gt;/queue/scheduler </span><br></pre></td></tr></table></figure><ul><li>è®¾ç½®é˜Ÿåˆ—æ¨¡å¼</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo &lt;é˜Ÿåˆ—æ¨¡å¼&gt; &gt;&gt;  /sys/block/&lt;ç£ç›˜å&gt;/queue/scheduler </span><br><span class="line">echo  mq-deadline &gt;&gt;  /sys/block/&lt;ç£ç›˜å&gt;/queue/scheduler </span><br></pre></td></tr></table></figure><p>grubåŠ å…¥scsi_mod.use_blk_mq=0 elevator=deadline ä¿®æ”¹ç®—æ³•</p><ul><li>æŸ¥çœ‹ç£ç›˜è°ƒåº¦ç®—æ³•</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dmesg | grep -i scheduler</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹io</li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat -d -x -N -<span class="selector-tag">p</span></span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dstat -d</span><br></pre></td></tr></table></figure><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dstat -d <span class="comment">--top-io</span></span><br></pre></td></tr></table></figure><ul><li>ioæ€§èƒ½æµ‹è¯•</li></ul><ol><li>blktrace</li><li>fio</li><li>dd</li></ol><ul><li>æ£€æµ‹ç£ç›˜å¥åº·</li></ul><ol><li>badblocks</li><li>e2fsck</li><li>fsck</li><li>xfs_repair</li></ol><ul><li>åˆ¤æ–­ç£ç›˜ç±»å‹</li></ul><p>1=HDD</p><p>0=SSD</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat <span class="regexp">/sys/</span>block<span class="regexp">/&lt;ç£ç›˜å&gt;/</span>queue/rotational  </span><br></pre></td></tr></table></figure><ul><li>æ˜¯å¦å¼€å¯ç¼“å­˜</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dmesg | grep -i cache | grep -i read #è¯»ç¼“å­˜</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dmesg | grep -i cache | grep -i write #è¯»ç¼“å­˜</span><br></pre></td></tr></table></figure><h2 id="ç£ç›˜åˆ†æå·¥å…·">ç£ç›˜åˆ†æå·¥å…·</h2><h3 id="dd">dd</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æµ‹è¯•å†™é€Ÿç‡,è¯·æ±‚ç›´æ¥å˜æˆioæŒ‡ä»¤å‘åˆ°ç£ç›˜</span></span><br><span class="line">time dd if=/dev/zero of=test bs=4k count=100000 oflag=direct status=progress</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æµ‹è¯•å†™é€Ÿç‡,è§„é¿cache</span></span><br><span class="line">time dd if=test  of=/dev/null bs=4k count=100000 oflag=direct status=progress</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">æµ‹è¯•è¯»é€Ÿç‡,è§„é¿cache</span></span><br><span class="line">time dd if=/dev/xxx  of=/dev/null bs=4k count=100000 oflag=direct status=progress</span><br></pre></td></tr></table></figure><h3 id="blktrace">blktrace</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">1.é‡‡é›†ä¿¡æ¯,æ ¹æ®cpuä¸ªæ•°ç”Ÿæˆæ–‡ä»¶ä¸ªæ•°,åå­—æ˜¯&#123;device&#125;.blktrace.&#123;cpu&#125;</span></span><br><span class="line">blktrace -d /dev/sdX  [-o /tmp/sda ]</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">2.åˆå¹¶ä¿¡æ¯,æ‰§è¡Œbttå°±è¦å…ˆæŠŠblktraceç”Ÿæˆçš„æ–‡ä»¶åˆå¹¶</span></span><br><span class="line">blkparse -i sda -d sda.blkparse.bin</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">3.ç»Ÿè®¡ä¿¡æ¯,å°†åˆå¹¶çš„ä¿¡æ¯åˆ†è§£ç¨‹å¾ˆå¤šæ­Œåå­—ç›¸å…³çš„æ–‡ä»¶ä¿¡æ¯</span></span><br><span class="line">btt -i sda.blkparse.bin -o sda.btt</span><br></pre></td></tr></table></figure><h2 id="ç£ç›˜æ£€æŸ¥ä¿®å¤å·¥å…·">ç£ç›˜æ£€æŸ¥ä¿®å¤å·¥å…·</h2><h3 id="badblocks">badblocks</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">1.æ‰«æ</span></span><br><span class="line">badblocks -s -v /dev/xxx</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">2.å¦‚æœæ‰¾åˆ°äº†åé“,å¯ä»¥è¿›è¡Œå†™å…¥æ‰«æè¿›è¡Œä¿®å¤,å†™å…¥æ‰«æé‡åˆ°åé“çš„æ—¶å€™è‡ªåŠ¨é‡æ˜ å°„,æ‰«æä¼šè¦†ç›–åŸæœ‰æ•°æ®,è¦å¤‡ä»½çš„,å†™å…¥æ‰«æé€Ÿåº¦å¾ˆä½,æ‰€ä»¥åº”è¯¥æ‰«æåªè¯»æ‰«ææ—¶å€™å‘ç°é”™è¯¯çš„åœ°æ–¹</span></span><br><span class="line">badblocks -w -s -v /dev/xxx [END] [START]</span><br></pre></td></tr></table></figure><h3 id="fstrim">fstrim</h3><p>å›æ”¶å·²ç»æŒ‚è½½çš„æ–‡ä»¶ç³»ç»Ÿæœªä½¿ç”¨çš„å—</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">fstrim -av</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">é€æ­¥å­¦ä¹ ç³»ç»Ÿå¼‚å¸¸çš„æ’æŸ¥æ–¹æ³•</summary>
    
    
    
    <category term="æ•…éšœå¤„ç†" scheme="https://www.dddachui.top/categories/%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86/"/>
    
    
    <category term="æ•…éšœå¤„ç†" scheme="https://www.dddachui.top/tags/%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>Linuxå¥½ç”¨å‘½ä»¤ä¹‹pidstat</title>
    <link href="https://www.dddachui.top/posts/33b1a077.html"/>
    <id>https://www.dddachui.top/posts/33b1a077.html</id>
    <published>2022-09-21T05:51:57.000Z</published>
    <updated>2023-03-13T12:49:55.054Z</updated>
    
    <content type="html"><![CDATA[<h1>å‘½ä»¤ç®€ä»‹</h1>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;å‘½ä»¤ç®€ä»‹&lt;/h1&gt;
</summary>
      
    
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/categories/linux%E5%91%BD%E4%BB%A4/"/>
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/tags/linux%E5%91%BD%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title>Linuxå¥½ç”¨å‘½ä»¤ä¹‹iostat</title>
    <link href="https://www.dddachui.top/posts/84a73f90.html"/>
    <id>https://www.dddachui.top/posts/84a73f90.html</id>
    <published>2022-09-21T05:48:17.000Z</published>
    <updated>2023-03-13T12:49:25.047Z</updated>
    
    <content type="html"><![CDATA[<h1>å‘½ä»¤ç®€ä»‹</h1><p>åˆ†æioæ€§èƒ½</p><h1>æ¦‚è¿°</h1><p>åœ¨è¡¡é‡ç£ç›˜æ€§èƒ½æ—¶çš„åŸºæœ¬æŒ‡æ ‡ï¼š<code>åˆ©ç”¨ç‡</code>ã€<code>é¥±å’Œåº¦</code>ã€<code>IOPS</code>ã€<code>ååé‡</code>å’Œ<code>å“åº”æ—¶é—´</code></p><ol><li>åˆ©ç”¨ç‡(Utilization):ç£ç›˜å¤„ç†I/Oçš„æ—¶é—´ç™¾åˆ†æ¯”,è¿‡åº¦ä½¿ç”¨<code>(å¦‚è¶…è¿‡ 80%)</code>é€šå¸¸æ„å‘³ç€ç£ç›˜I/Oå­˜åœ¨æ€§èƒ½ç“¶é¢ˆ</li><li>é¥±å’Œåº¦(Saturation):æŒ‡ç£ç›˜å¤„ç†I/Oçš„ç¹å¿™ç¨‹åº¦,è¿‡åº¦é¥±å’Œæ„å‘³ç€ç£ç›˜å­˜åœ¨ä¸¥é‡çš„æ€§èƒ½ç“¶é¢ˆ,å½“é¥±å’Œåº¦ä¸º100%æ—¶,ç£ç›˜æ— æ³•æ¥å—æ–°çš„I/Oè¯·æ±‚</li><li>IOPS(Input/Output Per Second):æŒ‡æ¯ç§’I/Oè¯·æ±‚çš„æ•°é‡</li><li>ååé‡(Throughput):æ¯ç§’I/Oè¯·æ±‚çš„å¤§å°</li><li>å“åº”æ—¶é—´(Response time):æŒ‡å‘é€I/Oè¯·æ±‚å’Œæ¥æ”¶å“åº”ä¹‹é—´çš„é—´éš”æ—¶é—´</li></ol><blockquote><p>ä¸€èˆ¬é¢å¯¹IOé—®é¢˜,æˆ‘ä»¬å…ˆè€ƒè™‘<code>æ˜¯å¦äº§ç”Ÿäº†IOé—®é¢˜</code>,åœ¨å®‰è£…ç³»ç»Ÿä¹‹åä¸€èˆ¬éƒ½æ˜¯è¦å¯¹ç£ç›˜è¿›è¡Œä¸€ä¸ªæµ‹è¯•çš„,å¸¸ç”¨çš„å·¥å…·æœ‰<code>dd</code>,<code>fio</code>ç­‰,ç›®çš„æ˜¯è¦æ£€éªŒå‡ºç£ç›˜çš„<code>éšæœºè¯»</code>ã€<code>é¡ºåºè¯»</code>ã€<code>éšæœºå†™</code>ã€<code>é¡ºåºå†™</code><br>ç­‰æ€§èƒ½(é€šå¸¸æ˜¯ 512B ~ 1MB ä¹‹é—´),ä»¥åˆ¤æ–­æ˜¯å¦èƒ½å¤Ÿæ»¡è¶³åº”ç”¨çš„éœ€æ±‚</p></blockquote><h1>å‘½ä»¤å‚æ•°</h1><p><strong>-cï¼š</strong> æ˜¾ç¤ºCPUä½¿ç”¨æƒ…å†µ<br><strong>-dï¼š</strong> æ˜¾ç¤ºç£ç›˜ä½¿ç”¨æƒ…å†µ<br><strong>-Nï¼š</strong> æ˜¾ç¤ºç£ç›˜é˜µåˆ—(LVM) ä¿¡æ¯<br><strong>-nï¼š</strong> æ˜¾ç¤ºNFS ä½¿ç”¨æƒ…å†µ<br><strong>-kï¼š</strong> ä»¥ KB ä¸ºå•ä½æ˜¾ç¤º<br><strong>-mï¼š</strong> ä»¥ M ä¸ºå•ä½æ˜¾ç¤º<br><strong>-tï¼š</strong> æŠ¥å‘Šæ¯ç§’å‘ç»ˆç«¯è¯»å–å’Œå†™å…¥çš„å­—ç¬¦æ•°å’ŒCPUçš„ä¿¡æ¯<br><strong>-Vï¼š</strong> æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯<br><strong>-xï¼š</strong> æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯<br><strong>-pï¼š</strong>[ç£ç›˜] æ˜¾ç¤ºç£ç›˜å’Œåˆ†åŒºçš„æƒ…å†µ</p><h1>å¤šç§ç”¨æ³•ç®€ä»‹</h1><ul><li>é—´éš”1ç§’ï¼Œæ€»å…±æ˜¾ç¤º5æ¬¡</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat 1 5</span><br></pre></td></tr></table></figure><ul><li>æ¯éš”2ç§’,æ˜¾ç¤ºä¸€æ¬¡è®¾å¤‡ç»Ÿè®¡ä¿¡æ¯</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat -d 2</span><br></pre></td></tr></table></figure><ul><li>æ¯éš”2ç§’,æ˜¾ç¤ºä¸€æ¬¡è®¾å¤‡ç»Ÿè®¡ä¿¡æ¯.æ€»å…±è¾“å‡º3æ¬¡</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat -d 2 3</span><br></pre></td></tr></table></figure><ul><li>æ¯éš”2ç§’æ˜¾ç¤ºä¸€æ¬¡sda, sdbä¸¤ä¸ªè®¾å¤‡çš„æ‰©å±•ç»Ÿè®¡ä¿¡æ¯,å…±è¾“å‡º3æ¬¡</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat -x sda sdb 2 3</span><br></pre></td></tr></table></figure><ul><li>æ¯éš”2ç§’æ˜¾ç¤ºä¸€æ¬¡sdaåŠä¸Šé¢æ‰€æœ‰åˆ†åŒºçš„ç»Ÿè®¡ä¿¡æ¯,å…±è¾“å‡º3æ¬¡</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat -p sda 2 3</span><br></pre></td></tr></table></figure><ul><li>ä»¥Mä¸ºå•ä½æ˜¾ç¤ºæ‰€æœ‰ä¿¡æ¯</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat -m</span><br></pre></td></tr></table></figure><ul><li>æŠ¥å‘Šæ¯ç§’å‘ç»ˆç«¯è¯»å–å’Œå†™å…¥çš„å­—ç¬¦æ•°</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat -t</span><br></pre></td></tr></table></figure><ul><li>æ˜¾ç¤ºæŒ‡å®šç¡¬ç›˜ä¿¡æ¯</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat -d sda</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹TPSå’Œååé‡ä¿¡æ¯</li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">iostat</span> -d -k <span class="number">1</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹è®¾å¤‡ä½¿ç”¨ç‡å’Œå“åº”æ—¶é—´</li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">iostat</span> -d -k <span class="number">1</span> <span class="number">1</span></span><br></pre></td></tr></table></figure><h1>ç®€å•ä½¿ç”¨æ–¹æ³•</h1><p>ç›´æ¥ä½¿ç”¨,æ˜¾ç¤ºæ‰€æœ‰è®¾å¤‡è´Ÿè½½æƒ…å†µ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯è¾“å‡ºç»“æœ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">avg-cpu:  %user   %nice %system %iowait  %steal   %idle</span><br><span class="line">           0.30    0.00    0.07    0.01    0.00   99.62</span><br><span class="line"></span><br><span class="line">Device             tps    kB_read/s    kB_wrtn/s    kB_dscd/s    kB_read    kB_wrtn    kB_dscd</span><br><span class="line">dm-0              3.40        67.65         6.81         0.00     492797      49628          0</span><br><span class="line">dm-1              0.01         0.30         0.00         0.00       2216          0          0</span><br><span class="line">sda               1.89        84.39         6.52         0.00     614737      47473          0</span><br><span class="line">sdb               0.02         0.35         0.00         0.00       2569          4          0</span><br></pre></td></tr></table></figure><ul><li>å«ä¹‰è§£é‡Š</li></ul><ol><li>%userï¼šCPUåœ¨<code>ç”¨æˆ·æ¨¡å¼</code>ä¸‹çš„æ—¶é—´ç™¾åˆ†æ¯”</li><li>%niceï¼šCPUåœ¨å¸¦NICEå€¼çš„ç”¨æˆ·æ¨¡å¼ä¸‹çš„æ—¶é—´ç™¾åˆ†æ¯”</li><li>%systemï¼šCPUåœ¨ç³»ç»Ÿæ¨¡å¼ä¸‹çš„æ—¶é—´ç™¾åˆ†æ¯”</li><li>%iowaitï¼šCPUç­‰å¾…è¾“å…¥è¾“å‡ºå®Œæˆæ—¶é—´çš„ç™¾åˆ†æ¯”</li><li>%stealï¼šç®¡ç†ç¨‹åºç»´æŠ¤å¦ä¸€ä¸ªè™šæ‹Ÿå¤„ç†å™¨æ—¶ï¼Œè™šæ‹ŸCPUçš„æ— æ„è¯†ç­‰å¾…æ—¶é—´ç™¾åˆ†æ¯”</li><li>%idleï¼šCPU<code>ç©ºé—²æ—¶é—´</code>ç™¾åˆ†æ¯”</li><li>device:ç£ç›˜åç§°</li><li>tpsï¼šæ¯ç§’é’Ÿå‘é€åˆ°çš„I/Oè¯·æ±‚æ•°</li><li>Blk_read/sï¼šæ¯ç§’è¯»å–çš„blockæ•°</li><li>Blk_wrtn/sï¼šæ¯ç§’å†™å…¥çš„blockæ•°</li><li>Blk_readï¼šè¯»å…¥çš„blockæ€»æ•°</li><li>Blk_wrtnï¼šå†™å…¥çš„blockæ€»æ•°</li></ol><blockquote><p>%iowaitçš„å€¼è¿‡é«˜ï¼Œè¡¨ç¤ºç¡¬ç›˜å­˜åœ¨I/Oç“¶é¢ˆ<br>%idleå€¼é«˜ï¼Œè¡¨ç¤ºCPUè¾ƒç©ºé—²<br>%idleå€¼é«˜ä½†ç³»ç»Ÿå“åº”æ…¢æ—¶ï¼Œæœ‰å¯èƒ½æ˜¯CPUç­‰å¾…åˆ†é…å†…å­˜ï¼Œæ­¤æ—¶åº”åŠ å¤§å†…å­˜å®¹é‡<br>%idleå€¼å¦‚æœæŒç»­ä½äº10ï¼Œé‚£ä¹ˆç³»ç»Ÿçš„CPUå¤„ç†èƒ½åŠ›ç›¸å¯¹è¾ƒä½ï¼Œè¡¨æ˜ç³»ç»Ÿä¸­æœ€éœ€è¦è§£å†³çš„èµ„æºæ˜¯CPUã€‚</p></blockquote><h1>æ•´ä½“ç£ç›˜I/Oè§‚å¯Ÿ(é‡ç‚¹)</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat -d -x -N -p</span><br></pre></td></tr></table></figure><p>iostat æ˜¯æœ€å¸¸ç”¨çš„ç£ç›˜ I/O æ€§èƒ½è§‚å¯Ÿå·¥å…·ã€‚å®ƒæä¾›äº†å„ç§å¸¸ç”¨æ€§èƒ½æŒ‡æ ‡ï¼Œä¾‹å¦‚æ¯ä¸ªç£ç›˜çš„åˆ©ç”¨ç‡ã€IOPS å’Œååé‡<br>ä¸‹é¢æ˜¯<code>iostat</code>çš„è¾“å‡ºç»“æœ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Device:         rrqm/s   wrqm/s     r/s     w/s    rkB/s    wkB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util</span><br><span class="line">sda               0.00     0.00    0.00    0.00     0.00     0.00     0.00     0.00    0.00    0.00    0.00   0.00   0.00</span><br><span class="line">scd0              0.00     0.00    0.00    0.00     0.00     0.00     0.00     0.00    0.00    0.00    0.00   0.00   0.00</span><br><span class="line">dm-0              0.00     0.00    0.00    0.00     0.00     0.00     0.00     0.00    0.00    0.00    0.00   0.00   0.00</span><br><span class="line">dm-1              0.00     0.00    0.00    0.00     0.00     0.00     0.00     0.00    0.00    0.00    0.00   0.00   0.00</span><br></pre></td></tr></table></figure><p>æ¯ä¸€åˆ—éƒ½å¯¹åº”äº†ä¹‹å‰è¯´çš„<code>åŸºæœ¬æŒ‡æ ‡</code></p><ul><li><code>%util</code> æ˜¯æˆ‘ä»¬å‰é¢æåˆ°çš„ç£ç›˜I/Oä½¿ç”¨æƒ…å†µ,</li><li><code>r/s</code> å’Œ <code>w/s</code> æ˜¯ IOPS</li><li><code>rkB/s</code> å’Œ <code>wkB/s</code> æ˜¯ååé‡</li><li><code>r_await</code> å’Œ <code>w_await</code> æ˜¯å“åº”æ—¶é—´</li></ul><blockquote><p>å…³äºç£ç›˜é¥±å’Œåº¦,å¯ä»¥åˆ©ç”¨<code>å¹³å‡è¯·æ±‚é˜Ÿåˆ—é•¿åº¦</code>æˆ–<code>å®Œæˆè¯»å†™è¯·æ±‚çš„ç­‰å¾…æ—¶é—´</code>ä¸<code>åŸºå‡†æµ‹è¯•ï¼ˆä¾‹å¦‚é€šè¿‡ fioï¼‰çš„ç»“æœ</code>è¿›è¡Œæ¯”è¾ƒ</p><p>ä»iostatæ— æ³•å¾—å‡ºç£ç›˜çš„é¥±å’Œåº¦,é¥±å’Œåº¦ååº”çš„æ˜¯ç£ç›˜å¤„ç†ioçš„ç¹å¿™ç¨‹åº¦,è¿‡é«˜çš„é¥±æ„å‘³ç€ç£ç›˜æœ‰ä¸¥é‡çš„ioé—®é¢˜,é¥±å’Œåº¦100%æ—¶å€™æ— æ³•æ¥å—æ–°çš„ioè¯·æ±‚</p></blockquote><h1>æŸ¥çœ‹è®¾å¤‡ä½¿ç”¨ç‡,å“åº”æ—¶é—´</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iostat -d -x 1 1</span><br></pre></td></tr></table></figure><p>ä»¥ä¸‹æ˜¯è¾“å‡ºç»“æœ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Device</span>            r/s     rkB/s   rrqm/s  %rrqm r_await rareq-sz     w/s     wkB/s   wrqm/s  %wrqm w_await wareq-sz     d/s     dkB/s   drqm/s  %drqm d_await dareq-sz     f/s f_await  aqu-sz  %util</span><br><span class="line"><span class="attribute">dm</span>-<span class="number">0</span>             <span class="number">1</span>.<span class="number">70</span>     <span class="number">67</span>.<span class="number">07</span>     <span class="number">0</span>.<span class="number">00</span>   <span class="number">0</span>.<span class="number">00</span>    <span class="number">2</span>.<span class="number">90</span>    <span class="number">39</span>.<span class="number">45</span>    <span class="number">1</span>.<span class="number">68</span>      <span class="number">6</span>.<span class="number">80</span>     <span class="number">0</span>.<span class="number">00</span>   <span class="number">0</span>.<span class="number">00</span>    <span class="number">0</span>.<span class="number">38</span>     <span class="number">4</span>.<span class="number">04</span>    <span class="number">0</span>.<span class="number">00</span>      <span class="number">0</span>.<span class="number">00</span>     <span class="number">0</span>.<span class="number">00</span>   <span class="number">0</span>.<span class="number">00</span>    <span class="number">0</span>.<span class="number">00</span>     <span class="number">0</span>.<span class="number">00</span>    <span class="number">0</span>.<span class="number">00</span>    <span class="number">0</span>.<span class="number">00</span>    <span class="number">0</span>.<span class="number">01</span>   <span class="number">0</span>.<span class="number">11</span></span><br><span class="line"><span class="attribute">dm</span>-<span class="number">1</span>             <span class="number">0</span>.<span class="number">01</span>      <span class="number">0</span>.<span class="number">30</span>     <span class="number">0</span>.<span class="number">00</span>   <span class="number">0</span>.<span class="number">00</span>    <span class="number">2</span>.<span class="number">32</span>    <span class="number">22</span>.<span class="number">85</span>    <span class="number">0</span>.<span class="number">00</span>      <span class="number">0</span>.<span class="number">00</span>     <span class="number">0</span>.<span class="number">00</span>   <span class="number">0</span>.<span class="number">00</span>    <span class="number">0</span>.<span class="number">00</span>     <span class="number">0</span>.<span class="number">00</span>    <span class="number">0</span>.<span class="number">00</span>      <span class="number">0</span>.<span class="number">00</span>     <span class="number">0</span>.<span class="number">00</span>   <span class="number">0</span>.<span class="number">00</span>    <span class="number">0</span>.<span class="number">00</span>     <span class="number">0</span>.<span class="number">00</span>    <span class="number">0</span>.<span class="number">00</span>    <span class="number">0</span>.<span class="number">00</span>    <span class="number">0</span>.<span class="number">00</span>   <span class="number">0</span>.<span class="number">00</span></span><br><span class="line"><span class="attribute">sda</span>              <span class="number">1</span>.<span class="number">10</span>     <span class="number">83</span>.<span class="number">67</span>     <span class="number">0</span>.<span class="number">82</span>  <span class="number">42</span>.<span class="number">71</span>    <span class="number">2</span>.<span class="number">38</span>    <span class="number">76</span>.<span class="number">10</span>    <span class="number">0</span>.<span class="number">78</span>      <span class="number">6</span>.<span class="number">50</span>     <span class="number">0</span>.<span class="number">91</span>  <span class="number">53</span>.<span class="number">78</span>    <span class="number">0</span>.<span class="number">66</span>     <span class="number">8</span>.<span class="number">34</span>    <span class="number">0</span>.<span class="number">00</span>      <span class="number">0</span>.<span class="number">00</span>     <span class="number">0</span>.<span class="number">00</span>   <span class="number">0</span>.<span class="number">00</span>    <span class="number">0</span>.<span class="number">00</span>     <span class="number">0</span>.<span class="number">00</span>    <span class="number">0</span>.<span class="number">15</span>    <span class="number">1</span>.<span class="number">66</span>    <span class="number">0</span>.<span class="number">00</span>   <span class="number">0</span>.<span class="number">11</span></span><br><span class="line"><span class="attribute">sdb</span>              <span class="number">0</span>.<span class="number">02</span>      <span class="number">0</span>.<span class="number">35</span>     <span class="number">0</span>.<span class="number">02</span>  <span class="number">43</span>.<span class="number">12</span>   <span class="number">15</span>.<span class="number">22</span>    <span class="number">16</span>.<span class="number">79</span>    <span class="number">0</span>.<span class="number">00</span>      <span class="number">0</span>.<span class="number">00</span>     <span class="number">0</span>.<span class="number">00</span>   <span class="number">0</span>.<span class="number">00</span>    <span class="number">8</span>.<span class="number">75</span>     <span class="number">1</span>.<span class="number">00</span>    <span class="number">0</span>.<span class="number">00</span>      <span class="number">0</span>.<span class="number">00</span>     <span class="number">0</span>.<span class="number">00</span>   <span class="number">0</span>.<span class="number">00</span>    <span class="number">0</span>.<span class="number">00</span>     <span class="number">0</span>.<span class="number">00</span>    <span class="number">0</span>.<span class="number">00</span>    <span class="number">8</span>.<span class="number">75</span>    <span class="number">0</span>.<span class="number">00</span>   <span class="number">0</span>.<span class="number">03</span></span><br></pre></td></tr></table></figure><ol><li><strong>rrqm/s:</strong>  æ¯ç§’è¿›è¡Œ merge çš„è¯»æ“ä½œæ•°ç›®ã€‚å³ rmerge/s</li><li><strong>wrqm/s:</strong>  æ¯ç§’è¿›è¡Œ merge çš„å†™æ“ä½œæ•°ç›®ã€‚å³ wmerge/s</li><li><strong>r/s:</strong>  æ¯ç§’å®Œæˆçš„è¯» I/O è®¾å¤‡æ¬¡æ•°ã€‚å³ rio/s</li><li><strong>w/s:</strong>  æ¯ç§’å®Œæˆçš„å†™ I/O è®¾å¤‡æ¬¡æ•°ã€‚å³ wio/s</li><li><strong>rkB/s:</strong>  æ¯ç§’è¯»Kå­—èŠ‚æ•°ã€‚æ˜¯ rsect/s çš„ä¸€åŠï¼Œå› ä¸ºæ¯æ‰‡åŒºå¤§å°ä¸º512å­—èŠ‚ã€‚</li><li><strong>wkB/s:</strong>  æ¯ç§’å†™Kå­—èŠ‚æ•°ã€‚æ˜¯ wsect/s çš„ä¸€åŠã€‚</li><li><strong>avgrq-sz:</strong>  å¹³å‡æ¯æ¬¡è®¾å¤‡I/Oæ“ä½œçš„æ•°æ®å¤§å° (æ‰‡åŒº)ã€‚</li><li><strong>avgqu-sz:</strong>  å¹³å‡I/Oé˜Ÿåˆ—é•¿åº¦ã€‚</li><li><strong>rsec/s:</strong>  æ¯ç§’è¯»æ‰‡åŒºæ•°ã€‚å³ rsect/s</li><li><strong>wsec/s:</strong>  æ¯ç§’å†™æ‰‡åŒºæ•°ã€‚å³ wsect/s</li><li>**r_await:**æ¯ä¸ªè¯»æ“ä½œå¹³å‡æ‰€éœ€çš„æ—¶é—´</li><li>ä¸ä»…åŒ…æ‹¬ç¡¬ç›˜è®¾å¤‡è¯»æ“ä½œçš„æ—¶é—´ï¼Œè¿˜åŒ…æ‹¬äº†åœ¨kernelé˜Ÿåˆ—ä¸­ç­‰å¾…çš„æ—¶é—´ã€‚</li><li>**w_await:**æ¯ä¸ªå†™æ“ä½œå¹³å‡æ‰€éœ€çš„æ—¶é—´</li><li>ä¸ä»…åŒ…æ‹¬ç¡¬ç›˜è®¾å¤‡å†™æ“ä½œçš„æ—¶é—´ï¼Œè¿˜åŒ…æ‹¬äº†åœ¨kernelé˜Ÿåˆ—ä¸­ç­‰å¾…çš„æ—¶é—´ã€‚</li><li><strong>await:</strong> å¹³å‡æ¯æ¬¡è®¾å¤‡I/Oæ“ä½œçš„ç­‰å¾…æ—¶é—´ (æ¯«ç§’)ã€‚</li><li><strong>svctm:</strong> å¹³å‡æ¯æ¬¡è®¾å¤‡I/Oæ“ä½œçš„æœåŠ¡æ—¶é—´ (æ¯«ç§’)ã€‚</li><li><strong>%util:</strong>  ä¸€ç§’ä¸­æœ‰ç™¾åˆ†ä¹‹å¤šå°‘çš„æ—¶é—´ç”¨äº I/O æ“ä½œï¼Œå³è¢«ioæ¶ˆè€—çš„cpuç™¾åˆ†æ¯”</li></ol><blockquote><p>å¦‚æœ %util æ¥è¿‘ 100%ï¼Œè¯´æ˜äº§ç”Ÿçš„I/Oè¯·æ±‚å¤ªå¤šï¼ŒI/Oç³»ç»Ÿå·²ç»æ»¡è´Ÿè·ï¼Œè¯¥ç£ç›˜å¯èƒ½å­˜åœ¨ç“¶é¢ˆã€‚</p><p>å¦‚æœ svctm æ¯”è¾ƒæ¥è¿‘ awaitï¼Œè¯´æ˜ I/O å‡ ä¹æ²¡æœ‰ç­‰å¾…æ—¶é—´</p><p>å¦‚æœ await è¿œå¤§äº svctmï¼Œè¯´æ˜I/O é˜Ÿåˆ—å¤ªé•¿ï¼Œioå“åº”å¤ªæ…¢ï¼Œåˆ™éœ€è¦è¿›è¡Œå¿…è¦ä¼˜åŒ–</p><p>å¦‚æœavgqu-szæ¯”è¾ƒå¤§ï¼Œä¹Ÿè¡¨ç¤ºæœ‰å½“é‡ioåœ¨ç­‰å¾…ã€‚</p></blockquote>]]></content>
    
    
    <summary type="html">ç›‘æµ‹ Linux çš„ç£ç›˜ I/O æ€§èƒ½</summary>
    
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/categories/linux%E5%91%BD%E4%BB%A4/"/>
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/tags/linux%E5%91%BD%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title>æ–‡ä»¶æè¿°ç¬¦å’Œè¿›ç¨‹æ•°è°ƒä¼˜</title>
    <link href="https://www.dddachui.top/posts/b379b34f.html"/>
    <id>https://www.dddachui.top/posts/b379b34f.html</id>
    <published>2022-09-18T06:14:25.000Z</published>
    <updated>2023-03-13T12:28:59.475Z</updated>
    
    <content type="html"><![CDATA[<h1>é—®é¢˜æè¿°</h1><ul><li><p>æ–‡ä»¶æè¿°ç¬¦</p><p><code>Too many open files</code>æ˜¯Linuxç³»ç»Ÿä¸­å¸¸è§çš„é”™è¯¯,ä»å­—é¢æ„æ€ä¸Šçœ‹å°±æ˜¯è¯´ç¨‹åºæ‰“å¼€çš„æ–‡ä»¶æ•°è¿‡å¤š,å…¶å®filesä¸å•æ˜¯æ–‡ä»¶çš„æ„æ€,ä¹ŸåŒ…æ‹¬æ‰“å¼€çš„é€šè®¯é“¾æ¥(æ¯”å¦‚socket),æ­£åœ¨ç›‘å¬çš„ç«¯å£ç­‰ç­‰,ä¹Ÿå¯ä»¥å«åšå¥æŸ„(handle),è¿™ä¸ªé”™è¯¯é€šå¸¸ä¹Ÿå¯ä»¥å«åš<code>å¥æŸ„æ•°è¶…å‡ºç³»ç»Ÿé™åˆ¶</code></p></li><li><p>ç”¨æˆ·æ‰“å¼€è¿›ç¨‹æ•°</p><p><code>no more progres</code>æˆ–è€…æ˜¯<code>Resource temporarily unavailable</code>,æ˜¯æ²¡æœ‰æ›´å¤šçš„è¿›ç¨‹å¯ç”¨,äº§ç”Ÿçš„åŸå› å¯èƒ½æœ‰</p><ol><li>ç”¨æˆ·çš„nprocè¾¾åˆ°é™åˆ¶ï¼Œæ— æ³•åˆ›å»ºæ–°çš„è¿›ç¨‹</li><li>ç³»ç»Ÿæ²¡æœ‰å¯åˆ†é…çš„çš„pidï¼Œå³è¿›ç¨‹å·å·²ç»è¾¾åˆ°å†…æ ¸å‚æ•°kernel.pid_maxçš„é™åˆ¶</li><li>ç³»ç»Ÿå¯ç”¨å†…å­˜ä½ï¼Œæ–°çš„è¿›ç¨‹æ— æ³•ç”³è¯·åˆ°å†…å­˜å¯¼è‡´ä¸èƒ½å¯åŠ¨</li></ol><p>nprocæ˜¯æ“ä½œç³»ç»Ÿçº§åˆ«å¯¹æ¯ä¸ªç”¨æˆ·åˆ›å»ºçš„è¿›ç¨‹æ•°çš„é™åˆ¶,åœ¨Linuxä¸‹è¿è¡Œå¤šçº¿ç¨‹æ—¶,æ¯ä¸ªçº¿ç¨‹çš„å®ç°å…¶å®æ˜¯ä¸€ä¸ªè½»é‡çº§çš„è¿›ç¨‹,å¯¹åº”çš„æœ¯è¯­æ˜¯:light weight process(LWP)</p></li></ul><h1>äº§ç”Ÿçš„åŸå› </h1><p>Linuxæ“ä½œç³»ç»Ÿä¸­åˆ©ç”¨<code>ulimit</code>é™åˆ¶shellå¯åŠ¨è¿›ç¨‹å ç”¨çš„èµ„æº,ulimitæ”¯æŒå¯¹ç”¨æˆ·çš„<code>æ‰“å¼€è¿›ç¨‹æ•°</code>ã€<code>è¿›ç¨‹æ‰“å¼€æ–‡ä»¶å¥æŸ„æ•°</code>ã€<code>è¿›ç¨‹æ‰“å¼€æ–‡ä»¶çš„å¤§å°</code>ã€è¿›ç¨‹coredumpæ–‡ä»¶`å¤§å°ç­‰èµ„æºè¿›è¡Œé™åˆ¶ï¼Œä»è€Œé˜²æ­¢æŸä¸ªç”¨æˆ·è¿›ç¨‹è¿‡åº¦å ç”¨ç³»ç»Ÿèµ„æºï¼Œé¿å…å½±å“æ•´ä¸ªæ“ä½œç³»ç»Ÿå’Œå…¶ä»–åº”ç”¨çš„æ­£å¸¸è¿è¡Œã€‚ä½†æ˜¯ä½¿ç”¨ulimitè¿›è¡Œé™åˆ¶åï¼Œå½“ç”¨æˆ·èµ„æºè¶…é™åˆ¶æ—¶ä¼šå‡ºç°å„ç§å„æ ·çš„æŠ¥é”™</p><h1>æ–‡ä»¶æè¿°ç¬¦è¾¾åˆ°ä¸Šé™</h1><h2 id="ä¿®æ”¹ä¸Šé™file-max">ä¿®æ”¹ä¸Šé™file-max</h2><p>è¿™æ˜¯<code>ç³»ç»Ÿçº§</code>å‚æ•°,file-maxæ˜¯æŸ¥çœ‹æ‰€æœ‰è¿›ç¨‹çš„æ‰“å¼€æ–‡ä»¶æ•°é‡çš„ç³»ç»ŸèŒƒå›´é™åˆ¶,å³ç³»ç»Ÿå¯æ‰“å¼€çš„æœ€å¤§æ•°é‡,ä½†æ—¥å¿—é‡Œé¢æŠ¥&quot;file-max reached&quot;çš„æ—¶å€™æ‰å»ä¿®æ”¹</p><ul><li>æŸ¥çœ‹file-maxæ•°å€¼</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/sys/fs/file-max  </span><br></pre></td></tr></table></figure><p>file-maxçš„å€¼ä¹Ÿä¹Ÿå’Œä¸‹é¢æœ‰è¿‘ä¼¼</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -r MemTotal /proc/meminfo | awk &#x27;&#123;printf(&quot;%d&quot;,$2/10)&#125;&#x27;</span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹æ–¹æ³•">ä¿®æ”¹æ–¹æ³•</h3><ul><li>å†™å…¥sysctl.conf</li></ul><p>é‡å¯ç”Ÿæ•ˆ,å»ºè®®å…ˆç”¨ä¸´æ—¶è®¾å®šç¡®å®šä¸€ä¸ªå€¼ä¹‹åå†™å…¥é…ç½®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;fs.file-max = 6553560&quot; &gt;&gt; /etc/sysctl.conf</span><br></pre></td></tr></table></figure><ul><li>ä¸´æ—¶ç”Ÿæ•ˆ</li></ul><p>é‡å¯æ¢å¤é»˜è®¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo  6553560 &gt; /proc/sys/fs/file-max</span><br></pre></td></tr></table></figure><ul><li>ä¸´æ—¶ç”Ÿæ•ˆ</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w &quot;fs.file-max=6553560&quot;</span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹nr-open">ä¿®æ”¹nr_open</h2><p>è¿™æ˜¯<code>è¿›ç¨‹çº§</code>çš„å‚æ•°,æŸ¥çœ‹å•ä¸ªè¿›ç¨‹å¯ä»¥æ‰“å¼€çš„æœ€å¤§æ–‡ä»¶æ•°</p><ul><li>æŸ¥çœ‹</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/sys/fs/nr_open   #è¾“å‡º1048576å³æ˜¯1024*1024,æ­£å¥½æ˜¯100ä¸‡</span><br></pre></td></tr></table></figure><h3 id="ä¿®æ”¹æ–¹æ³•-2">ä¿®æ”¹æ–¹æ³•</h3><ul><li>å†™å…¥sysctl.conf</li></ul><p>é‡å¯ç”Ÿæ•ˆ,å»ºè®®å…ˆç”¨ä¸´æ—¶è®¾å®šç¡®å®šä¸€ä¸ªå€¼ä¹‹åå†™å…¥é…ç½®</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo &quot;fs.nr_open=100000000&quot; &gt;&gt; /etc/sysctl.conf</span><br></pre></td></tr></table></figure><ul><li>ä¸´æ—¶ç”Ÿæ•ˆ</li></ul><p>,é‡å¯æ¢å¤é»˜è®¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo  100000000 &gt; /proc/sys/fs/nr_open</span><br></pre></td></tr></table></figure><ul><li>ä¸´æ—¶ç”Ÿæ•ˆ</li></ul><p>é‡å¯æ¢å¤é»˜è®¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sysctl -w &quot;fs.nr_open=100000000&quot;</span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹file-nr">æŸ¥çœ‹file-nr</h2><p>ä»–å…¶å®å°±æ˜¯ä¸€ä¸ªç»Ÿè®¡,è¾“å‡º<code>å½“å‰æ‰“å¼€çš„æ–‡ä»¶æ•°</code>,<code>ç©ºé—²æ–‡ä»¶å¥æŸ„æ•°é‡</code>,<code>æ–‡ä»¶å¥æŸ„çš„æœ€å¤§æ•°é‡(file-max)</code>ä¸‰åˆ—å€¼,è¿™æ˜¯ä¸€ä¸ªåªè¯»æ–‡ä»¶,æ˜¯æ‹¿æ¥çœ‹èµ„æºçš„,ä¸ç”¨ä¿®æ”¹</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /proc/sys/fs/file-nr   #è¾“å‡º55040195620</span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹limits-conf">ä¿®æ”¹limits.conf</h2><p>æ—¢å¯ä»¥ç”¨<code>ulimitå‘½ä»¤</code>æ¥ä¿®æ”¹,ä¹Ÿå¯ä»¥<code>å†™è¿›ç³»ç»Ÿçš„é…ç½®æ–‡ä»¶</code></p><blockquote><p>æ³¨æ„</p><ol><li><p>nofileæ˜¯æ‰“å¼€æœ€å¤§æ–‡ä»¶æ•°, å¯¹åº”limits.confçš„nofileå‚æ•°,é‡å¯ç”Ÿæ•ˆ</p></li><li><p>softè¦å°äºhard</p></li><li><p>nofileçš„å€¼éœ€è¦å°äºç­‰äºnr_opençš„å€¼</p></li></ol></blockquote><ul><li>ä¿®æ”¹æˆå¦‚ä¸‹</li></ul><p>å°†æ‰€æœ‰ç”¨æˆ·çš„å¯¹<code>æ–‡ä»¶æè¿°ç¬¦</code>çš„é™åˆ¶éƒ½æ”¹æˆ6553500</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">* soft nofile 6553500</span><br><span class="line">* hard nofile 6553500</span><br></pre></td></tr></table></figure><h2 id="åˆ†æç³»ç»Ÿ">åˆ†æç³»ç»Ÿ</h2><p>å…¶å®<code>è°ƒä¼˜</code>åªæ˜¯é‡Šæ”¾èµ„æºçš„ä¸€ç§æ‰‹æ®µ,æ›´é‡è¦çš„æ˜¯æ‰¾å‡ºåŸå› ,å¯èƒ½æ˜¯ä¸šåŠ¡æŸä¸ªæ—¶é—´æ®µä¸šåŠ¡é‡æ¿€å¢,ä¹Ÿå¯èƒ½æ˜¯åº”ç”¨è§¦å‘äº†æŸä¸ªbug</p><ul><li>ç»Ÿè®¡å„å‘½ä»¤æ‰“å¼€å¥æŸ„æ•°</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsof -n | awk &#x27;&#123;print $1&#125;&#x27; | sort | uniq -c | sort -nr</span><br></pre></td></tr></table></figure><ul><li>ç»Ÿè®¡å„è¿›ç¨‹æ‰“å¼€å¥æŸ„æ•°</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsof -n | awk &#x27;&#123;print $2&#125;&#x27; | sort | uniq -c | sort -nr</span><br></pre></td></tr></table></figure><ul><li>ç»Ÿè®¡å„ç”¨æˆ·æ‰“å¼€å¥æŸ„æ•°</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsof -n | awk &#x27;&#123;print $3&#125;&#x27; | sort | uniq -c | sort -nr</span><br></pre></td></tr></table></figure><h2 id="å¤ç°æ–¹æ³•">å¤ç°æ–¹æ³•</h2><p>å°†æˆ‘ä»¬çš„èµ„æºä¸´æ—¶æ”¹æˆ<code>6</code>,æ­¤æ—¶ç±»ä¼¼<code>top</code>æˆ–è€…<code>lsof</code>ç­‰å‘½ä»¤å°±å·²ç»ä¸èƒ½ç”¨äº†,å› ä¸ºä»–ä»¬äº§ç”Ÿçš„å¥æŸ„ä¼šå¾ˆå¤š,è€Œæˆ‘ä»¬åªé™åˆ¶åªèƒ½æ‰“å¼€<code>6</code></p><ul><li>ä¸´æ—¶ä¿®æ”¹nofile</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ulimit -n 6</span><br></pre></td></tr></table></figure><ul><li>éšä¾¿è¾“å…¥æŸäº›å‘½ä»¤</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top</span><br></pre></td></tr></table></figure><ul><li>è§¦å‘æŠ¥é”™</li></ul><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">top</span>: failed <span class="attribute">openproc</span>: Too many open files</span><br></pre></td></tr></table></figure><h1>ç”¨æˆ·æœ€å¤§è¿›ç¨‹æ•°é‡è¾¾åˆ°ä¸Šé™</h1><p>åœ¨rhel6å’Œ7ä¸Šé¢,è¿™ä¸ªå‚æ•°é»˜è®¤å¯¹rootæ²¡æœ‰é™åˆ¶,ä»–æ˜¯ä»å†…æ ¸ç»§æ‰¿çš„,å¯¹äºå…¶ä»–ç”¨æˆ·æ¥è¯´å°±4096,æ˜¯æ ¹æ®ä¸‹é¢çš„æ–‡ä»¶è®¾å®šçš„</p><ul><li>CentOS6ä¸­limits.dä¸‹é¢æ˜¯90-nproc.conf</li><li>CentOS7ä¸­limits.dä¸‹é¢æ˜¯20-nproc.conf</li></ul><h2 id="å¦‚ä½•æŸ¥çœ‹">å¦‚ä½•æŸ¥çœ‹</h2><ul><li>æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·åˆ›å»ºçš„è¿›ç¨‹æ•°</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps h -Led -o user | sort | uniq -c | sort -n</span><br></pre></td></tr></table></figure><ul><li>æŒ‡å®šæŸä¸ªç”¨æˆ·æŸ¥çœ‹åˆ›å»ºçš„è¿›ç¨‹æ•°</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -o nlwp,pid,lwp,args -u root | sort -n</span><br></pre></td></tr></table></figure><h2 id="ä¿®æ”¹xx-nproc-confæ–‡ä»¶">ä¿®æ”¹xx-nproc.confæ–‡ä»¶</h2><p>å°†ç¬¬ä¸€è¡Œçš„nprocçš„å€¼æ”¾å¤§,æˆ‘ä¸€èˆ¬æ˜¯æ”¹æˆ4096,å¦‚æœè¿˜ä¸å¤Ÿç»§ç»­æ”¾å¤§</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*          soft    nproc     1024</span><br><span class="line">root       soft    nproc     unlimite</span><br></pre></td></tr></table></figure><h2 id="å¦‚ä½•ç”Ÿæ•ˆ">å¦‚ä½•ç”Ÿæ•ˆ</h2><p>æœ‰2ç§æ–¹æ³•å¦‚ä¸‹,ä»»é€‰å…¶ä¸­ä¹‹ä¸€</p><ul><li>æœ¬åœ°æ³¨é”€æ¡Œé¢æˆ–è€…é€€å‡ºç»ˆç«¯é‡æ–°ç™»é™†</li><li>é‡å¯æœ€å¥½</li></ul><h2 id="éªŒè¯ç»“æœ">éªŒè¯ç»“æœ</h2><h3 id="å¯¹äºbashç”¨æˆ·">å¯¹äºbashç”¨æˆ·</h3><ul><li>æŸ¥çœ‹æ–¹æ³•</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ulimit -a</span><br></pre></td></tr></table></figure><ul><li>ç»“æœå¦‚ä¸‹</li></ul><p>ä¿®æ”¹çš„æ˜¯<code>nproc</code>å‚æ•°,å¯¹åº”<code>max user processes</code>å­—æ®µ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">real-time non-blocking time  (microseconds, -R) unlimited</span><br><span class="line">core file size              (blocks, -c) unlimited</span><br><span class="line">data seg size               (kbytes, -d) unlimited</span><br><span class="line">scheduling priority                 (-e) 0</span><br><span class="line">file size                   (blocks, -f) unlimited</span><br><span class="line">pending signals                     (-i) 61604</span><br><span class="line">max locked memory           (kbytes, -l) 64</span><br><span class="line">max memory size             (kbytes, -m) unlimited</span><br><span class="line">open files                          (-n) 65535</span><br><span class="line">pipe size                (512 bytes, -p) 8</span><br><span class="line">POSIX message queues         (bytes, -q) 819200</span><br><span class="line">real-time priority                  (-r) 0</span><br><span class="line">stack size                  (kbytes, -s) 8192</span><br><span class="line">cpu time                   (seconds, -t) unlimited</span><br><span class="line">max user processes                  (-u) 61604</span><br><span class="line">virtual memory              (kbytes, -v) unlimited</span><br><span class="line">file locks                          (-x) unlimited</span><br></pre></td></tr></table></figure><h3 id="å¯¹äºtcshç”¨æˆ·">å¯¹äºtcshç”¨æˆ·</h3><ul><li>æŸ¥çœ‹æ–¹æ³•</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">limit</span><br></pre></td></tr></table></figure><ul><li>ç»“æœå¦‚ä¸‹</li></ul><p>ä¿®æ”¹çš„æ˜¯<code>nproc</code>å‚æ•°,å¯¹åº”<code>maxproc</code>å­—æ®µ</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">cputime</span>      unlimited</span><br><span class="line"><span class="attribute">filesize</span>     unlimited</span><br><span class="line"><span class="attribute">datasize</span>     unlimited</span><br><span class="line"><span class="attribute">stacksize</span>    <span class="number">8192</span> kbytes</span><br><span class="line"><span class="attribute">coredumpsize</span> unlimited</span><br><span class="line"><span class="attribute">memoryuse</span>    unlimited</span><br><span class="line"><span class="attribute">vmemoryuse</span>   unlimited</span><br><span class="line"><span class="attribute">descriptors</span>  <span class="number">65535</span> </span><br><span class="line"><span class="attribute">memorylocked</span> <span class="number">64</span> kbytes</span><br><span class="line"><span class="attribute">maxproc</span>      <span class="number">61604</span> </span><br><span class="line"><span class="attribute">maxlocks</span>     unlimited</span><br><span class="line"><span class="attribute">maxsignal</span>    <span class="number">61604</span> </span><br><span class="line"><span class="attribute">maxmessage</span>   <span class="number">819200</span> </span><br><span class="line"><span class="attribute">maxnice</span>      <span class="number">0</span> </span><br><span class="line"><span class="attribute">maxrtprio</span>    <span class="number">0</span> </span><br><span class="line"><span class="attribute">maxrttime</span>    unlimited</span><br></pre></td></tr></table></figure><h2 id="å¤ç°æ–¹æ³•-2">å¤ç°æ–¹æ³•</h2><ul><li>å°†æ™®é€šç”¨æˆ·çš„nprocä¸´æ—¶ä¿®æ”¹</li></ul><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ulimit</span> -u  <span class="number">5</span></span><br></pre></td></tr></table></figure><ul><li>ç®€å•å†™ä¸ªtest.c</li></ul><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;unistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">        <span class="type">pid_t</span> pid;</span><br><span class="line">        <span class="type">int</span> count=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(count&lt;<span class="number">3</span>)&#123;</span><br><span class="line">        pid=fork();</span><br><span class="line">        count++;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;count= %d\n&quot;</span>,count);&#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç¼–è¯‘</li></ul><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc <span class="keyword">test</span>.c -o <span class="keyword">test</span></span><br></pre></td></tr></table></figure><ul><li>æ‰§è¡Œ</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./test</span><br></pre></td></tr></table></figure><ul><li>æŠ¥é”™</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-bash: fork: retry: èµ„æºæš‚æ—¶ä¸å¯ç”¨</span><br></pre></td></tr></table></figure><h1>æƒ³æ³•</h1><ul><li><p>[x] <code>limits.confå’Œxx-nproc.conféƒ½æ”¯æŒä¿®æ”¹</code>nproc<code>,ä¸ºä»€ä¹ˆå°±æ”¹xx-nproc.conf? </code>å› ä¸º/etc/security/limits.d/é‡Œé¢çš„æ–‡ä»¶é‡Œé¢çš„é…ç½®ä¼šè¦†ç›–/etc/security/limits.confçš„é…ç½®</p></li><li><p>[x] <code>é¡ºåº</code>?soft&lt;hard&lt;nr_open&lt;file-max</p></li><li><p>[ ] <code>æ–‡ä»¶æè¿°ç¬¦çš„ä¸Šé™åœ¨å“ª?</code></p></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for  V in `seq  100000  10000000` ; do ulimit -n $V ; [[ $? != 0 ]] &amp;&amp; break;done</span><br></pre></td></tr></table></figure><ul><li><p>[x] <code>lsofæ˜¯å¦å¯ä»¥ç”¨æ¥æ’æŸ¥è¿™ä¿©ä¸ªæŠ¥é”™?</code>lsofå¯ä»¥çœ‹æ‰“å¼€çš„æ–‡ä»¶æ•°é‡,ç”¨psçœ‹è¿›ç¨‹æ•°é‡</p></li><li><p>[x] <code>file-maxçš„ä¸Šé™åœ¨å“ªé‡Œå‘¢?</code>åªè¦ä½ çš„å†…å­˜è¶³å¤Ÿå¤§ï¼Œfile-maxçš„å€¼å¯ä»¥éå¸¸å¤§(å¤§æ¦‚è¿™ä¹ˆè¯´)</p></li><li><p>[x] <code>nprocçš„æœ€å¤§æ˜¯åœ¨å“ªé‡Œ?</code></p></li></ul><p>è¿™ä¸ªæ•°å­—åœ¨centos8(ä¸åŒ…æ‹¬8)æ˜¯å’Œé…ç½®æ˜¾ç¤ºä¸€è‡´çš„,åœ¨8ä¹‹åç”±å†…æ ¸å†³å®š,é€šè¿‡ä¸‹é¢çš„å‘½ä»¤,å¯ä»¥è®¡ç®—å‡ºæˆ‘ä»¬å¯ä»¥é…ç½®çš„æœ€å¤§çš„nproc</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo $(($(cat /proc/sys/kernel/threads-max)/2))</span><br></pre></td></tr></table></figure><ul><li>[x] ä¹‹å‰ä¸€ç›´æ‹¿rootåšå®éªŒ,å…¶å®å¾—ç”¨æ™®é€šç”¨æˆ·æ¥éªŒè¯æ‰€æœ‰çš„æ•ˆæœ,å°±æ¯”å¦‚nproc,rootå’Œæ™®é€šç”¨æˆ·çœ‹åˆ°æ˜¯ä¸ä¸€æ ·çš„,æ˜æ˜¾é»˜è®¤rootå°±ä¼šå¤šä¸€ç‚¹,è€Œæ™®é€šç”¨æˆ·æ˜¯æ ¹æ®é…ç½®æ¥çš„</li></ul><h1>æ¨èé˜…è¯»</h1><ol><li><a href="https://xie.infoq.cn/article/30eeb766ecfac245cc96c45c6">https://xie.infoq.cn/article/30eeb766ecfac245cc96c45c6</a></li><li><a href="https://www.cnblogs.com/Chary/p/15842219.html">https://www.cnblogs.com/Chary/p/15842219.html</a></li><li><a href="https://blog.csdn.net/cnbird2008/article/details/8666620">https://blog.csdn.net/cnbird2008/article/details/8666620</a></li><li><a href="https://elixir.bootlin.com/linux/latest/source">linuxå†…æ ¸ä»£ç </a></li><li><a href="https://elixir.bootlin.com/linux/v5.10.143/source/kernel/fork.c#L2523">kernel/forc.c,å†…æ ¸å®šä¹‰çš„nprocæœ€å¤§å€¼,810è¡Œå·¦å³</a></li></ol>]]></content>
    
    
    <summary type="html">too many open files å’Œ no more progres è§£å†³æ–¹æ³•</summary>
    
    
    
    <category term="æ•…éšœå¤„ç†" scheme="https://www.dddachui.top/categories/%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86/"/>
    
    
    <category term="æ•…éšœå¤„ç†" scheme="https://www.dddachui.top/tags/%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>gitæ‹‰å–æ€»æ˜¯éœ€è¦å¯†ç </title>
    <link href="https://www.dddachui.top/posts/e07e5f84.html"/>
    <id>https://www.dddachui.top/posts/e07e5f84.html</id>
    <published>2022-09-07T05:19:24.000Z</published>
    <updated>2023-03-13T12:30:45.002Z</updated>
    
    <content type="html"><![CDATA[<h1>è§£å†³åŠæ³•</h1><ul><li>å…ˆåœ¨æœ¬åœ°gitä»“åº“ä¸‹æ‰§è¡Œ</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config --global credential.helper store</span><br></pre></td></tr></table></figure><ul><li>ç„¶åæ‹‰å–</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git pull</span><br></pre></td></tr></table></figure><ul><li>æ­¤æ—¶ä»–ä¼šæç¤ºè¾“å…¥å¯†ç ,å®ŒæˆéªŒè¯ä¹‹åå°±å¯ä»¥äº†</li></ul>]]></content>
    
    
    <summary type="html">å…å¯†ä¸Šä¼ </summary>
    
    
    
    <category term="æ•…éšœå¤„ç†" scheme="https://www.dddachui.top/categories/%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86/"/>
    
    
    <category term="æ•…éšœå¤„ç†" scheme="https://www.dddachui.top/tags/%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86/"/>
    
  </entry>
  
  <entry>
    <title>Linuxå¥½ç”¨å‘½ä»¤ä¹‹nmcli</title>
    <link href="https://www.dddachui.top/posts/6ad86d1e.html"/>
    <id>https://www.dddachui.top/posts/6ad86d1e.html</id>
    <published>2022-09-04T04:06:22.000Z</published>
    <updated>2023-03-13T12:49:50.733Z</updated>
    
    <content type="html"><![CDATA[<h1>NetworkManager</h1><ol><li>NetworkManageræœåŠ¡æ˜¯ç®¡ç†å’Œç›‘æ§ç½‘ç»œè®¾ç½®çš„å®ˆæŠ¤è¿›ç¨‹,Centos7ä¹‹å‰çš„ç‰ˆæœ¬éƒ½æ˜¯é€šè¿‡network.serviceç®¡ç†ç½‘ç»œé…ç½®</li><li>åˆ°äº†Centos7å°±åŒæ—¶æ”¯æŒnetwork.serviceå’ŒNetworkManager.service</li><li>åœ¨RHEL 8/Centos 8ä¸Šå·²åºŸå¼ƒnetwork.serviceï¼ˆé»˜è®¤ä¸å®‰è£…ï¼‰,åªèƒ½é€šè¿‡NetworkManagerè¿›è¡Œç½‘ç»œé…ç½®ã€‚</li><li>NetworkManagerä¸»è¦ç®¡ç†2ä¸ªå¯¹è±¡ <code>Connection</code>ï¼ˆç½‘å¡è¿æ¥é…ç½®ï¼‰ å’Œ <code>Device</code>ï¼ˆç½‘å¡è®¾å¤‡ï¼‰,ä»–ä»¬ä¹‹é—´æ˜¯å¤šå¯¹ä¸€çš„å…³ç³»,ä½†æ˜¯åŒä¸€æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªConnectionå¯¹äºDeviceæ‰ç”Ÿæ•ˆ</li></ol><h1>å¯åŠ¨æ–¹æ³•</h1><p>å¯åŠ¨+å¼€æœºè‡ªå¯åŠ¨</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable --now NetworkManager</span><br></pre></td></tr></table></figure><h1>ä¸‰ç§æ–¹æ³•é…ç½®ç½‘ç»œ</h1><ol><li>é€šè¿‡nmcli connection addå‘½ä»¤é…ç½®,ä¼šè‡ªåŠ¨ç”Ÿæˆifcfgæ–‡ä»¶</li><li>æ‰‹åŠ¨é…ç½®ifcfgæ–‡ä»¶,é€šè¿‡nmcli connection reloadæ¥åŠ è½½ç”Ÿæ•ˆ</li><li>æ‰‹åŠ¨é…ç½®ifcfgæ–‡ä»¶,é€šè¿‡ä¼ ç»Ÿnetwork.serviceæ¥åŠ è½½ç”Ÿæ•ˆ</li></ol><h1>nmcliåŸºæ“</h1><p>NetworkManageråœ¨ç³»ç»Ÿä¸­çš„ç®¡ç†å·¥å…·ä¸ºnmcli,è¿™ä¸ªå‘½ä»¤<code>å˜å˜å¥½ç”¨</code></p><h2 id="æŸ¥çœ‹æ‰€æœ‰è¿æ¥">æŸ¥çœ‹æ‰€æœ‰è¿æ¥</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection show </span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹æ‰€æœ‰æ¿€æ´»çš„è¿æ¥">æŸ¥çœ‹æ‰€æœ‰æ¿€æ´»çš„è¿æ¥</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection show --active</span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹æŒ‡å®šçš„ç½‘å£çš„è¿æ¥">æŸ¥çœ‹æŒ‡å®šçš„ç½‘å£çš„è¿æ¥</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection show eth0</span><br></pre></td></tr></table></figure><h2 id="å…³é—­è¿æ¥">å…³é—­è¿æ¥</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection down eth0</span><br></pre></td></tr></table></figure><h2 id="å¯ç”¨è¿æ¥">å¯ç”¨è¿æ¥</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection up eth0</span><br></pre></td></tr></table></figure><h1>nmclié…ç½®ç½‘ç»œå®ä¾‹-dhcp</h1><h2 id="æ–°å¢è¿æ¥">æ–°å¢è¿æ¥</h2><ul><li>åˆ›å»ºä¸€ä¸ªè¿æ¥å<code>dachui</code>,ä½¿ç”¨ens33è®¾å¤‡</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection add con-name dachui type Ethernet ifname ens33</span><br></pre></td></tr></table></figure><h2 id="å±•ç¤ºåˆ›å»ºåçš„æ•ˆæœ">å±•ç¤ºåˆ›å»ºåçš„æ•ˆæœ</h2><p>(å®åœ¨ä¸æƒ³é…å›¾)<br>å¯ä»¥çœ‹å‡ºåªæœ‰ä¸€ä¸ªè¡Œ<code>NAME</code>æ˜¯ens33æ˜¯æ¿€æ´»çš„(å› ä¸ºæ¿€æ´»çš„è¿æ¥åœ¨ç»ˆç«¯æ˜¾ç¤ºç»¿è‰²,æˆ–è€…ç”¨â€“activeå¯ä»¥çœ‹å‡ºæ¥)</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">NAME    UUID                                  TYPE      DEVICE </span><br><span class="line">ens33   c96bc909-188e-ec64-3a96-6a90982b08ad  ethernet  ens33  </span><br><span class="line">dachui  4b27c0d3-17d5-434b-90d1-5ac57a0f6147  ethernet  --     </span><br><span class="line">ens34   94aea789-efb3-ef4c-81b0-e8b18ecc9797  ethernet  -- </span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹dachuiçš„é…ç½®">æŸ¥çœ‹<code>dachui</code>çš„é…ç½®</h2><p>å¦‚æœä¸åŠ <code>grep</code>,ä»–ä¼šæ˜¾ç¤ºå¾ˆå¤šä¿¡æ¯,ä½†æˆ‘ä»¬åªéœ€è¦å…³æ³¨ipv4çš„ä¿¡æ¯</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection show dachui | grep ipv4</span><br></pre></td></tr></table></figure><h2 id="é…ç½®å±•ç¤º">é…ç½®å±•ç¤º</h2><p>å¯ä»¥çœ‹å‡ºç¬¬ä¸€è¡Œ<code>ipv4.method</code>çš„æ˜¯<code>auto</code>,ä»–ä»£è¡¨<code>dachui</code>è¿™ä¸ªè¿æ¥æ˜¯ç”¨<code>dhcp</code>çš„æ–¹å¼è·å–ipçš„</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">ipv4.method:                            auto</span><br><span class="line">ipv4.dns:                               --</span><br><span class="line">ipv4.dns-search:                        --</span><br><span class="line">ipv4.dns-options:                       &quot;&quot;</span><br><span class="line">ipv4.dns-priority:                      0</span><br><span class="line">ipv4.addresses:                         --</span><br><span class="line">ipv4.gateway:                           --</span><br><span class="line">ipv4.routes:                            --</span><br><span class="line">ipv4.route-metric:                      -1</span><br><span class="line">ipv4.route-table:                       0 (unspec)</span><br><span class="line">ipv4.routing-rules:                     --</span><br><span class="line">ipv4.ignore-auto-routes:                å¦</span><br><span class="line">ipv4.ignore-auto-dns:                   å¦</span><br><span class="line">ipv4.dhcp-client-id:                    --</span><br><span class="line">ipv4.dhcp-timeout:                      0 (default)</span><br><span class="line">ipv4.dhcp-send-hostname:                æ˜¯</span><br><span class="line">ipv4.dhcp-hostname:                     --</span><br><span class="line">ipv4.dhcp-fqdn:                         --</span><br><span class="line">ipv4.never-default:                     å¦</span><br><span class="line">ipv4.may-fail:                          æ˜¯</span><br><span class="line">ipv4.dad-timeout:                       -1 (default)</span><br></pre></td></tr></table></figure><h2 id="æ¿€æ´»dhcp">æ¿€æ´»dhcp</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli con show ens33 | grep IP4</span><br></pre></td></tr></table></figure><ul><li>æ¿€æ´»çš„ç»“æœ<br>å¯ä»¥çœ‹å‡ºè¿™è¾¹ipv4çš„åœ°å€å·²ç»è‡ªåŠ¨è·å–äº†</li></ul><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">IP4.ADDRESS[1]:                         192.168.42.135/24</span><br><span class="line">IP4.GATEWAY:                            192.168.42.2</span><br><span class="line">IP4.ROUTE[1]:                           dst = 0.0.0.0/0, nh = 192.168.42.2, mt = 102</span><br><span class="line">IP4.ROUTE[2]:                           dst = 192.168.42.0/24, nh = 0.0.0.0, mt = 102</span><br><span class="line">IP4.DNS[1]:                             192.168.42.2</span><br><span class="line">IP4.DOMAIN[1]:                          localdomain</span><br></pre></td></tr></table></figure><h1>nmclié…ç½®ç½‘ç»œå®ä¾‹-static</h1><p>åˆšæ‰æ˜¯å±•ç¤ºçš„æ–°å¢ä¸€ä¸ªè¿æ¥,ä½¿ç”¨é»˜è®¤çš„<code>dhcp</code>æ–¹å¼é…ç½®ç½‘ç»œ,ä½†å®é™…é¡¹ç›®ä¸­éœ€è¦ä½¿ç”¨é™æ€ipçš„æ–¹å¼,é…ç½®é™æ€çš„æ‰‹æ®µæœ‰å¾ˆå¤š,å¯ä»¥å¯¹ç°åœ¨æœ‰<code>è¿æ¥</code>è¿›è¡Œç³»iuæ”¹,ä¹Ÿå¯ä»¥å†åˆ›å»ºä¸€ä¸ª<code>è¿æ¥</code>å¹¶ä¸”åŒæ—¶æŒ‡å®šä»–çš„ipåœ°å€</p><h2 id="ä¸€æ¬¡æ€§åˆ›å»º">ä¸€æ¬¡æ€§åˆ›å»º</h2><p>ä¹ä¸€çœ‹å‘½ä»¤<code>å˜å˜</code>é•¿,å…¶å®å¾ˆç®€å•</p><ul><li><code>å˜å˜</code>é•¿çš„å‘½ä»¤,å…¶å®å¯ä»¥æ›´é•¿</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection add con-name dachui-static type ethernet ifname ens33 ipv4.method manual ipv4.address 192.168.42.5/24 ipv4.gateway 192.168.42.2</span><br></pre></td></tr></table></figure><blockquote><p>æˆ‘æ‹†å¼€ä¸¤éƒ¨åˆ†åˆ†æ</p></blockquote><ol><li>åˆ›å»ºè¿æ¥,æŒ‡å®šæ¨¡å¼<br>è¿™è¾¹å°±æ˜¯åˆ›å»ºäº†<code>dahcui-static</code>çš„è¿æ¥,ä½¿ç”¨<code>type</code>æŒ‡å®šæ­¤è¿æ¥ä¸º<code>ethernet</code>(ä»¥å¤ªç½‘),å¹¶ä¸”è®¾å¤‡æ˜¯<code>ens33</code></li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection add con-name dachui-static type ethernet ifname ens33</span><br></pre></td></tr></table></figure><ol start="2"><li>é…ç½®ç½‘ç»œè¦ç´ <br>ä¸€ä¸ªipåœ°å€è‡³å°‘éœ€è¦æŒ‡å®šä¸€ä¸ª<code>ip</code>å’Œ<code>å­ç½‘æ©ç </code>æ‰å¯ä»¥ç”Ÿæ•ˆ,ç½‘å…³ä¹Ÿæ˜¯éœ€è¦é…ç½®çš„,è¿˜æœ‰æŒ‡å®šæ˜¯æ‰‹åŠ¨</li></ol><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">ipv4</span>.method manual ipv4.address <span class="number">192.168.42.5</span>/<span class="number">24</span> ipv4.gateway <span class="number">192.168.42.2</span></span><br></pre></td></tr></table></figure><ul><li>æ¿€æ´»è¿æ¥</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection up dachui-static</span><br></pre></td></tr></table></figure><ul><li>éªŒè¯</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection up dachui-static | grep IP4</span><br></pre></td></tr></table></figure><blockquote><p>è¾“å‡ºä¸ºä¸‹é¢çš„</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">IP4.ADDRESS[1]:                         192.168.42.5/24</span><br><span class="line">IP4.GATEWAY:                            192.168.42.2</span><br><span class="line">IP4.ROUTE[1]:                           dst = 0.0.0.0/0, nh = 192.168.42.2, mt = 102</span><br><span class="line">IP4.ROUTE[2]:                           dst = 192.168.42.0/24, nh = 0.0.0.0, mt = 102</span><br><span class="line">IP4.DNS[1]:                             192.168.42.2</span><br><span class="line">IP4.DOMAIN[1]:                          localdomain</span><br></pre></td></tr></table></figure><h2 id="ç¼–è¾‘è¿æ¥">ç¼–è¾‘è¿æ¥</h2><p>å¦‚æœä¹‹å‰æ˜¯åˆ›å»ºå¥½äº†å¤šä¸ªè¿æ¥,ä½†æ˜¯éœ€è¦ä¿®æ”¹,å¯ä»¥é€šè¿‡modifyçš„æ–¹æ³•</p><ul><li>æç¤ºä¸€ç‚¹<br>å¦‚æœè¦ä¿®æ”¹,è¯·çœ‹å¥½åŸå…ˆçš„<code>è¿æ¥</code>æ˜¯<code>è‡ªåŠ¨è·å–</code>è¿˜æ˜¯<code>æ‰‹åŠ¨è·å–</code>,å¦‚æœæ˜¯è‡ªåŠ¨,éœ€è¦æ”¹æ¨¡å¼</li></ul><blockquote><p>å¯ä»¥ä¸€å¹¶åŠ å…¥ä¿®æ”¹çš„,æˆ‘åªæ˜¯æ‹†å¼€æç¤ºä¸€ä¸‹,é‡åˆ°è¿‡ä¸€æ¬¡æ”¹äº†åŠå¤©æ²¡ç”Ÿæ•ˆ,ä¸€çœ‹è¿æ¥æ–¹å¼æ˜¯dhcp</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection modify dachui-static ipv4.method manual </span><br></pre></td></tr></table></figure><ul><li>ä¿®æ”¹ip<br>ä¹Ÿå¯ä»¥ä¿®æ”¹å…¶ä»–çš„,åœ¨è¾“å…¥<code>dachui-static</code>ä¹‹åæŒ‰<code>tap</code>ä¼šåˆ—ä¸¾å‡ºæ‰€æœ‰çš„<code>é…ç½®é¡¹</code>,ç„¶åæ ¹æ®è¯­æ³•ä¿®æ”¹</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection modify dachui-static ipv4.address 192.168.42.200/24</span><br></pre></td></tr></table></figure><ul><li>é‡å¯ç½‘å¡<br>ä¿®æ”¹ä¹‹åéœ€è¦æ¿€æ´»ä¸€ä¸‹æ‰èƒ½ç”Ÿæ•ˆ</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection up dachui-static</span><br></pre></td></tr></table></figure><blockquote><p>è¿™æ ·ä¸€ä¸ªåŸºæœ¬çš„nmlciåˆ›å»ºè¿æ¥å°±ç»“æŸäº†</p></blockquote><h1>å…¶ä»–åŸºæ“</h1><h2 id="å¢åŠ è·¯ç”±">å¢åŠ è·¯ç”±</h2><p>å†…ç½‘ç¯å¢ƒä¸‹,æœºå™¨å¯èƒ½æœ‰å¤šä¸ªç½‘æ®µ,é‚£ä¹ˆåŠ è·¯ç”±è‚¯å®šæ˜¯å¿…é¡»çš„,æ¯”å¦‚æˆ‘è¿™éœ€è¦è®¿é—®<code>10.10.10.0/24</code>çš„æœºå™¨,é‚£ä¹ˆé€šè¿‡å¦‚ä¸‹æ–¹æ³•è¿›è¡Œé…ç½®</p><ul><li>åŠ è·¯ç”±</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection modify dachui-static +ipv4.routes &quot;10.10.10.0/24 192.168.42.2&quot;</span><br></pre></td></tr></table></figure><ul><li>æ¿€æ´»çœ‹ä¿¡æ¯</li></ul><ol><li>é…ç½®ä¿¡æ¯</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">IP4.ROUTE[5]:                           dst = 10.10.10.0/24, nh = 192.168.42.2, mt = 102</span><br></pre></td></tr></table></figure><ol start="2"><li>è·¯ç”±ä¿¡æ¯</li></ol><ul><li>routeå±•ç¤º</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">route -n</span><br></pre></td></tr></table></figure><ul><li>è¾“å‡ºç»“æœ</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Destination     Gateway         Genmask         Flags Metric Ref    Use Iface</span><br><span class="line">0.0.0.0         192.168.42.2    0.0.0.0         UG    102    0        0 ens33</span><br><span class="line">10.10.10.0      192.168.42.2    255.255.255.0   UG    102    0        0 ens33</span><br></pre></td></tr></table></figure><h2 id="åˆ é™¤è·¯ç”±">åˆ é™¤è·¯ç”±</h2><p>å­¦ä¼šå¢åŠ ,ä¹Ÿè¦å­¦ä¼šåˆ é™¤</p><ul><li><code>ä¹ä¸€çœ‹</code>æ˜¯ä¸æ˜¯ä¸€æ ·çš„?å…¶å®å°†<code>+</code>æ”¹æˆ<code>-</code>,ç„¶å<code>é‡æ–°æ¿€æ´»</code>å°±å¯ä»¥äº†</li></ul><blockquote><p>æ‰€ä»¥ä¿®æ”¹çš„é€»è¾‘å¾ˆç®€å•çš„,<code>+</code>å°±å¢åŠ ,<code>-</code>å°±æ˜¯åˆ é™¤,<code>ä»€ä¹ˆéƒ½ä¸åŠ </code>å°±æ˜¯ä¿®æ”¹</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection modify dachui-static -ipv4.routes &quot;10.10.10.0/24 192.168.42.2&quot;</span><br></pre></td></tr></table></figure><h2 id="å¢åŠ ip">å¢åŠ ip</h2><p>æœ‰æ—¶å€™éœ€è¦åœ¨ä¸€ä¸ªè¿æ¥ä¸ŠåŠ å¤šä¸ªipåœ°å€</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection modify dachui-static +ipv4.addresses 2.2.2.2/16</span><br></pre></td></tr></table></figure><h2 id="åˆ é™¤è¿æ¥">åˆ é™¤è¿æ¥</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection delete dachui-static</span><br></pre></td></tr></table></figure><h2 id="ç½‘å¡å¼€æœºè‡ªå¯åŠ¨">ç½‘å¡å¼€æœºè‡ªå¯åŠ¨</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmcli connection modify dachui-static autoconnect yes</span><br></pre></td></tr></table></figure><h1>nmtui</h1><p>å…¶å®nmcliçš„ç©æ³•æœ‰å¾ˆå¤š,ä½†å…¶å®è¿˜æœ‰ä¸€ä¸ªå·¥å…·<code>nmtui</code>,ä»–æ˜¯<code>NetworkManager-tui</code>çš„ä¸€ä¸ªå·¥å…·,é€šè¿‡å­—ç¬¦å›¾å½¢åŒ–é…ç½®ç½‘ç»œ</p>]]></content>
    
    
    <summary type="html">é…ç½®ç½‘ç»œå·¥å…·</summary>
    
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/categories/linux%E5%91%BD%E4%BB%A4/"/>
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/tags/linux%E5%91%BD%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title>Linuxå¥½ç”¨å‘½ä»¤ä¹‹top</title>
    <link href="https://www.dddachui.top/posts/5285e72b.html"/>
    <id>https://www.dddachui.top/posts/5285e72b.html</id>
    <published>2022-09-03T15:11:37.000Z</published>
    <updated>2023-03-13T12:51:07.435Z</updated>
    
    <content type="html"><![CDATA[<h1>å‘½ä»¤ç®€ä»‹</h1><p>topå‘½ä»¤çš„åŠŸèƒ½æ˜¯ç”¨äºå®æ—¶æ˜¾ç¤ºç³»ç»Ÿè¿è¡ŒçŠ¶æ€ï¼ŒåŒ…å«å¤„ç†å™¨ã€å†…å­˜ã€æœåŠ¡ã€è¿›ç¨‹ç­‰é‡è¦èµ„æºä¿¡æ¯</p><h1>è¯­æ³•æ ¼å¼</h1><p>top [å‚æ•°]</p><h1>ç”¨æ³•</h1><h2 id="åŸºæœ¬ç”¨æ³•">åŸºæœ¬ç”¨æ³•</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top</span><br></pre></td></tr></table></figure><h2 id="æŒ‡å®šåˆ·æ–°æ—¶é—´">æŒ‡å®šåˆ·æ–°æ—¶é—´</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top -d 1</span><br></pre></td></tr></table></figure><h2 id="æ˜¾ç¤ºè¿›ç¨‹çš„å‘½ä»¤è¡Œå‚æ•°">æ˜¾ç¤ºè¿›ç¨‹çš„å‘½ä»¤è¡Œå‚æ•°</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top -c</span><br></pre></td></tr></table></figure><h2 id="ç›‘è§†æŒ‡å®šè¿›ç¨‹">ç›‘è§†æŒ‡å®šè¿›ç¨‹</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top -p 5201 -p 54231</span><br></pre></td></tr></table></figure><h2 id="æ˜¾ç¤ºæŒ‡å®šç”¨æˆ·">æ˜¾ç¤ºæŒ‡å®šç”¨æˆ·</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">top -u root</span><br></pre></td></tr></table></figure><blockquote><p>æˆ‘çš„topè¾“å‡º</p></blockquote><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">top - 23:15:06 up 21 min,  3 users,  load average: 1.19, 0.72, 0.32</span><br><span class="line">Tasks: 191 total,   3 running, 144 sleeping,   0 stopped,   0 zombie</span><br><span class="line"><span class="meta prompt_">%</span><span class="language-bash">Cpu(s):  1.5 us,  3.0 sy,  0.0 ni, 95.0 <span class="built_in">id</span>,  0.0 wa,  0.5 hi,  0.0 si,  0.0 st</span></span><br><span class="line">KiB Mem :  4009048 total,  2791500 free,   493780 used,   723768 buff/cache</span><br><span class="line">KiB Swap:   839676 total,   839676 free,        0 used.  3218592 avail Mem </span><br><span class="line">PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND                                                                                        </span><br><span class="line">8671 root      20   0  511852 105736  43568 S   4.0  2.6   0:04.58 X                                                                                              </span><br><span class="line">9872 root      20   0  702884  46780  35292 S   2.0  1.2   0:00.81 mate-terminal                                                                                        </span><br></pre></td></tr></table></figure><h1>topçš„äº¤äº’åŠŸèƒ½</h1><ul><li>åœ¨topåŸºæœ¬è§†å›¾ä¸­ï¼Œæ•²å‡»cé”®ï¼Œå¯ä»¥æ˜¾ç¤ºè¿›ç¨‹çš„è·¯å¾„</li><li>åœ¨topåŸºæœ¬è§†å›¾ä¸­ï¼Œæ•²å‡»ké”®ï¼Œå¯ä»¥åœ¨ä¸é€€å‡ºtopå‘½ä»¤çš„æƒ…å†µä¸‹æ€æ­»æŸä¸ªæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹</li><li>åœ¨topåŸºæœ¬è§†å›¾ä¸­ï¼Œæ•²å‡»1é”®ï¼Œå¯ç›‘æ§æ¯ä¸ªé€»è¾‘CPUçš„çŠ¶å†µ</li><li>åœ¨topåŸºæœ¬è§†å›¾ä¸­ï¼Œæ•²å‡»ä¸Šä¸‹é”®ï¼Œå¯ä»¥å¢å‡æ˜¾ç¤ºçš„è¿›ç¨‹æ•°ç›®</li></ul><h1>topè¾“å‡ºè§£é‡Š</h1><h2 id="ç¬¬ä¸€è¡Œ-åŸºæœ¬ä¿¡æ¯">ç¬¬ä¸€è¡Œ-åŸºæœ¬ä¿¡æ¯</h2><h3 id="ç³»ç»Ÿå½“å‰æ—¶é—´">ç³»ç»Ÿå½“å‰æ—¶é—´</h3><p>top - 23:15:06</p><h3 id="ç³»ç»Ÿè¿è¡Œæ—¶é—´">ç³»ç»Ÿè¿è¡Œæ—¶é—´</h3><p>up 21 min</p><h3 id="å½“å‰ç™»å½•ç”¨æˆ·æ•°é‡">å½“å‰ç™»å½•ç”¨æˆ·æ•°é‡</h3><p>3 users</p><h3 id="è´Ÿè½½å‡è¡¡æƒ…å†µ">è´Ÿè½½å‡è¡¡æƒ…å†µ</h3><p>load average: 1.19, 0.72, 0.32<br>ä¸‰ä¸ªæ•°åˆ†åˆ«æ˜¯1åˆ†é’Ÿã€5åˆ†é’Ÿã€15åˆ†é’Ÿçš„è´Ÿè½½æƒ…å†µ</p><blockquote><p>load averageæ•°æ®æ˜¯æ¯éš”5ç§’é’Ÿæ£€æŸ¥ä¸€æ¬¡æ´»è·ƒçš„è¿›ç¨‹æ•°ï¼Œç„¶åæŒ‰ç‰¹å®šç®—æ³•è®¡ç®—å‡ºçš„æ•°å€¼ã€‚å¦‚æœè¿™ä¸ªæ•°é™¤ä»¥<code>é€»è¾‘CPU</code>çš„æ•°é‡ï¼Œç»“æœé«˜äº5çš„æ—¶å€™å°±è¡¨æ˜ç³»ç»Ÿåœ¨è¶…è´Ÿè·è¿è½¬äº†</p></blockquote><h2 id="ç¬¬äºŒè¡Œ-è¿›ç¨‹">ç¬¬äºŒè¡Œ-è¿›ç¨‹</h2><h3 id="æ€»è¿›ç¨‹">æ€»è¿›ç¨‹</h3><p>Tasks: 191 total</p><h3 id="å½“å‰è¿è¡Œè¿›ç¨‹æ•°é‡">å½“å‰è¿è¡Œè¿›ç¨‹æ•°é‡</h3><p>3 running</p><h3 id="ä¼‘çœ è¿›ç¨‹æ•°é‡">ä¼‘çœ è¿›ç¨‹æ•°é‡</h3><p>144 sleeping</p><h3 id="åœæ­¢è¿›ç¨‹æ•°é‡">åœæ­¢è¿›ç¨‹æ•°é‡</h3><p>0 stopped,</p><h3 id="åƒµå°¸è¿›ç¨‹æ•°é‡">åƒµå°¸è¿›ç¨‹æ•°é‡</h3><p>0 zombie</p><blockquote><p>åœ¨unix/linuxä¸­ï¼Œæ­£å¸¸æƒ…å†µä¸‹,å­è¿›ç¨‹æ˜¯é€šè¿‡çˆ¶è¿›ç¨‹åˆ›å»ºçš„,å­è¿›ç¨‹åœ¨åˆ›å»ºæ–°çš„è¿›ç¨‹,å­è¿›ç¨‹çš„ç»“æŸå’Œçˆ¶è¿›ç¨‹çš„è¿è¡Œæ˜¯ä¸€ä¸ªå¼‚æ­¥è¿‡ç¨‹,å³çˆ¶è¿›ç¨‹æ°¸è¿œæ— æ³•é¢„æµ‹å­è¿›ç¨‹åˆ°åº•ä»€ä¹ˆæ—¶å€™ç»“æŸ.å½“ä¸€ä¸ªè¿›ç¨‹å®Œæˆå®ƒçš„å·¥ä½œç»ˆæ­¢ä¹‹å,å®ƒçš„çˆ¶è¿›ç¨‹éœ€è¦è°ƒç”¨wait()æˆ–è€…waitpid()ç³»ç»Ÿè°ƒç”¨å–å¾—å­è¿›ç¨‹çš„ç»ˆæ­¢çŠ¶æ€</p></blockquote><ul><li>å­¤å„¿è¿›ç¨‹<br>ä¸€ä¸ªçˆ¶è¿›ç¨‹é€€å‡ºï¼Œè€Œå®ƒçš„ä¸€ä¸ªæˆ–å¤šä¸ªå­è¿›ç¨‹è¿˜åœ¨è¿è¡Œï¼Œé‚£ä¹ˆé‚£äº›å­è¿›ç¨‹å°†æˆä¸ºå­¤å„¿è¿›ç¨‹ã€‚å­¤å„¿è¿›ç¨‹å°†è¢«initè¿›ç¨‹(è¿›ç¨‹å·ä¸º1)æ‰€æ”¶å…»ï¼Œå¹¶ç”±initè¿›ç¨‹å¯¹å®ƒä»¬å®ŒæˆçŠ¶æ€æ”¶é›†å·¥ä½œã€‚</li><li>åƒµå°¸è¿›ç¨‹<br>ä¸€ä¸ªè¿›ç¨‹ä½¿ç”¨forkåˆ›å»ºå­è¿›ç¨‹ï¼Œå¦‚æœå­è¿›ç¨‹é€€å‡ºï¼Œè€Œçˆ¶è¿›ç¨‹å¹¶æ²¡æœ‰è°ƒç”¨waitæˆ–waitpidè·å–å­è¿›ç¨‹çš„çŠ¶æ€ä¿¡æ¯ï¼Œé‚£ä¹ˆå­è¿›ç¨‹çš„è¿›ç¨‹æè¿°ç¬¦ä»ç„¶ä¿å­˜åœ¨ç³»ç»Ÿä¸­ã€‚è¿™ç§è¿›ç¨‹ç§°ä¹‹ä¸ºåƒµæ­»è¿›ç¨‹ã€‚</li></ul><h2 id="ç¬¬ä¸‰è¡Œ-cpuçŠ¶æ€">ç¬¬ä¸‰è¡Œ-cpuçŠ¶æ€</h2><h3 id="us">us</h3><p>ç”¨æˆ·ç©ºé—´å ç”¨CPUçš„ç™¾åˆ†æ¯”</p><h3 id="sy">sy</h3><p>å†…æ ¸ç©ºé—´å ç”¨CPUçš„ç™¾åˆ†æ¯”</p><h3 id="ni">ni</h3><p>æ”¹å˜è¿‡ä¼˜å…ˆçº§çš„è¿›ç¨‹å ç”¨CPUçš„ç™¾åˆ†æ¯”</p><h3 id="id">id</h3><p>ç©ºé—²CPUç™¾åˆ†æ¯”</p><h3 id="wa">wa</h3><p>IOç­‰å¾…å ç”¨CPUçš„ç™¾åˆ†æ¯”</p><h3 id="hi">hi</h3><p>ç¡¬ä¸­æ–­å ç”¨CPUçš„ç™¾åˆ†æ¯”</p><h3 id="si">si</h3><p>è½¯ä¸­æ–­å ç”¨CPUçš„ç™¾åˆ†æ¯”</p><h3 id="st">st</h3><p>å½“Linuxç³»ç»Ÿæ˜¯åœ¨è™šæ‹Ÿæœºä¸­è¿è¡Œæ—¶ï¼Œç­‰å¾…CPUèµ„æºçš„æ—¶é—´å æ¯”</p><blockquote><p>ç®€å•è¯´ï¼ŒKernel space æ˜¯ Linux å†…æ ¸çš„è¿è¡Œç©ºé—´ï¼ŒUser space æ˜¯ç”¨æˆ·ç¨‹åºçš„è¿è¡Œç©ºé—´ã€‚ä¸ºäº†å®‰å…¨ï¼Œå®ƒä»¬æ˜¯éš”ç¦»çš„ï¼Œå³ä½¿ç”¨æˆ·çš„ç¨‹åºå´©æºƒäº†ï¼Œå†…æ ¸ä¹Ÿä¸å—å½±å“ã€‚</p></blockquote><ul><li>Kernel space<br>ç”¨æˆ·ç©ºé—´å¯ä»¥æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œè°ƒç”¨ç³»ç»Ÿçš„ä¸€åˆ‡èµ„æºï¼›</li><li>User space<br>å†…æ ¸ç©ºé—´åªèƒ½æ‰§è¡Œç®€å•çš„è¿ç®—ï¼Œä¸èƒ½ç›´æ¥è°ƒç”¨ç³»ç»Ÿèµ„æºï¼Œå¿…é¡»é€šè¿‡ç³»ç»Ÿæ¥å£ï¼ˆåˆç§° system callï¼‰ï¼Œæ‰èƒ½å‘å†…æ ¸å‘å‡ºæŒ‡ä»¤</li></ul><h2 id="ç¬¬å››è¡Œ-å†…å­˜çŠ¶æ€">ç¬¬å››è¡Œ-å†…å­˜çŠ¶æ€</h2><h3 id="total">total</h3><p>æ€»å†…å­˜é‡4009048</p><h3 id="free">free</h3><p>ç©ºé—²å†…å­˜2791500</p><h3 id="used">used</h3><p>å·²ç”¨å†…å­˜493780</p><h3 id="buff-cache">buff/cache</h3><p>ç¼“å­˜å†…å­˜723768</p><blockquote><p>KiB Memï¼šKibè¡¨ç¤ºæè¿°å•ä½ï¼ŒMEMè¡¨ç¤ºå†…å­˜</p></blockquote><h2 id="ç¬¬äº”è¡Œ-swapçŠ¶æ€">ç¬¬äº”è¡Œ-swapçŠ¶æ€</h2><h3 id="total-2">total</h3><p>æ€»å†…å­˜é‡839676</p><h3 id="free-2">free</h3><p>ç©ºé—²å†…å­˜839676</p><h3 id="used-2">used</h3><p>å·²ç”¨å†…å­˜0</p><h3 id="avail-Mem">avail Mem</h3><p>å¯ç”¨å†…å­˜3218592</p><ul><li>free æ˜¯çœŸæ­£å°šæœªè¢«ä½¿ç”¨çš„ç‰©ç†å†…å­˜æ•°é‡ã€‚</li><li>available æ˜¯åº”ç”¨ç¨‹åºè®¤ä¸ºå¯ç”¨å†…å­˜æ•°é‡ï¼Œavailable = free + buffer + cache (æ³¨ï¼šåªæ˜¯å¤§æ¦‚çš„è®¡ç®—æ–¹æ³•)</li></ul><h2 id="ç¬¬å…­è¡Œ-è¿›ç¨‹ç›‘æ§">ç¬¬å…­è¡Œ-è¿›ç¨‹ç›‘æ§</h2><ul><li>PID â€” è¿›ç¨‹id</li><li>USER â€” è¿›ç¨‹æ‰€æœ‰è€…</li><li>PR â€” è¿›ç¨‹ä¼˜å…ˆçº§</li><li>NI â€” niceå€¼ã€‚è´Ÿå€¼è¡¨ç¤ºé«˜ä¼˜å…ˆçº§ï¼Œæ­£å€¼è¡¨ç¤ºä½ä¼˜å…ˆçº§</li><li>VIRT â€” è¿›ç¨‹ä½¿ç”¨çš„è™šæ‹Ÿå†…å­˜æ€»é‡ï¼Œå•ä½kbã€‚VIRT=SWAP+RES</li><li>RES â€” è¿›ç¨‹ä½¿ç”¨çš„ã€æœªè¢«æ¢å‡ºçš„ç‰©ç†å†…å­˜å¤§å°ï¼Œå•ä½kbã€‚RES=CODE+DATA</li><li>SHR â€” å…±äº«å†…å­˜å¤§å°ï¼Œå•ä½kb</li><li>S â€” è¿›ç¨‹çŠ¶æ€ã€‚D=ä¸å¯ä¸­æ–­çš„ç¡çœ çŠ¶æ€ï¼›R=è¿è¡Œï¼›S=ç¡çœ ï¼›T=è·Ÿè¸ª/åœæ­¢ï¼›Z=åƒµå°¸è¿›ç¨‹</li><li>%CPU â€” ä¸Šæ¬¡æ›´æ–°åˆ°ç°åœ¨çš„CPUæ—¶é—´å ç”¨ç™¾åˆ†æ¯”</li><li>%MEM â€” è¿›ç¨‹ä½¿ç”¨çš„ç‰©ç†å†…å­˜ç™¾åˆ†æ¯”</li><li>TIME+ â€” è¿›ç¨‹ä½¿ç”¨çš„CPUæ—¶é—´æ€»è®¡ï¼Œå•ä½1/100ç§’</li><li>COMMAND â€” è¿›ç¨‹åç§°ï¼ˆå‘½ä»¤å/å‘½ä»¤è¡Œï¼‰</li></ul>]]></content>
    
    
    <summary type="html">ç»ˆç«¯ä»»åŠ¡ç®¡ç†å™¨</summary>
    
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/categories/linux%E5%91%BD%E4%BB%A4/"/>
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/tags/linux%E5%91%BD%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title>Linuxå¥½ç”¨å‘½ä»¤ä¹‹systemctl</title>
    <link href="https://www.dddachui.top/posts/5154c07a.html"/>
    <id>https://www.dddachui.top/posts/5154c07a.html</id>
    <published>2022-08-05T08:53:55.000Z</published>
    <updated>2023-03-13T12:50:56.964Z</updated>
    
    <content type="html"><![CDATA[<h1>æ¦‚å¿µ</h1><ul><li>systemd<br>systemdæ˜¯ä¸SysVå’ŒLSBåˆå§‹åŒ–è„šæœ¬å…¼å®¹çš„ç³»ç»Ÿå’ŒæœåŠ¡ç®¡ç†å™¨,å¼€å¯systemdæœåŠ¡,å¯ä»¥åŸºäºå®ˆæŠ¤è¿›ç¨‹æŒ‰éœ€å¯åŠ¨ç­–ç•¥<br>systemdæœåŠ¡æ”¯æŒå¿«ç…§å’Œç³»ç»ŸçŠ¶æ€æ¢å¤,ç»´æŠ¤æŒ‚è½½å’Œè‡ªåŠ¨æŒ‚è½½ç‚¹,æœåŠ¡ä¹‹é—´çš„ä»å±å…³ç³»ä¹Ÿæœ‰é€»è¾‘æ§åˆ¶</li><li>systemd unit<br>systemæœåŠ¡çš„å¼€å¯å’Œç›‘ç£ç³»ç»Ÿæ˜¯åŸºäºunitçš„,unitå°±æ˜¯ä¸€ä¸ªä¸é…ç½®æ–‡ä»¶å¯¹åº”çš„åç§°å’Œç±»å‹ç»„æˆ,unitçš„ç±»å‹å¦‚ä¸‹</li></ul><ol><li>service unit ç³»ç»ŸæœåŠ¡</li><li>Target unit ä¸€ç»„systemd units</li><li>Automount unit æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹</li><li>Device unit  å†…æ ¸è¯†åˆ«çš„è®¾å¤‡æ–‡ä»¶</li><li>Mount unit   æ–‡ä»¶ç³»ç»ŸæŒ‚è½½ç‚¹</li><li>Path unit    ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶æˆ–ç›®å½•</li><li>Scope unit  å¤–éƒ¨åˆ›å»ºçš„è¿›ç¨‹</li><li>Snapshot unit   systemd manager  çš„ä¿å­˜çŠ¶æ€</li></ol><ul><li>systemdçš„ç‰¹æ€§</li></ul><ol><li>æ›´å¿«çš„å¯åŠ¨é€Ÿåº¦</li><li>æŒ‰éœ€å¯åŠ¨èƒ½åŠ›</li><li>é‡‡ç”¨cgroupç‰¹æ€§è·Ÿè¸ªå’Œç®¡ç†è¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸ</li><li>é‡‡ç”¨æŒ‚è½½ç‚¹å’Œè‡ªåŠ¨æŒ‚è½½çš„ç®¡ç†</li><li>å®ç°äº‹åŠ¡ä¾èµ–æ€§å…³ç³»ç®¡ç†</li><li>ä¸SysVåˆå§‹åŒ–è„šæœ¬å…¼å®¹</li><li>å¯¹ç³»ç»Ÿè¿›ç¨‹å¿«ç…§å’Œæ¢å¤</li></ol><h1>ç®¡ç†æœåŠ¡</h1><p>ç”¨systemctlå‘½ä»¤ç®¡ç†è¿›è¡Œ è¿è¡Œ å¯åŠ¨ é‡å¯ æ˜¾ç¤º è‡ªå¯åŠ¨ å…³é—­è‡ªå¯åŠ¨ ç­‰</p><h1>åŸºæ“</h1><h2 id="æ˜¾ç¤ºè¿è¡Œçš„æœåŠ¡">æ˜¾ç¤ºè¿è¡Œçš„æœåŠ¡</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl list-units --type service</span><br></pre></td></tr></table></figure><h2 id="æ˜¾ç¤ºæ‰€æœ‰çš„æœåŠ¡">æ˜¾ç¤ºæ‰€æœ‰çš„æœåŠ¡</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl list-units --type service --all</span><br></pre></td></tr></table></figure><h2 id="æŸ¥çœ‹æœåŠ¡çŠ¶æ€">æŸ¥çœ‹æœåŠ¡çŠ¶æ€</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl status httpd</span><br></pre></td></tr></table></figure><ul><li>æ˜¾ç¤ºæŒ‡æ ‡<br>loaded: è¯´æ˜æœåŠ¡æ˜¯å¦è¢«åŠ è½½,åŒæ—¶æ˜¾ç¤ºå¯¹åº”çš„ç»å¯¹è·¯å¾„æ˜¯å¦å¯ç”¨<br>active: æ˜¯å¦è¿è¡Œ<br>main pid: è¿›ç¨‹pid<br>cgroup: ç›¸å…³æ§åˆ¶ç»„çš„å…¶ä»–ä¿¡æ¯</li></ul><h2 id="ç®¡ç†æœåŠ¡çš„åŸºæ“">ç®¡ç†æœåŠ¡çš„åŸºæ“</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">systemctl start sshd</span><br><span class="line">systemctl stop  sshd</span><br><span class="line">systemctl restart sshd</span><br><span class="line">systemctl enable sshd</span><br><span class="line">systemctl disable sshd</span><br></pre></td></tr></table></figure><h2 id="æ“ä½œç³»ç»Ÿç”µæº">æ“ä½œç³»ç»Ÿç”µæº</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">systemctl poweroff  #å…³é—­ç³»ç»Ÿ,ä¸‹ç”µ</span><br><span class="line">systemctl halt      #å…³é—­ç³»ç»Ÿ,ä¸ä¸‹ç”µ</span><br><span class="line">systemctl reboot    #é‡å¯</span><br><span class="line">systemctl suspend   #å¾…æœº</span><br><span class="line">systemctl hibernate  #ä¼‘çœ </span><br><span class="line">systemctl hybrid-sleep #å¾…æœº+ä¼‘çœ </span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">æœåŠ¡ç®¡ç†</summary>
    
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/categories/linux%E5%91%BD%E4%BB%A4/"/>
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/tags/linux%E5%91%BD%E4%BB%A4/"/>
    
  </entry>
  
  <entry>
    <title>Linuxå¥½ç”¨å‘½ä»¤ä¹‹dnf</title>
    <link href="https://www.dddachui.top/posts/a36cc04b.html"/>
    <id>https://www.dddachui.top/posts/a36cc04b.html</id>
    <published>2022-08-05T05:34:05.000Z</published>
    <updated>2023-03-13T12:48:53.249Z</updated>
    
    <content type="html"><![CDATA[<h1>å‘½ä»¤ç®€ä»‹</h1><p>DNF:Dandified YUM,æ˜¯åŸºäºRPMçš„Linuxå‘è¡Œç‰ˆçš„è½¯ä»¶åŒ…ç®¡ç†å™¨,å®ƒç”¨äºåœ¨ Fedora / RHEL / CentOSæ“ä½œç³»ç»Ÿä¸­å®‰è£…,æ›´æ–°å’Œåˆ é™¤è½¯ä»¶åŒ…,ç›®å‰ DNF å‘½ä»¤å’Œyumå‘½ä»¤ç›¸äº’å…¼å®¹,è½¯ä»¶åŒ…ä»“åº“ä¾æ—§ä½¿ç”¨ YUM ä»“åº“ã€‚</p><h1>æ³¨æ„</h1><p>dnfå’Œyumçš„åŸºç¡€å‘½ä»¤éƒ½æ˜¯å…¼å®¹çš„,ä½†æ˜¯dnfé»˜è®¤å®‰è£…äº†å¾ˆå¤šæ’ä»¶,åä¼šå‡ºä¸€ä¸ªæ’ä»¶çš„å­¦ä¹ è®°å½•</p><h1>é…ç½®dnf</h1><ul><li>dnfä¸»è¦é…ç½®æ–‡ä»¶<br>/etc/dnf/dnf.conf<br>åœ¨rockylinuxå’Œcentos9streamç³»ç»Ÿä¸­/etc/yum.confæ˜¯æŒ‡å‘dnf.confçš„è½¯é“¾æ¥,å†…å®¹å¦‚ä¸‹</li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[main]</span></span><br><span class="line"><span class="attr">gpgcheck</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">installonly_limit</span>=<span class="number">3</span></span><br><span class="line"><span class="attr">clean_requirements_on_remove</span>=<span class="literal">True</span></span><br><span class="line"><span class="attr">best</span>=<span class="literal">True</span></span><br><span class="line"><span class="attr">skip_if_unavailable</span>=<span class="literal">False</span></span><br></pre></td></tr></table></figure><p>å‚æ•°è¯´æ˜</p><ol><li>cachedir:ç¼“å­˜ç›®å½•,å­˜å‚¨rpmåŒ…å’Œæ•°æ®åº“æ–‡ä»¶(é»˜è®¤æ²¡å†™,åœ¨å…¶ä»–è·¯å¾„)</li><li>best: å‡çº§åŒ…çš„æ—¶å€™æ€»æ˜¯å°è¯•å®‰è£…æœ€é«˜ç‰ˆæœ¬,å¦‚æœæœ€é«˜ä¸èƒ½è£…å°±åœæ­¢å¹¶æ˜¾ç¤ºåŸå› </li><li>installonly_limit: åŒæ—¶å®‰è£…&quot;installonlypkgs&quot; æŒ‡ä»¤åˆ—å‡ºåŒ…çš„æ•°é‡,é»˜è®¤3,ä¸å»ºè®®é™ä½</li><li>clean_requirements_on_remove:åˆ é™¤dnf removeæœŸé—´ä¸åœ¨ä½¿ç”¨çš„ä¾èµ–é¡¹,å³æ˜¯dnfè¿å¸¦å®‰è£…çš„ä¾èµ–,åªèƒ½é€šè¿‡æ­¤å‚æ•°ä¸ºtrueæ¥åˆ é™¤</li></ol><h1>è®¾ç½®ä»“åº“</h1><h2 id="ä¿®æ”¹dnfæºæ–‡ä»¶">ä¿®æ”¹dnfæºæ–‡ä»¶</h2><p>è¿˜æ˜¯ä¿®æ”¹/etc/yum.repos.dä¸‹é¢çš„repoæ–‡ä»¶,é…ç½®å’Œyumä¸€æ ·</p><h2 id="åˆ›å»ºæœ¬åœ°æºä»“åº“">åˆ›å»ºæœ¬åœ°æºä»“åº“</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf install createrepo</span><br></pre></td></tr></table></figure><ul><li>å°†è½¯ä»¶åŒ…æ”¾åœ¨è¯¥ç›®å½•ä¸‹</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">createrepo --database /mnt/test </span><br></pre></td></tr></table></figure><h2 id="å‘½ä»¤æ·»åŠ æº">å‘½ä»¤æ·»åŠ æº</h2><p>ä¼šåœ¨/etc/yum.repo.dä¸‹ç”Ÿæˆ</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf config-manager --add-repo repo_url</span><br></pre></td></tr></table></figure><h1>æŸ¥çœ‹æº</h1><ul><li>æŸ¥çœ‹æœ¬æœºé…ç½®çš„æº</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf repolist</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹å…·ä½“çš„æº</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf repolist base</span><br></pre></td></tr></table></figure><h1>å¯åœæº</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf config-manager --set-enable repo_name</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf config-manager --set-disable repo_name</span><br></pre></td></tr></table></figure><h1>åŸºæ“</h1><p>åŸºæœ¬æ²¡yumæ²¡æœ‰åŒºåˆ«</p><ul><li>æŸ¥</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf search ssh</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf provides ssh</span><br></pre></td></tr></table></figure><ul><li>åˆ—ä¸¾å®‰è£…çš„åŒ…</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf list all</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf list openssh</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹åŒ…çš„ä¿¡æ¯</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf info openssh</span><br></pre></td></tr></table></figure><h1>å…‰ä¸‹è½½ä¸å®‰è£…</h1><p>è¿™æ˜¯ä¸€ä¸ªdnfæ’ä»¶å®ç°çš„</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf download package_name</span><br></pre></td></tr></table></figure><h1>å®‰è£…</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf install httpd</span><br></pre></td></tr></table></figure><h1>å¸è½½è½¯ä»¶åŒ…</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf remove httpd</span><br></pre></td></tr></table></figure><h1>åˆ—å‡ºè¯¦ç»†çš„ç»„ä¿¡æ¯</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf  groups info &quot;å¼€å‘å·¥å…·&quot;</span><br></pre></td></tr></table></figure><h1>å®‰è£…å¸è½½è½¯ä»¶åŒ…ç»„</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dnf groups install è½¯ä»¶åŒ…ç»„/id</span><br><span class="line">dnf groups remove è½¯ä»¶åŒ…ç»„/id</span><br></pre></td></tr></table></figure><h1>æ£€æŸ¥æ›´æ–°</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf check-update</span><br></pre></td></tr></table></figure><h1>å‡çº§è½¯ä»¶åŒ…</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf update</span><br></pre></td></tr></table></figure><h1>å‡çº§å•ç‹¬çš„</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf update åŒ…å</span><br></pre></td></tr></table></figure><h1>å‡çº§ç»„</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dnf group update group_name</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">dnfåŒ…ç®¡ç†å·¥å…·</summary>
    
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/categories/linux%E5%91%BD%E4%BB%A4/"/>
    
    
    <category term="linuxå‘½ä»¤" scheme="https://www.dddachui.top/tags/linux%E5%91%BD%E4%BB%A4/"/>
    
  </entry>
  
</feed>
